import{v as B,c3 as ge,fA as fe,j as t,gw as je,gc as _e,r as g,S as T,I as Ie,b as E,N as C,gx as Te,i as vt,gy as Ee,a6 as Dt,e as Ut,h as z,c_ as Ce,gz as W,f2 as ye,gA as be,d as Ft,g5 as Ne,C as Me,cl as Se,cN as Be,s as Pt,gB as Oe,gC as ke,gD as Le,gE as Ae,gF as we,f as Re,eN as y,L as Ht,gG as ve,gH as De,gI as Ue,gJ as Fe,f0 as Pe,A as He,gK as $e,fW as ze,dP as We,gL as Ge,gM as Ke,H as Ve,gN as Ye,T as Xe,eV as qe}from"./index-B_BHgQQY.js";import{u as Je,c as Ze,o as Q,j as $t,$ as Qe,d as It,e as tr,T as st,U as er,V as rr,f as zt,k as Tt,w as sr,M as F,g as ht,h as Wt,m as nr,r as or,v as Gt,_ as Kt,i as ir,l as ar,I as lr,O as Et,n as cr,x as nt,Y as Ct,p as dr,q as V,s as ur,t as mr,K as pr,y as hr,L as xr,z as gr,A as fr,B as jr,G as _r,J as Ir,N as Tr,S as Er,P as Cr,E as yr,H as br,D as Nr,F as Mr,Q as Sr,a as Br}from"./DrawerHeader-s7Kk1UMg.js";import{L as xt}from"./Loader-CLxvJV4h.js";import{C as yt}from"./CircularProgress-_2M16NEZ.js";import{A as bt,C as Vt,M as Or,e as kr,f as Yt,R as Xt,u as Lr,b as Ar,h as lt,S as wr,c as Rr,I as vr,g as Dr,E as Ur,D as Fr,i as Pr,j as Hr,k as $r,H as zr,P as Wr,F as Gr,l as Kr,m as Vr,n as Yr}from"./useSorting-rrsm5hZb.js";import{S as P}from"./Skeleton-Bf_dEhrE.js";import{A as Y}from"./Avatar-BO-XeDPi.js";import{S as qt}from"./TextField-CCzZwtaB.js";import{M as gt}from"./MenuItem-i4R53H8t.js";import{B as H}from"./Box-CXXiFbSb.js";import{T as Xr,a as qr,F as Jr,S as Nt,b as Zr}from"./FileMaxWidthSetting-B0EgjMCQ.js";import{T as Qr}from"./text-align-start-BvNJbDOj.js";import{u as ts,F as es}from"./index.esm-D6N0kWEX.js";import{u as v}from"./useModalStatus-CF1QQN94.js";import{L as rs,a as ss}from"./LinkUrlField-BcIiYqG0.js";import{B as U}from"./Button-4ORflwU5.js";import{D as Jt,a as Zt}from"./DialogContent-BLGJ1kXP.js";import{D as Qt}from"./DialogTitle-BL-ZXwRQ.js";import{D as te}from"./DialogActions-B4c7iV3e.js";import{A as D}from"./Alert-af15MLjr.js";import{A as ns,r as os}from"./AppItem-BE9gOvW3.js";import{u as ft}from"./OutletContext-BGjGZ_Uz.js";import{E as tt}from"./ErrorAlert-BzdoD583.js";import{u as ee}from"./FilterItemsContext-D5pcm88K.js";import{u as is}from"./LayoutContext-DvWbprYl.js";import{F as as}from"./FolderCreateForm-D_2wcpXy.js";import{G as ls}from"./Button-C2DML4l_.js";import{B as J}from"./langs-BKRoRoQy.js";import{N as cs,M as ds}from"./MapView-CMwUagIU.js";import{I as G}from"./IconButton-t5WdCoTE.js";import{u as jt,S as us,a as ms,b as ps,D as hs}from"./SelectionToolbar-DgkJCewa.js";import{N as re,a as xs}from"./NoItemFilters-DFSEHwYM.js";import{M as gs}from"./ModeButton-9UBXfmKQ.js";import{u as fs}from"./index-CVpgN-ou.js";import{P as $}from"./permissionLevel-BOsSKewz.js";import{T as Mt}from"./Trans-1gex2Erj.js";import{I as js}from"./itemType-D9KQEJss.js";import{g as _s}from"./linkItem-VVVu8jA7.js";import{T as Is,D as Ts}from"./Avatar-DCfOgV-R.js";import{N as Es}from"./Navigation-COwkB-YM.js";import{M as Cs,C as ys}from"./PinButton-B2O-3CYr.js";import{T as _t}from"./Tooltip-CY4gBTjx.js";import{M as bs}from"./message-square-off-CesP20iE.js";import{L as Ns}from"./library-big-DhTVkpT9.js";import{L as Ms}from"./ListItemIcon-BTN91sVG.js";import{L as Ss}from"./ListItemText-Db53d-gu.js";import{a as Bs}from"./EditButton-ZZbYvNZm.js";import{M as Os}from"./Menu-C45l_y2r.js";import{D as q}from"./Divider-DwBPlmwR.js";import"./withResizing-Bmu3xIGc.js";import"./AccordionSummary-CDFC1KDY.js";import"./useSlot-D6B6Ly0P.js";import"./ButtonBase-ylRkSt5R.js";import"./isFocusVisible-B8k4qzLc.js";import"./useControlled-BMwunPLn.js";import"./Collapse-CF3-lsEC.js";import"./utils-NE7yIt1Q.js";import"./Paper-e3G0y0Go.js";import"./chevron-down-D3HPGb0W.js";import"./TextDisplay-DKy1jHXb.js";import"./mimeTypes-Bpmm_hmI.js";import"./fileItem-Bbp5pYua.js";import"./alignment-FBy0_b-y.js";import"./index-Chjiymov.js";import"./constants-CyQbYbhY.js";import"./pen-DzBOH2fN.js";import"./x-B2OknFaz.js";import"./createSvgIcon-CR_wPvPv.js";import"./index-Du_uXtnU.js";import"./index-CAxbq8YW.js";import"./langs-C5VEx8tQ.js";import"./normalizeDates-Bl5IZJGD.js";import"./toDate-BXq0HhWu.js";import"./index-BzmWlSRn.js";import"./format-C1rEO6Ru.js";import"./differenceInCalendarDays-DiZ3ZI30.js";import"./getTimezoneOffsetInMilliseconds-CkMJBntH.js";import"./Edit-CA3IAl03.js";import"./Delete-I6zc3GRu.js";import"./link-nLlUeqkm.js";import"./Link-DLKBSA2n.js";import"./differenceInSeconds-DNsH8fUT.js";import"./download-C1DwLYTP.js";import"./ItemIcon-aRVTEBTL.js";import"./StyledBaseComponents-0ZpECQxB.js";import"./fileSize-Ct-TZ2my.js";import"./validate-DVgNBRRM.js";import"./Thumbnail-CeEWDJof.js";import"./chevron-right-CtTm1uPZ.js";import"./FormControl-DkBPBeJg.js";import"./isMuiElement-BdxtYttK.js";import"./Checkbox-CAPv11-J.js";import"./SwitchBase-BpBcR0Ys.js";import"./Popover-CgVTRYfe.js";import"./Modal-DNRlalor.js";import"./createChainedFunction-BO_9K8Jh.js";import"./Grow-BvZTf0bq.js";import"./InputAdornment-CGS_1X61.js";import"./LinkTypeFormControl-Cx3z8ol1.js";import"./Clear-BLTcymBh.js";import"./TextEditor-NUJSy7Vm.js";import"./isEqual-D6G76aij.js";import"./Tabs-D8U24ZxU.js";import"./useThemeProps-BNH6uLhE.js";import"./RadioGroup-B8axso0y.js";import"./FormControlLabel-CAZP-rGy.js";import"./Switch-BMLgWMtw.js";import"./ItemSettingProperty-DyTew-Ej.js";import"./item-dXKRHMD1.js";import"./Grid-DwBZvdO2.js";import"./uploadWithProgress-X8OCjAji.js";import"./LibraryIcon-Us5FpFqN.js";import"./eye-off-WWB42nol.js";import"./pin-CWXz_P8J.js";import"./useLocation-C8vtnVMT.js";import"./CustomLink-CCI7pO31.js";import"./capsule-ocBuEWIN.js";import"./ItemCard-NGB9iUow.js";import"./Card-Rs4ggG5A.js";import"./date-BPVbmzn6.js";import"./differenceInMinutes-BbWlujZi.js";import"./differenceInCalendarMonths-C8dGLoK4.js";import"./FlagItemModalContext-B9D_0oH9.js";import"./ListItemButton-TRjTb-Ya.js";import"./listItemTextClasses-DkicRqsl.js";import"./listItemButtonClasses-BxUs8zQL.js";import"./List-Cf8ruq7c.js";import"./eye-c2LSV0oY.js";import"./trash-CYNfI7WN.js";import"./CancelButton-DsqMvRyV.js";import"./MenuItemLink-BMQoDPhe.js";import"./settings-CTRMiCcG.js";import"./dividerClasses-Bk0V9OT7.js";import"./getValidReactChildren-BkgtYZbS.js";import"./Select-CwIsZUkW.js";import"./AlertTitle-CZRu3C6o.js";import"./CardActionArea-BWT8PuAd.js";import"./external-link-QQvANG3_.js";import"./appItem-PW1ezbEO.js";import"./url-DDYejV_U.js";import"./circle-question-mark-BrH_Q4hU.js";import"./ThumbnailCrop-iMyJZY_9.js";import"./CropModal-D3OxYzrA.js";import"./DialogContentText-X3gecpnz.js";import"./trash-2-D4QstvMZ.js";import"./itemGeolocation-aPAjzerS.js";import"./useMobileView-Wj1l5_E9.js";import"./Autocomplete-DLfOXbvp.js";import"./usePreviousProps-WLnL_Kyw.js";import"./DeleteButton-DxOTZkGM.js";import"./GeolocationPicker-BtIdhDYV.js";import"./Fab-g5xTBhKE.js";import"./errorboundary-DQhN36hL.js";import"./CardContent-ZLzXOttd.js";import"./TypographyLink-BhX6wc0l.js";import"./Breadcrumbs-CifeKTUg.js";const ks=e=>e[js.H5P];/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ls=[["path",{d:"M6 12h9a4 4 0 0 1 0 8H7a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h7a4 4 0 0 1 0 8",key:"mg9rjx"}]],As=B("bold",Ls);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ws=[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]],Rs=B("grip-vertical",ws);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vs=[["line",{x1:"19",x2:"10",y1:"4",y2:"4",key:"15jd3p"}],["line",{x1:"14",x2:"5",y1:"20",y2:"20",key:"bu0au3"}],["line",{x1:"15",x2:"9",y1:"4",y2:"20",key:"uljnxc"}]],Ds=B("italic",vs);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Us=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],Fs=B("message-square",Us);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ps=[["path",{d:"M5 12h14",key:"1ays0h"}]],Hs=B("minus",Ps);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $s=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],ct=B("plus",$s);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zs=[["path",{d:"M16 4H9a3 3 0 0 0-2.83 4",key:"43sutm"}],["path",{d:"M14 12a4 4 0 0 1 0 8H6",key:"nlfj13"}],["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}]],Ws=B("strikethrough",zs);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gs=[["path",{d:"M3 5h18",key:"1u36vt"}],["path",{d:"M3 12h18",key:"1i2n21"}],["path",{d:"M3 19h18",key:"awlh7x"}]],Ks=B("text-align-justify",Gs);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vs=[["path",{d:"M12 4v16",key:"1654pz"}],["path",{d:"M4 7V5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2",key:"e0r10z"}],["path",{d:"M9 20h6",key:"s66wpe"}]],Ys=B("type",Vs);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xs=[["path",{d:"M6 4v6a6 6 0 0 0 12 0V4",key:"9kb039"}],["line",{x1:"4",x2:"20",y1:"20",y2:"20",key:"nun2al"}]],qs=B("underline",Xs);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Js=[["path",{d:"M18 21a8 8 0 0 0-16 0",key:"3ypg7q"}],["circle",{cx:"10",cy:"8",r:"5",key:"o932ke"}],["path",{d:"M22 20c0-3.37-2-6.5-4-8a5 5 0 0 0-.45-8.3",key:"10s06x"}]],Zs=B("users-round",Js),Qs=({item:e})=>{const{isLoading:r}=Je({itemId:e.id}),{data:s,isLoading:o}=ge(fe());if(r||o)return t.jsx(xt,{});if(!s)return null;const n=e.permission==="admin";return t.jsx(Ze,{id:_e,sendMessageBoxId:je,itemId:e.id,showAdminTools:n})};function tn({defaultSelection:e}){const[r]=Q();return g.useEffect((()=>{r.focus((()=>{const s=document.activeElement,o=r.getRootElement();o===null||s!==null&&o.contains(s)||o.focus({preventScroll:!0})}),{defaultSelection:e})}),[e,r]),null}const en=e=>{let r=0;for(const o of e)r=o.charCodeAt(0)+((r<<5)-r);let s="#";for(let o=0;o<3;o+=1){const n=r>>o*8&255;s+=`00${n.toString(16)}`.slice(-2)}return s};function rn({users:e,isConnected:r}){return r?t.jsxs(T,{justifyContent:"space-between",alignContent:"center",direction:"row",children:[t.jsx(T,{children:!r&&t.jsx(yt,{size:30})}),t.jsx(bt,{children:e.map(s=>t.jsx(Y,{children:s.name[0].toUpperCase()}))})]}):t.jsxs(T,{justifyContent:"space-between",alignContent:"center",direction:"row",children:[t.jsx(T,{children:t.jsx(yt,{size:30})}),t.jsxs(bt,{sx:{gap:1},children:[t.jsx(P,{children:t.jsx(Y,{})}),t.jsx(P,{children:t.jsx(Y,{})}),t.jsx(P,{children:t.jsx(Y,{})})]})]})}class se{constructor(r,s){this._x=r,this._y=s}get x(){return this._x}get y(){return this._y}equals({x:r,y:s}){return this.x===r&&this.y===s}calcDeltaXTo({x:r}){return this.x-r}calcDeltaYTo({y:r}){return this.y-r}calcHorizontalDistanceTo(r){return Math.abs(this.calcDeltaXTo(r))}calcVerticalDistance(r){return Math.abs(this.calcDeltaYTo(r))}calcDistanceTo(r){return Math.sqrt(Math.pow(this.calcDeltaXTo(r),2)+Math.pow(this.calcDeltaYTo(r),2))}}class A{constructor(r,s,o,n){const[i,a]=s<=n?[s,n]:[n,s],[l,c]=r<=o?[r,o]:[o,r];this._top=i,this._right=c,this._left=l,this._bottom=a}get top(){return this._top}get right(){return this._right}get bottom(){return this._bottom}get left(){return this._left}get width(){return Math.abs(this._left-this._right)}get height(){return Math.abs(this._bottom-this._top)}equals({top:r,left:s,bottom:o,right:n}){return r===this._top&&o===this._bottom&&s===this._left&&n===this._right}contains(r){if(r instanceof se){const{x:s,y:o}=r,n=o<this._top,i=o>this._bottom,a=s<this._left,l=s>this._right;return{reason:{isOnBottomSide:i,isOnLeftSide:a,isOnRightSide:l,isOnTopSide:n},result:!(n||i||a||l)}}{const{top:s,left:o,bottom:n,right:i}=r;return s>=this._top&&s<=this._bottom&&n>=this._top&&n<=this._bottom&&o>=this._left&&o<=this._right&&i>=this._left&&i<=this._right}}intersectsWith(r){const{left:s,top:o,width:n,height:i}=r,{left:a,top:l,width:c,height:d}=this;return(s+n>=a+c?s+n:a+c)-(s<=a?s:a)<=n+c&&(o+i>=l+d?o+i:l+d)-(o<=l?o:l)<=i+d}generateNewRect({left:r=this.left,top:s=this.top,right:o=this.right,bottom:n=this.bottom}){return new A(r,s,o,n)}static fromLTRB(r,s,o,n){return new A(r,s,o,n)}static fromLWTH(r,s,o,n){return new A(r,o,r+s,o+n)}static fromPoints(r,s){const{y:o,x:n}=r,{y:i,x:a}=s;return A.fromLTRB(n,o,a,i)}static fromDOM(r){const{top:s,width:o,left:n,height:i}=r.getBoundingClientRect();return A.fromLWTH(n,o,s,i)}}const ot=4,sn=2,St="application/x-lexical-drag-block",Bt=28,nn=1,on=-1,Ot=0;let X=1/0;function ne(e){const r=(l,c)=>l?parseFloat(window.getComputedStyle(l)[c]):0,{marginTop:s,marginBottom:o}=window.getComputedStyle(e),n=r(e.previousElementSibling,"marginBottom"),i=r(e.nextElementSibling,"marginTop"),a=Math.max(parseFloat(s),n);return{marginBottom:Math.max(parseFloat(o),i),marginTop:a}}function it(e,r,s,o=!1){const n=e.getBoundingClientRect(),i=(function(l){return l.getEditorState().read((()=>sr().getChildrenKeys()))})(r);let a=null;return r.getEditorState().read((()=>{if(o){const[m,x]=[r.getElementByKey(i[0]),r.getElementByKey(i[i.length-1])],[_,I]=[m?.getBoundingClientRect(),x?.getBoundingClientRect()];if(_&&I){const p=F(m),h=F(x);if(s.y/p<_.top?a=m:s.y/h>I.bottom&&(a=x),a)return}}let l=(c=i.length)===0?1/0:X>=0&&X<c?X:Math.floor(c/2);var c;let d=Ot;for(;l>=0&&l<i.length;){const m=i[l],x=r.getElementByKey(m);if(x===null)break;const _=F(x),I=new se(s.x/_,s.y/_),p=A.fromDOM(x),{marginTop:h,marginBottom:j}=ne(x),u=p.generateNewRect({bottom:p.bottom+j,left:n.left,right:n.right,top:p.top-h}),{result:f,reason:{isOnTopSide:b,isOnBottomSide:N}}=u.contains(I);if(f){a=x,X=l;break}d===Ot&&(d=b?on:N?nn:1/0),l+=d}})),a}function an(e,r,s,o,n,i,a,l,c){const d=r.parentElement,m=g.useRef(!1),[x,_]=g.useState(null),I=g.useCallback((p=>{_(p),c&&c(p)}),[c]);return g.useEffect((()=>{function p(j){const u=j.target;if(!st(u))return void I(null);if(l(u))return;const f=it(r,e,j);I(f)}function h(){I(null)}return d!=null&&(d.addEventListener("mousemove",p),d.addEventListener("mouseleave",h)),()=>{d!=null&&(d.removeEventListener("mousemove",p),d.removeEventListener("mouseleave",h))}}),[d,r,e,l,I]),g.useEffect((()=>{s.current&&(function(p,h,j){if(!p)return h.style.opacity="0",void(h.style.transform="translate(-10000px, -10000px)");const u=p.getBoundingClientRect(),f=window.getComputedStyle(p),b=h.getBoundingClientRect(),N=j.getBoundingClientRect();let S=parseInt(f.lineHeight,10);isNaN(S)&&(S=u.bottom-u.top);const M=u.top+(S-b.height)/2-N.top+j.scrollTop,k=ot;h.style.opacity="1",h.style.transform=`translate(${k}px, ${M}px)`})(x,s.current,r)}),[r,x,s]),g.useEffect((()=>{function p(h){if(!m.current)return!1;const[j]=It(h);if(j)return!1;const{pageY:u,target:f}=h;if(!st(f))return!1;const b=it(r,e,h,!0),N=o.current;return b!==null&&N!==null&&((function(S,M,k,L){const{top:K,height:ce}=M.getBoundingClientRect(),{top:de,width:ue}=L.getBoundingClientRect(),{marginTop:me,marginBottom:pe}=ne(M);let rt=K;k>=K?rt+=ce+pe/2:rt-=me/2;const he=rt-de-sn+L.scrollTop,xe=Bt-ot;S.style.transform=`translate(${xe}px, ${he}px)`,S.style.width=ue-2*(Bt-ot)+"px",S.style.opacity=".4"})(N,b,u/F(f),r),h.preventDefault(),!0)}return $t(e.registerCommand(rr,(h=>p(h)),zt),e.registerCommand(Qe,(h=>(function(j){if(!m.current)return!1;const[u]=It(j);if(u)return!1;const{target:f,dataTransfer:b,pageY:N}=j,S=b!=null?b.getData(St):"",M=tr(S);if(!M||!st(f))return!1;const k=it(r,e,j,!0);if(!k)return!1;const L=Tt(k);if(!L)return!1;if(L===M)return!0;const K=k.getBoundingClientRect().top;return N/F(f)>=K?L.insertAfter(M):L.insertBefore(M),I(null),!0})(h)),er))}),[r,e,o,I]),Ie.createPortal(t.jsxs(t.Fragment,{children:[t.jsx("div",{draggable:!0,onDragStart:function(p){const h=p.dataTransfer;if(!h||!x)return;(function(u,f){const{transform:b}=f.style;f.style.transform="translateZ(0)",u.setDragImage(f,0,0),setTimeout((()=>{f.style.transform=b}))})(h,x);let j="";e.update((()=>{const u=Tt(x);u&&(j=u.getKey())})),m.current=!0,h.setData(St,j)},onDragEnd:function(){var p;m.current=!1,(p=o.current)&&(p.style.opacity="0",p.style.transform="translate(-10000px, -10000px)")},children:n&&i}),a]}),r)}function ln({anchorElem:e=document.body,menuRef:r,targetLineRef:s,menuComponent:o,targetLineComponent:n,isOnMenu:i,onElementChanged:a}){const[l]=Q();return an(l,e,r,s,l._editable,o,n,i,a)}const cn="draggable-block-menu";function dn(e){return!!e.closest(`.${cn}`)}function un({anchorElem:e=document.body}){const r=g.useRef(null),s=g.useRef(null);return t.jsx(ln,{anchorElem:e,menuRef:r,targetLineRef:s,menuComponent:t.jsx("div",{ref:r,className:"icon draggable-block-menu",children:t.jsx(Rs,{size:14})}),targetLineComponent:t.jsx("div",{ref:s,className:"draggable-block-target-line"}),isOnMenu:dn})}const Z=15,w=30,R=10;function mn({selectionFontSize:e,disabled:r=!1,editor:s}){const{t:o}=E(C.PageEditor,{keyPrefix:"TOOLBAR.FONT_SIZE"}),[n,i]=g.useState(!1),a=d=>{const m=Number(e);if(d.key!=="Tab"){if(["e","E","+","-"].includes(d.key)||isNaN(m)){d.preventDefault();return}i(!0),(d.key==="Enter"||d.key==="Escape")&&(d.preventDefault(),c(m))}},l=()=>{if(e!==""&&n){const d=Number(e);c(d)}},c=d=>{let m=d;d>w?m=w:d<R&&(m=R),dt(s,String(m)+"px",null),i(!1)};return t.jsxs(t.Fragment,{children:[t.jsx("button",{type:"button",disabled:r||e!==""&&Number(e)<=R,onClick:()=>kt(s,"decrement",e),className:"toolbar-item font-decrement","aria-label":o("DECREASE"),title:o("DECREASE"),children:t.jsx(Hs,{size:14})}),t.jsx("input",{name:"fontSize",type:"number",title:"Font size",value:e,disabled:r,style:{textAlign:"center",borderRadius:10,borderWidth:2,borderColor:"#ccc",borderStyle:"solid",width:30,height:30,boxSizing:"border-box","-moz-appearance":"textfield"},className:"font-size-input",min:R,max:w,onKeyDown:a,onBlur:l}),t.jsx("button",{type:"button",disabled:r||e!==""&&Number(e)>=w,onClick:()=>kt(s,"increment",e),className:"toolbar-item font-increment","aria-label":o("INCREASE"),title:o("INCREASE"),children:t.jsx(ct,{size:14})})]})}const oe=(e,r)=>{if(!r)return e;let s=e;switch(r){case"decrement":switch(!0){case e>w:s=w;break;case e>=48:s-=12;break;case e>=24:s-=4;break;case e>=14:s-=2;break;case e>=9:s-=1;break;default:s=R;break}break;case"increment":switch(!0){case e<R:s=R;break;case e<12:s+=1;break;case e<20:s+=2;break;case e<36:s+=4;break;case e<=60:s+=12;break;default:s=w;break}break}return s},dt=(e,r,s)=>{const o=n=>(n||(n=`${Z}px`),n=n.slice(0,-2),`${oe(Number(n),s)}px`);e.update(()=>{if(e.isEditable()){const n=ht();n!==null&&Wt(n,{"font-size":r||o})}})},kt=(e,r,s)=>{if(s!==""){const o=oe(Number(s),r);dt(e,String(o)+"px",null)}else dt(e,null,r)},pn=new Set(["http:","https:","mailto:","sms:","tel:"]);class et extends nr{static getType(){return"link"}static clone(r){return new et(r.__url,{rel:r.__rel,target:r.__target,title:r.__title},r.__key)}constructor(r="",s={},o){super(o);const{target:n=null,rel:i=null,title:a=null}=s;this.__url=r,this.__target=n,this.__rel=i,this.__title=a}createDOM(r){const s=document.createElement("a");return this.updateLinkDOM(null,s,r),or(s,r.theme.link),s}updateLinkDOM(r,s,o){if(Gt(s)){r&&r.__url===this.__url||(s.href=this.sanitizeUrl(this.__url));for(const n of["target","rel","title"]){const i=`__${n}`,a=this[i];r&&r[i]===a||(a?s[n]=a:s.removeAttribute(n))}}}updateDOM(r,s,o){return this.updateLinkDOM(r,s,o),!1}static importDOM(){return{a:r=>({conversion:hn,priority:1})}}static importJSON(r){return ut().updateFromJSON(r)}updateFromJSON(r){return super.updateFromJSON(r).setURL(r.url).setRel(r.rel||null).setTarget(r.target||null).setTitle(r.title||null)}sanitizeUrl(r){r=Lt(r);try{const s=new URL(Lt(r));if(!pn.has(s.protocol))return"about:blank"}catch{return r}return r}exportJSON(){return{...super.exportJSON(),rel:this.getRel(),target:this.getTarget(),title:this.getTitle(),url:this.getURL()}}getURL(){return this.getLatest().__url}setURL(r){const s=this.getWritable();return s.__url=r,s}getTarget(){return this.getLatest().__target}setTarget(r){const s=this.getWritable();return s.__target=r,s}getRel(){return this.getLatest().__rel}setRel(r){const s=this.getWritable();return s.__rel=r,s}getTitle(){return this.getLatest().__title}setTitle(r){const s=this.getWritable();return s.__title=r,s}insertNewAfter(r,s=!0){const o=ut(this.__url,{rel:this.__rel,target:this.__target,title:this.__title});return this.insertAfter(o,s),o}canInsertTextBefore(){return!1}canInsertTextAfter(){return!1}canBeEmpty(){return!1}isInline(){return!0}extractWithChild(r,s,o){if(!Kt(s))return!1;const n=s.anchor.getNode(),i=s.focus.getNode();return this.isParentOf(n)&&this.isParentOf(i)&&s.getTextContent().length>0}isEmailURI(){return this.__url.startsWith("mailto:")}isWebSiteURI(){return this.__url.startsWith("https://")||this.__url.startsWith("http://")}}function hn(e){let r=null;if(Gt(e)){const s=e.textContent;(s!==null&&s!==""||e.children.length>0)&&(r=ut(e.getAttribute("href")||"",{rel:e.getAttribute("rel"),target:e.getAttribute("target"),title:e.getAttribute("title")}))}return{node:r}}function ut(e="",r){return ir(new et(e,r))}function xn(e){return e instanceof et}const gn=/^\+?[0-9\s()-]{5,}$/;function Lt(e){return e.match(/^[a-z][a-z0-9+.-]*:/i)||e.match(/^[/#.]/)?e:e.includes("@")?`mailto:${e}`:gn.test(e)?`tel:${e}`:`https://${e}`}const O=20,ie=["Arial","Courier New","Georgia","Nunito","Times New Roman","Verdana"],mt=ie[0];function fn({editor:e,value:r,disabled:s=!1}){const o=g.useCallback(n=>{e.update(()=>{const i=ht();i!==null&&Wt(i,{"font-family":n})})},[e]);return t.jsx(qt,{variant:"standard",disableUnderline:!0,disabled:s,label:r,value:r||mt,sx:{ml:1},renderValue:n=>t.jsxs(H,{sx:{display:"flex",alignItems:"center",fontFamily:n,gap:1},children:[t.jsx(Ys,{size:O}),n.split(" ")[0].slice(0,6)]}),children:ie.map(n=>t.jsx(gt,{onClick:()=>o(n),sx:{fontFamily:n},children:n},n))})}function jn({editor:e,value:r}){const{t:s}=E(C.PageEditor,{keyPrefix:"TOOLBAR.TEXT_FORMAT"}),o={left:{icon:t.jsx(Qr,{size:O}),name:s("LEFT")},right:{icon:t.jsx(qr,{size:O}),name:s("RIGHT")},center:{icon:t.jsx(Xr,{size:O}),name:s("CENTER")},justify:{icon:t.jsx(Ks,{size:O}),name:s("JUSTIFY")}},n=r in o?o[r||"left"]:o.left;return t.jsx(qt,{variant:"standard",disableUnderline:!0,value:r||"left",label:n.name,sx:{ml:1},renderValue:()=>t.jsx(H,{sx:{display:"flex",alignItems:"center"},children:n.icon}),children:Object.entries(o).map(([i,a])=>t.jsxs(gt,{value:i,onClick:()=>{e.dispatchCommand(ar,i)},sx:{gap:1},children:[a.icon," ",a.name]}))})}function _n(){const{t:e}=E(C.PageEditor),{t:r}=E(C.Common),[s]=Q(),{isOpen:o,closeModal:n,openModal:i}=v(),a=ts({}),{handleSubmit:l,formState:{isValid:c,isSubmitted:d}}=a,m=x=>{s.dispatchCommand(lr,{url:x.url}),n()};return t.jsxs(t.Fragment,{children:[t.jsx(U,{size:"small",variant:"outlined",onClick:i,"aria-label":e("TOOLBAR.LINK_ITEM.BUTTON"),id:Te,children:e("TOOLBAR.LINK_ITEM.BUTTON")}),t.jsx(Jt,{onClose:n,open:o,children:t.jsx(H,{component:"form",onSubmit:l(m),children:t.jsxs(es,{...a,children:[t.jsx(Qt,{children:e("TOOLBAR.LINK_ITEM.INSERT.TITLE")}),t.jsx(Zt,{children:t.jsx(rs,{})}),t.jsxs(te,{children:[t.jsx(U,{onClick:n,children:r("CANCEL.BUTTON_TEXT")}),t.jsx(U,{variant:"contained",type:"submit",disabled:d&&!c,children:e("TOOLBAR.LINK_ITEM.INSERT.SUBMIT_BUTTON")})]})]})})})]})}function In(e){const r=e.anchor,s=e.focus,o=e.anchor.getNode(),n=e.focus.getNode();return o===n?o:e.isBackward()?Et(s)?o:n:Et(r)?o:n}function at(){return t.jsx("div",{className:"divider"})}function Tn(){const[e]=Q(),r=g.useRef(null),[s,o]=g.useState(!1),[n,i]=g.useState(!1),[a,l]=g.useState(!1),[c,d]=g.useState(!1),[m,x]=g.useState("left"),[_,I]=g.useState(`${Z}`),[p,h]=g.useState(mt),j=g.useCallback(()=>{const u=ht();if(Kt(u)){o(u.hasFormat("bold")),i(u.hasFormat("italic")),l(u.hasFormat("underline")),d(u.hasFormat("strikethrough"));const f=In(u),b=f.getParent();let N;xn(b)&&(N=cr(f,M=>nt(M)&&!M.isInline()));const S=nt(N)?N.getFormatType():nt(f)?f.getFormatType():b?.getFormatType()||"left";x(S),I(Ct(u,"font-size",`${Z}px`).slice(0,2)),h(Ct(u,"font-family",mt))}},[]);return g.useEffect(()=>$t(e.registerUpdateListener(({editorState:u})=>{u.read(()=>{j()})}),e.registerCommand(dr,(u,f)=>(j(),!1),zt)),[e,j]),t.jsxs("div",{className:"toolbar",ref:r,children:[t.jsx(fn,{value:p,editor:e}),t.jsx(at,{}),t.jsx(mn,{selectionFontSize:_,editor:e}),t.jsx(at,{}),t.jsx("button",{onClick:()=>{e.dispatchCommand(V,"bold")},className:"toolbar-item spaced "+(s?"active":""),"aria-label":"Format Bold",children:t.jsx(As,{size:O})}),t.jsx("button",{onClick:()=>{e.dispatchCommand(V,"italic")},className:"toolbar-item spaced "+(n?"active":""),"aria-label":"Format Italics",children:t.jsx(Ds,{size:O})}),t.jsx("button",{onClick:()=>{e.dispatchCommand(V,"underline")},className:"toolbar-item spaced "+(a?"active":""),"aria-label":"Format Underline",children:t.jsx(qs,{size:O})}),t.jsx("button",{onClick:()=>{e.dispatchCommand(V,"strikethrough")},className:"toolbar-item spaced "+(c?"active":""),"aria-label":"Format Strikethrough",children:t.jsx(Ws,{size:O})}),t.jsx(at,{}),t.jsx(jn,{value:m,editor:e}),t.jsx(_n,{})]})}function En(e){console.error(e)}function Cn({item:e,currentAccount:r}){const{t:s}=E(C.PageEditor),{providerFactory:o,activeUsers:n,connected:i,hasTimedOut:a}=ur({edit:!0}),l=g.useRef(null),[c,d]=g.useState(null),m=_=>{_!==null&&d(_)},x={editorState:null,namespace:"MyEditor",theme:gr,onError:En,nodes:[pr,hr,xr],editable:!0};return t.jsxs("div",{ref:l,className:"editor-wrapper",children:[t.jsx(rn,{users:n,isConnected:i}),a&&t.jsx(D,{severity:"error",action:t.jsx(U,{size:"small",onClick:()=>{window.location.reload()},children:s("RELOAD_BUTTON")}),children:s("DISCONNECTED_TEXT")}),!a&&t.jsx(t.Fragment,{children:t.jsx(mr,{initialConfig:x,children:t.jsxs("div",{className:"editor-container",children:[t.jsx(Tn,{}),t.jsxs("div",{className:"editor-inner",children:[t.jsx(fr,{id:e.id,providerFactory:o,shouldBootstrap:!1,username:r?.name,cursorColor:en(r?.id||""),cursorsContainerRef:l}),t.jsx(jr,{contentEditable:t.jsx("div",{className:"editor-scroller",children:t.jsx("div",{className:"editor",ref:m,children:t.jsx(Ir,{className:"content-editable-root",style:{fontSize:Z},"aria-placeholder":s("EDITOR.PLACEHOLDER"),placeholder:t.jsx("div",{className:"editor-placeholder",children:s("EDITOR.PLACEHOLDER")})})})}),ErrorBoundary:_r}),t.jsx(tn,{}),t.jsx(Tr,{}),c&&t.jsx(un,{anchorElem:c})]})]})})})]})}const pt=({previousItemId:e,size:r="small",type:s="button"})=>{const[o,n]=g.useState(!1),{t:i}=E(C.Builder),a=vt(),l=()=>{n(!0)},c=()=>{n(!1)};return t.jsxs(t.Fragment,{children:[s==="icon"?t.jsx(G,{onClick:l,color:"primary",sx:{background:a.palette.primary.main,"&:hover":{background:"grey"}},"data-umami-event":"new-item-icon-button",children:t.jsx(ct,{color:"white"})}):t.jsx(ls,{id:Ee,onClick:l,color:"primary","aria-label":"add",startIcon:t.jsx(ct,{}),size:r,"data-umami-event":"new-item-button",children:i(J.NEW_ITEM_BUTTON)}),t.jsx(cs,{open:o,handleClose:c,previousItemId:e})]})},yn=({parentId:e})=>{const r=Dt(),s=n=>{r({to:"/player/$rootId/$itemId",params:{rootId:n.id,itemId:n.id}})},o=n=>{r({to:"/builder/items/$itemId",params:{itemId:n.id}})};return t.jsx(ds,{parentId:e,height:"100%",viewItem:s,viewItemInBuilder:o})},bn=({items:e})=>{const{selectedIds:r,clearSelection:s}=jt(),o=e?.filter(({id:m})=>r.includes(m)),{isOpen:n,openModal:i,closeModal:a}=v(),{isOpen:l,openModal:c,closeModal:d}=v();return t.jsxs(t.Fragment,{children:[t.jsx(Vt,{onClose:()=>{a(),s()},open:n,items:o}),t.jsx(Or,{onClose:()=>{d(),s()},open:l,items:o}),t.jsx(us,{children:t.jsxs(t.Fragment,{children:[t.jsx(kr,{onClick:c}),t.jsx(Yt,{onClick:i}),t.jsx(Xt,{onClick:s,color:"primary",itemIds:r})]})})]})},At="items-container-id",Nn=({item:e,searchText:r,items:s,sortBy:o,canWrite:n=!1})=>{const{mode:i}=is(),{itemTypes:a}=ee(),{selectedIds:l,clearSelection:c,toggleSelection:d}=jt(),m=ps({containerId:At});return g.useEffect(()=>{c()},[c,e.id]),i===ye.Map?t.jsx(H,{flex:1,mt:1,children:t.jsx(yn,{parentId:e.id})}):s?.length?t.jsxs(t.Fragment,{children:[t.jsxs(hs,{id:At,children:[t.jsx(vr,{selectedIds:l,enableMoveInBetween:o===lt.Order,id:be(e.id),items:s??[],onCardClick:d,onMove:c}),!!(n&&!r&&!a?.length)&&t.jsx(T,{alignItems:"center",mb:2,children:t.jsx(pt,{type:"icon",previousItemId:s?s[s.length-1]?.id:void 0},"newButton")})]}),m]}):!s?.length&&(r.length||a.length)?t.jsx(xs,{searchText:r}):e.permission&&$.gte(e.permission,"write")?t.jsx(H,{mt:1,children:t.jsx(as,{buttons:t.jsxs(t.Fragment,{children:[t.jsx(re,{size:"small"},"newFolder"),t.jsx(pt,{size:"small"},"newButton")]})})}):null},Mn=({item:e})=>{const r=vt(),s=fs(r.breakpoints.up("sm")),{itemTypes:o}=ee(),{t:n}=E(C.Builder),{selectedIds:i}=jt(),a=Lr(),{canWrite:l}=ft(),{data:c,isLoading:d,isError:m}=z.useChildren(e.id,{ordered:!0,keywords:a.text,types:o}),{ordering:x,setOrdering:_,setSortBy:I,sortBy:p,sortFn:h}=Ar({sortBy:lt.Order,ordering:Ce.ASC}),j=Object.values(lt).sort((u,f)=>n(u).localeCompare(n(f)));if(c){const u=c.toSorted(h);return t.jsxs(t.Fragment,{children:[t.jsx(Er,{item:e}),t.jsxs(T,{direction:"row",justifyContent:"space-between",spacing:1,my:2,children:[a.input,t.jsx(T,{direction:"row",alignItems:"center",justifyContent:"flex-end",spacing:1,children:l&&t.jsxs(T,{direction:"row",spacing:1,children:[t.jsx(re,{type:s?"button":"icon",previousItemId:c[c.length-1]?.id}),t.jsx(pt,{type:s?"button":"icon",size:"medium",previousItemId:c[c.length-1]?.id},"newButton")]})})]}),u.length?t.jsx(T,{alignItems:"space-between",direction:"column",mt:2,gap:1,width:"100%",children:i.length?t.jsx(bn,{items:u}):t.jsxs(T,{spacing:1,direction:"row",justifyContent:"space-between",alignItems:"center",children:[t.jsx(wr,{}),t.jsxs(T,{direction:"row",gap:1,children:[p&&I&&t.jsx(Rr,{ordering:x,sortBy:p,setSortBy:I,options:j,setOrdering:_}),t.jsx(gs,{})]})]})}):null,!u.length&&!l?t.jsx(D,{severity:"info",sx:{mt:2},children:n("EMPTY_FOLDER_MESSAGE")}):null,t.jsx(Nn,{canWrite:l,sortBy:p,item:e,items:u,searchText:a.text})]})}return d?t.jsx(xt,{}):m?t.jsx(tt,{id:W}):t.jsx(D,{severity:"info",children:n("ITEMS_TABLE_EMPTY_MESSAGE")})},Sn=({item:e})=>t.jsx(ms,{children:t.jsx(Ut,{maxWidth:"lg",children:t.jsx(Mn,{item:e})})}),Bn="70vh",{useFileContentUrl:On,useEtherpad:kn}=z,ae=Pt(Ut)(()=>({flexGrow:1})),Ln=({item:e})=>{const{data:r,isLoading:s,isError:o}=On(e.id);return r?t.jsx(ae,{children:t.jsxs(T,{direction:"column",alignItems:"center",gap:2,width:"100%",children:[t.jsxs(T,{direction:"row",gap:1,children:[t.jsx(Jr,{item:e,variant:Nt.Button}),t.jsx(Zr,{item:e,variant:Nt.Button})]}),t.jsx(Mr,{fileUrl:r,id:ke(e.id),item:e,pdfViewerLink:Sr(Le)})]})}):s?t.jsx(P,{height:"50vh"}):o?t.jsx(tt,{id:W}):null},An=({item:e,member:r})=>t.jsx(ss,{id:e.id,memberId:r?.id,isResizable:!0,item:e,thumbnail:_s(e.extra),height:Bn,showButton:!!e.settings?.showLinkButton,showIframe:!!e.settings?.showLinkIframe}),wn=({item:e})=>t.jsx(ae,{children:t.jsx(Nr,{id:Oe,item:e})}),Rn=({item:e,member:r,permission:s})=>t.jsx(ns,{isResizable:!1,item:e,height:"100%",requestApiAccessToken:o=>os(o),contextPayload:{apiHost:Be,itemId:e.id,accountId:r?.id,permission:s??"read",settings:e.settings,lang:e.lang||r?.lang||Se,context:Me.Builder}}),vn=({item:e})=>{const r=ks(e?.extra);return r?.contentId?t.jsx(br,{itemId:e.id,itemName:e.name,contentId:r.contentId,integrationUrl:Ne}):t.jsx(tt,{id:W})},Dn=({item:e})=>{const{t:r}=E(C.Builder),s=Dr(e?.extra),{data:o,isFetching:n}=z.useItem(s.target);return o?t.jsx(le,{item:o}):n?t.jsx(P,{width:"100%",height:"200px"}):t.jsx(D,{severity:"error",children:r("SHORTCUT_FETCHING_ISSUE")})},Un=({item:e})=>{const{data:r,isLoading:s,isError:o}=kn(e,"write");return s?t.jsx(xt,{}):!r?.padUrl||o?t.jsx(tt,{id:W}):t.jsx(yr,{itemId:e.id,padUrl:r.padUrl,options:{showChat:!1}})},Fn=({item:e,currentAccount:r})=>{const{t:s}=E(C.PageEditor),{canWrite:o}=ft();return r&&o?t.jsxs(t.Fragment,{children:[t.jsxs(D,{severity:"warning",children:[t.jsx(Mt,{t:s,i18nKey:"WARNINGS.BETA",components:{1:t.jsx("a",{target:"_blank",href:"https://graasp.github.io/docs/blog/unlisted/pages/",children:"link"}),bold:t.jsx("strong",{})}}),t.jsx("br",{}),t.jsx(Mt,{t:s,i18nKey:"WARNINGS.FEEDBACK",components:{1:t.jsx("a",{target:"_blank",href:"https://docs.google.com/forms/d/e/1FAIpQLSe79M8aXDYkS2Rjz7xZg0Ns8hjDY6YvaVEpjqVfb3dXQW48cg/viewform?usp=dialog",children:"link"})}})]}),t.jsx(Cn,{item:e,currentAccount:r})]}):t.jsx(Cr,{item:e})};function le({item:e}){const{t:r}=E(C.Builder),{user:s}=Ft();switch(e.type){case"file":return t.jsx(Ln,{item:e});case"embeddedLink":return t.jsx(An,{item:e,member:s});case"document":return t.jsx(wn,{item:e});case"app":return t.jsx(Rn,{item:e,member:s,permission:e?.permission});case"folder":return t.jsx(Sn,{item:e});case"h5p":return t.jsx(vn,{item:e});case"etherpad":return t.jsx(Un,{item:e});case"shortcut":return t.jsx(Dn,{item:e});case"page":return t.jsx(Fn,{item:e,currentAccount:s});default:return t.jsx(D,{id:W,severity:"error",children:r("ITEM_TYPE_COULD_NOT_BE_HANDLED",{type:e.type})})}}const wt=300,Pn=Pt(Ts)(({theme:e,open:r})=>({width:r?wt:0,flexShrink:0,".MuiDrawer-paper":{padding:e.spacing(0,1),boxSizing:"border-box",width:wt}})),Hn=({open:e,children:r})=>t.jsxs(Pn,{id:Ae,anchor:"right",variant:"persistent",open:e,children:[t.jsx(Is,{}),r]});function $n({itemName:e}){const r=Dt(),{t:s}=E(C.Common),{t:o}=E(C.Builder,{keyPrefix:"COPY_WARNING_MODAL"}),{closeModal:n,isOpen:i}=v({isInitiallyOpen:!0}),a=()=>{r({to:we,search:{url:window.location.href}})};return t.jsxs(Jt,{open:i,onClose:n,children:[t.jsx(Qt,{children:o("TITLE",{name:e})}),t.jsx(Zt,{children:o("DESCRIPTION")}),t.jsxs(te,{children:[t.jsx(U,{onClick:n,children:s("CANCEL.BUTTON_TEXT")}),t.jsx(U,{"aria-label":o("LOGIN"),variant:"contained",onClick:a,children:o("LOGIN")})]})]})}const zn=({tooltip:e,showChat:r,id:s,onClick:o,size:n,menuItemClassName:i,type:a,showChatText:l="Show Chat",hideChatText:c="Hide Chat",color:d="inherit"})=>{const{color:m}=Re(d),x=r?t.jsx(bs,{color:m}):t.jsx(Fs,{color:m}),_=r?c:l;switch(a){case y.ICON:return x;case y.MENU_ITEM:return t.jsx(Cs,{icon:x,text:_,onClick:o,className:i});case y.ICON_BUTTON:default:return t.jsx(_t,{title:e,children:t.jsx("span",{children:t.jsx(G,{id:s,onClick:o,size:n,children:x})})})}},Wn=({itemId:e})=>{const{t:r}=E(C.Builder),s=r(J.LIBRARY_SETTINGS_BUTTON_TITLE);return t.jsx(_t,{title:s,children:t.jsx(Ht,{to:"/builder/items/$itemId/publish",params:{itemId:e},children:t.jsx(G,{"aria-label":s,className:De,id:ve(e),children:t.jsx(Ns,{})})})})},Gn=({className:e,tooltip:r="Share",ariaLabel:s,id:o,onClick:n,size:i,type:a=y.ICON_BUTTON})=>{const l=t.jsx(Zs,{});switch(a){case y.ICON:return l;case y.MENU_ITEM:return t.jsxs(gt,{className:e,onClick:n,children:[t.jsx(Ms,{children:l}),t.jsx(Ss,{children:r})]},r);case y.ICON_BUTTON:default:return t.jsx(_t,{title:r,children:t.jsx("span",{children:t.jsx(G,{"aria-label":s??r,className:e,onClick:n,id:o,size:i,children:l})})})}},Kn=({itemId:e})=>{const{t:r}=E(C.Builder);return t.jsx(Ht,{to:"/builder/items/$itemId/share",params:{itemId:e},children:t.jsx(Gn,{tooltip:r(J.SHARE_ITEM_BUTTON),ariaLabel:r(J.SHARE_ITEM_BUTTON),className:Fe,id:Ue(e)})})},Rt="menu",Vn=({item:e})=>{const{copyOpen:r}=Pe({from:"/builder/items/$itemId"}),{t:s}=E(C.Common,{keyPrefix:"ARIA"}),{data:o}=z.useCurrentMember(),[n,i]=g.useState(null),a=!!n,l=f=>{i(f.currentTarget)},c=()=>{i(null)},{isOpen:d,openModal:m,closeModal:x}=v(),{isOpen:_,openModal:I,closeModal:p}=v({isInitiallyOpen:r}),h=e.permission&&$.gte(e.permission,"write"),j=e.permission&&$.gte(e.permission,"admin");if(!o?.id)return null;const u=e.type==="folder"?t.jsx(Ur,{item:e,dataUmamiContext:"header"},"export-zip"):t.jsx(Fr,{item:e,type:y.MENU_ITEM},"download");return[t.jsx(Vt,{onClose:p,open:_,items:[e]}),t.jsx(Pr,{item:e,onClose:x,open:d},"shortcutModal"),t.jsx(G,{"aria-label":s("MORE"),"aria-controls":a?Rt:void 0,"aria-haspopup":"true","aria-expanded":a,onClick:l,children:t.jsx(Bs,{})},"moreVertButton"),t.jsxs(Os,{id:Rt,anchorEl:n,open:a,onClose:c,children:[o.type===He.Individual?[t.jsx(Yt,{type:y.MENU_ITEM,onClick:()=>{I(),c()}},"copy"),t.jsx(Hr,{onClick:()=>{m(),c()}},"shortcut"),t.jsx($r,{size:"medium",type:y.MENU_ITEM,item:e,className:$e},"bookmark"),t.jsx(q,{},"downloadDivider"),h&&[t.jsx(zr,{type:y.MENU_ITEM,item:e},"hide"),t.jsx(Wr,{type:y.MENU_ITEM,item:e},"pin"),e.type!=="folder"&&t.jsx(ys,{type:y.MENU_ITEM,item:e},"collapse"),t.jsx(q,{},"canWriteDivider")],u,t.jsx(q,{},"canWriteEndDivider")]:null,t.jsx(Gr,{item:e}),j&&t.jsx(Xt,{type:y.MENU_ITEM,itemIds:[e.id],onClick:c},"recycle")]},"menu")]},{useItem:Yn}=z,Xn=({itemId:e,isChatboxOpen:r,toggleChatbox:s})=>{const{t:o}=E(C.Builder),{data:n}=Yn(e),{isOpen:i,openModal:a,closeModal:l}=v(),c=n?.permission?$.gte(n.permission,"write"):!1,d=n?.permission?$.gte(n.permission,"admin"):!1;return n&&n?.id?t.jsxs(T,{direction:"row",children:[c&&t.jsxs(t.Fragment,{children:[t.jsx(Kr,{onClose:l,open:i,item:n}),t.jsx(Vr,{onClick:a,type:y.ICON_BUTTON,itemId:n.id})]}),t.jsx(Kn,{itemId:n.id}),t.jsx(zn,{showChat:r,tooltip:o("ITEM_CHATBOX_TITLE",{name:n.name}),id:ze,onClick:s}),d&&t.jsx(Wn,{itemId:n.id}),c&&t.jsx(Yr,{itemId:n.id}),t.jsx(Vn,{item:n})]}):null},qn=({isChatboxOpen:e,toggleChatbox:r})=>{const{itemId:s}=We({strict:!1}),{t:o}=E(C.Builder);return t.jsxs(T,{direction:"row",justifyContent:"space-between",alignItems:"center",mb:1,id:Ge,children:[t.jsx(Es,{}),s?t.jsx(T,{flexGrow:1,alignItems:"flex-end",children:t.jsx(Xn,{itemId:s,isChatboxOpen:e,toggleChatbox:r})}):t.jsx(D,{severity:"error",children:o("ERROR_MESSAGE")})]})};function Ka(){const{item:e}=ft(),{t:r}=E(C.Builder),{user:s}=Ft(),{chatOpen:o,copyOpen:n}=Ke.useSearch(),[i,a]=g.useState(o??!1),l=()=>a(c=>!c);return e?t.jsxs(t.Fragment,{children:[t.jsx(Ve,{children:t.jsx("title",{children:e.name})}),n&&!s?t.jsx($n,{itemName:e.name}):null,t.jsxs(T,{direction:"row",className:Ye,height:"100%",children:[t.jsxs(T,{p:2,width:"100%",maxWidth:"xl",mx:"auto",children:[t.jsx(qn,{isChatboxOpen:i,toggleChatbox:l}),t.jsx(le,{item:e})]}),i&&t.jsxs(Hn,{open:i,children:[t.jsx(Br,{handleDrawerClose:()=>{a(!1)},children:t.jsx(Xe,{variant:"h6",children:r("ITEM_CHATBOX_TITLE",{name:e.name})})}),t.jsx(q,{}),t.jsx(Qs,{item:e})]})]})]}):t.jsx(qe,{})}export{Ka as component};
