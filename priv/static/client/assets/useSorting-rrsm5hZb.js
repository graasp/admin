import{x as mt,w as pt,r as I,z as ht,j as e,s as gt,B as Oe,E as ft,bj as Tt,v as F,b as h,N as g,S as Z,f8 as xt,f as Se,eN as T,c3 as Fe,f9 as It,k as pe,m as ie,fa as Et,fb as ve,fc as Mt,h as He,A as Ee,Z as C,fd as St,bb as se,fe as jt,y as te,ff as Ct,fg as _t,fh as De,e2 as je,fi as yt,fj as Ot,fk as vt,fl as Dt,fm as Ve,fn as bt,fo as Bt,fp as Nt,fq as Pt,dM as ne,dI as q,dJ as wt,fr as At,dL as Ge,fs as kt,eq as Ut,ft as Lt,fu as Rt,T as $e,fv as Ft,fw as Ht,L as Vt,fx as Gt,fy as $t,fz as qt,fA as zt,fB as qe,fC as Xt,f2 as Wt,dP as Kt,fD as Yt,c_ as ee}from"./index-B_BHgQQY.js";import{I as be,C as Qt}from"./ItemIcon-aRVTEBTL.js";import{u as Zt}from"./FilterItemsContext-D5pcm88K.js";import{F as ze}from"./FormControl-DkBPBeJg.js";import{I as Xe,S as We,O as Ke,T as Ye}from"./TextField-CCzZwtaB.js";import{M as D}from"./MenuItem-i4R53H8t.js";import{C as Jt}from"./Checkbox-CAPv11-J.js";import{L as es}from"./ListItemText-Db53d-gu.js";import{I as ts}from"./InputAdornment-CGS_1X61.js";import{i as me,s as Be,w as ss,f as Ne,h as Ce,j as Me,r as ns,k as rs,l as os,S as as,u as Qe,F as Ze,d as is,H as cs,I as z,c as _e,D as ls,a as ds,b as ge,E as us,e as ms,m as ps,L as hs,g as gs,n as fs}from"./LinkTypeFormControl-Cx3z8ol1.js";import{B as E}from"./langs-BKRoRoQy.js";import{G as ce}from"./Button-C2DML4l_.js";import{B as O}from"./Box-CXXiFbSb.js";import{G as fe}from"./Grid-DwBZvdO2.js";import{u as Ts}from"./uploadWithProgress-X8OCjAji.js";import{L as xs}from"./LibraryIcon-Us5FpFqN.js";import{u as Is}from"./useSlot-D6B6Ly0P.js";import{A as Je,a as Es}from"./Avatar-BO-XeDPi.js";import{E as et}from"./eye-off-WWB42nol.js";import{P as Ms,M as Ss}from"./pin-CWXz_P8J.js";import{T as R}from"./Tooltip-CY4gBTjx.js";import{u as js}from"./useLocation-C8vtnVMT.js";import{C as Cs}from"./CustomLink-CCI7pO31.js";import{g as _s}from"./capsule-ocBuEWIN.js";import{u as ys}from"./LayoutContext-DvWbprYl.js";import{M as Os,P as vs,C as Ds}from"./PinButton-B2O-3CYr.js";import{I as N}from"./IconButton-t5WdCoTE.js";import{I as bs}from"./ItemCard-NGB9iUow.js";import{L as P}from"./ListItemIcon-BTN91sVG.js";import{C as tt,I as ye,E as Bs,a as st}from"./EditButton-ZZbYvNZm.js";import{a as Ns}from"./FlagItemModalContext-B9D_0oH9.js";import{E as Ps}from"./eye-c2LSV0oY.js";import{T as Pe}from"./trash-CYNfI7WN.js";import{u as ue}from"./useModalStatus-CF1QQN94.js";import{u as X,F as W}from"./index.esm-D6N0kWEX.js";import{C as K}from"./CancelButton-DsqMvRyV.js";import{a as H,D as nt}from"./DialogContent-BLGJ1kXP.js";import{D as V}from"./DialogActions-B4c7iV3e.js";import{B as le}from"./Button-4ORflwU5.js";import{D as ws,b as As,L as ks}from"./LinkUrlField-BcIiYqG0.js";import{M as Us}from"./mimeTypes-Bpmm_hmI.js";import{D as rt}from"./DialogTitle-BL-ZXwRQ.js";import{M as Ls}from"./MenuItemLink-BMQoDPhe.js";import{S as we}from"./settings-CTRMiCcG.js";import{I as ot}from"./itemType-D9KQEJss.js";import{D as Rs}from"./download-C1DwLYTP.js";import{D as Fs}from"./Divider-DwBPlmwR.js";import{M as at}from"./Menu-C45l_y2r.js";import{P as Ae}from"./permissionLevel-BOsSKewz.js";import{T as Hs}from"./Trans-1gex2Erj.js";import{S as Vs}from"./Skeleton-Bf_dEhrE.js";import{F as Gs}from"./RadioGroup-B8axso0y.js";function $s(t){return pt("MuiAvatarGroup",t)}const qs=mt("MuiAvatarGroup",["root","avatar"]),Te={small:-16,medium:-8},zs=t=>{const{classes:s}=t;return ft({root:["root"],avatar:["avatar"]},$s,s)},Xs=gt("div",{name:"MuiAvatarGroup",slot:"Root",overridesResolver:(t,s)=>[{[`& .${qs.avatar}`]:s.avatar},s.root]})(Tt(({theme:t})=>({display:"flex",flexDirection:"row-reverse",[`& .${Es.root}`]:{border:`2px solid ${(t.vars||t).palette.background.default}`,boxSizing:"content-box",marginLeft:"var(--AvatarGroup-spacing, -8px)","&:last-child":{marginLeft:0}}}))),Ws=I.forwardRef(function(s,n){const r=ht({props:s,name:"MuiAvatarGroup"}),{children:o,className:a,component:l="div",componentsProps:c,max:i=5,renderSurplus:d,slotProps:u={},slots:m={},spacing:f="medium",total:p,variant:M="circular",...j}=r;let y=i<2?2:i;const S={...r,max:i,spacing:f,component:l,variant:M},w=zs(S),Y=I.Children.toArray(o).filter(L=>I.isValidElement(L)),A=p||Y.length;A===y&&(y+=1),y=Math.min(A+1,y);const b=Math.min(Y.length,y-1),k=Math.max(A-y,A-b,0),v=d?d(k):`+${k}`;let U;S.spacing&&Te[S.spacing]!==void 0?U=Te[S.spacing]:S.spacing===0?U=0:U=-S.spacing||Te.medium;const Q={slots:m,slotProps:{surplus:u.additionalAvatar??c?.additionalAvatar,...c,...u}},[re,oe]=Is("surplus",{elementType:Je,externalForwardedProps:Q,className:w.avatar,ownerState:S,additionalProps:{variant:M}});return e.jsxs(Xs,{as:l,ownerState:S,className:Oe(w.root,a),ref:n,...j,style:{"--AvatarGroup-spacing":`${U}px`,...j.style},children:[k?e.jsx(re,{...oe,children:v}):null,Y.slice(0,b).reverse().map(L=>I.cloneElement(L,{className:Oe(L.props.className,w.avatar),variant:L.props.variant||M}))]})}),To=t=>t[ot.SHORTCUT],Ks=t=>({[ot.SHORTCUT]:{target:t}});/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ys=[["path",{d:"m3 16 4 4 4-4",key:"1co6wj"}],["path",{d:"M7 20V4",key:"1yoxec"}],["path",{d:"M11 4h4",key:"6d7r33"}],["path",{d:"M11 8h7",key:"djye34"}],["path",{d:"M11 12h10",key:"1438ji"}]],Qs=F("arrow-down-narrow-wide",Ys);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zs=[["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}],["path",{d:"M11 12h10",key:"1438ji"}],["path",{d:"M11 16h7",key:"uosisv"}],["path",{d:"M11 20h4",key:"1krc32"}]],Js=F("arrow-up-wide-narrow",Zs);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const en=[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]],tn=F("bookmark",en);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sn=[["path",{d:"M21.54 15H17a2 2 0 0 0-2 2v4.54",key:"1djwo0"}],["path",{d:"M7 3.34V5a3 3 0 0 0 3 3a2 2 0 0 1 2 2c0 1.1.9 2 2 2a2 2 0 0 0 2-2c0-1.1.9-2 2-2h3.17",key:"1tzkfa"}],["path",{d:"M11 21.95V18a2 2 0 0 0-2-2a2 2 0 0 1-2-2v-1a2 2 0 0 0-2-2H2.05",key:"14pb5j"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],nn=F("earth",sn);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rn=[["path",{d:"M4 22V4a1 1 0 0 1 .4-.8A6 6 0 0 1 8 2c3 0 5 2 7.333 2q2 0 3.067-.8A1 1 0 0 1 20 4v10a1 1 0 0 1-.4.8A6 6 0 0 1 16 16c-3 0-5-2-8-2a6 6 0 0 0-4 1.528",key:"1jaruq"}]],on=F("flag",rn);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const an=[["path",{d:"M12 22v-6",key:"6o8u61"}],["path",{d:"M12 8V2",key:"1wkif3"}],["path",{d:"M4 12H2",key:"rhcxmi"}],["path",{d:"M10 12H8",key:"s88cx1"}],["path",{d:"M16 12h-2",key:"10asgb"}],["path",{d:"M22 12h-2",key:"14jgyd"}],["path",{d:"m15 19-3-3-3 3",key:"e37ymu"}],["path",{d:"m15 5-3 3-3-3",key:"19d6lf"}]],cn=F("fold-vertical",an);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ln=[["path",{d:"M12 2v20",key:"t6zp3m"}],["path",{d:"m15 19-3 3-3-3",key:"11eu04"}],["path",{d:"m19 9 3 3-3 3",key:"1mg7y2"}],["path",{d:"M2 12h20",key:"9i4pu4"}],["path",{d:"m5 9-3 3 3 3",key:"j64kie"}],["path",{d:"m9 5 3-3 3 3",key:"l8vdw6"}]],dn=F("move",ln);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const un=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],mn=F("package",un);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pn=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],hn=F("upload",pn);function gn(t){return I.useMemo(()=>t.hooks.dragSource(),[t])}function fn(t){return I.useMemo(()=>t.hooks.dragPreview(),[t])}let xe=!1,Ie=!1;class Tn{receiveHandlerId(s){this.sourceId=s}getHandlerId(){return this.sourceId}canDrag(){me(!xe,"You may not call monitor.canDrag() inside your canDrag() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source-monitor");try{return xe=!0,this.internalMonitor.canDragSource(this.sourceId)}finally{xe=!1}}isDragging(){if(!this.sourceId)return!1;me(!Ie,"You may not call monitor.isDragging() inside your isDragging() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source-monitor");try{return Ie=!0,this.internalMonitor.isDraggingSource(this.sourceId)}finally{Ie=!1}}subscribeToStateChange(s,n){return this.internalMonitor.subscribeToStateChange(s,n)}isDraggingSource(s){return this.internalMonitor.isDraggingSource(s)}isOverTarget(s,n){return this.internalMonitor.isOverTarget(s,n)}getTargetIds(){return this.internalMonitor.getTargetIds()}isSourcePublic(){return this.internalMonitor.isSourcePublic()}getSourceId(){return this.internalMonitor.getSourceId()}subscribeToOffsetChange(s){return this.internalMonitor.subscribeToOffsetChange(s)}canDragSource(s){return this.internalMonitor.canDragSource(s)}canDropOnTarget(s){return this.internalMonitor.canDropOnTarget(s)}getItemType(){return this.internalMonitor.getItemType()}getItem(){return this.internalMonitor.getItem()}getDropResult(){return this.internalMonitor.getDropResult()}didDrop(){return this.internalMonitor.didDrop()}getInitialClientOffset(){return this.internalMonitor.getInitialClientOffset()}getInitialSourceClientOffset(){return this.internalMonitor.getInitialSourceClientOffset()}getSourceClientOffset(){return this.internalMonitor.getSourceClientOffset()}getClientOffset(){return this.internalMonitor.getClientOffset()}getDifferenceFromInitialOffset(){return this.internalMonitor.getDifferenceFromInitialOffset()}constructor(s){this.sourceId=null,this.internalMonitor=s.getMonitor()}}class xn{receiveHandlerId(s){this.handlerId!==s&&(this.handlerId=s,this.reconnect())}get connectTarget(){return this.dragSource}get dragSourceOptions(){return this.dragSourceOptionsInternal}set dragSourceOptions(s){this.dragSourceOptionsInternal=s}get dragPreviewOptions(){return this.dragPreviewOptionsInternal}set dragPreviewOptions(s){this.dragPreviewOptionsInternal=s}reconnect(){const s=this.reconnectDragSource();this.reconnectDragPreview(s)}reconnectDragSource(){const s=this.dragSource,n=this.didHandlerIdChange()||this.didConnectedDragSourceChange()||this.didDragSourceOptionsChange();return n&&this.disconnectDragSource(),this.handlerId?s?(n&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDragSource=s,this.lastConnectedDragSourceOptions=this.dragSourceOptions,this.dragSourceUnsubscribe=this.backend.connectDragSource(this.handlerId,s,this.dragSourceOptions)),n):(this.lastConnectedDragSource=s,n):n}reconnectDragPreview(s=!1){const n=this.dragPreview,r=s||this.didHandlerIdChange()||this.didConnectedDragPreviewChange()||this.didDragPreviewOptionsChange();if(r&&this.disconnectDragPreview(),!!this.handlerId){if(!n){this.lastConnectedDragPreview=n;return}r&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDragPreview=n,this.lastConnectedDragPreviewOptions=this.dragPreviewOptions,this.dragPreviewUnsubscribe=this.backend.connectDragPreview(this.handlerId,n,this.dragPreviewOptions))}}didHandlerIdChange(){return this.lastConnectedHandlerId!==this.handlerId}didConnectedDragSourceChange(){return this.lastConnectedDragSource!==this.dragSource}didConnectedDragPreviewChange(){return this.lastConnectedDragPreview!==this.dragPreview}didDragSourceOptionsChange(){return!Be(this.lastConnectedDragSourceOptions,this.dragSourceOptions)}didDragPreviewOptionsChange(){return!Be(this.lastConnectedDragPreviewOptions,this.dragPreviewOptions)}disconnectDragSource(){this.dragSourceUnsubscribe&&(this.dragSourceUnsubscribe(),this.dragSourceUnsubscribe=void 0)}disconnectDragPreview(){this.dragPreviewUnsubscribe&&(this.dragPreviewUnsubscribe(),this.dragPreviewUnsubscribe=void 0,this.dragPreviewNode=null,this.dragPreviewRef=null)}get dragSource(){return this.dragSourceNode||this.dragSourceRef&&this.dragSourceRef.current}get dragPreview(){return this.dragPreviewNode||this.dragPreviewRef&&this.dragPreviewRef.current}clearDragSource(){this.dragSourceNode=null,this.dragSourceRef=null}clearDragPreview(){this.dragPreviewNode=null,this.dragPreviewRef=null}constructor(s){this.hooks=ss({dragSource:(n,r)=>{this.clearDragSource(),this.dragSourceOptions=r||null,Ne(n)?this.dragSourceRef=n:this.dragSourceNode=n,this.reconnectDragSource()},dragPreview:(n,r)=>{this.clearDragPreview(),this.dragPreviewOptions=r||null,Ne(n)?this.dragPreviewRef=n:this.dragPreviewNode=n,this.reconnectDragPreview()}}),this.handlerId=null,this.dragSourceRef=null,this.dragSourceOptionsInternal=null,this.dragPreviewRef=null,this.dragPreviewOptionsInternal=null,this.lastConnectedHandlerId=null,this.lastConnectedDragSource=null,this.lastConnectedDragSourceOptions=null,this.lastConnectedDragPreview=null,this.lastConnectedDragPreviewOptions=null,this.backend=s}}function In(t,s){const n=Ce(),r=I.useMemo(()=>new xn(n.getBackend()),[n]);return Me(()=>(r.dragSourceOptions=t||null,r.reconnect(),()=>r.disconnectDragSource()),[r,t]),Me(()=>(r.dragPreviewOptions=s||null,r.reconnect(),()=>r.disconnectDragPreview()),[r,s]),r}function En(){const t=Ce();return I.useMemo(()=>new Tn(t),[t])}class Mn{beginDrag(){const s=this.spec,n=this.monitor;let r=null;return typeof s.item=="object"?r=s.item:typeof s.item=="function"?r=s.item(n):r={},r??null}canDrag(){const s=this.spec,n=this.monitor;return typeof s.canDrag=="boolean"?s.canDrag:typeof s.canDrag=="function"?s.canDrag(n):!0}isDragging(s,n){const r=this.spec,o=this.monitor,{isDragging:a}=r;return a?a(o):n===s.getSourceId()}endDrag(){const s=this.spec,n=this.monitor,r=this.connector,{end:o}=s;o&&o(n.getItem(),n),r.reconnect()}constructor(s,n,r){this.spec=s,this.monitor=n,this.connector=r}}function Sn(t,s,n){const r=I.useMemo(()=>new Mn(t,s,n),[s,n]);return I.useEffect(()=>{r.spec=t},[t]),r}function jn(t){return I.useMemo(()=>{const s=t.type;return me(s!=null,"spec.type must be defined"),s},[t])}function Cn(t,s,n){const r=Ce(),o=Sn(t,s,n),a=jn(t);Me(function(){if(a!=null){const[c,i]=ns(a,o,r);return s.receiveHandlerId(c),n.receiveHandlerId(c),i}},[r,s,n,o,a])}function _n(t,s){const n=rs(t,s);me(!n.begin,"useDrag::spec.begin was deprecated in v14. Replace spec.begin() with spec.item(). (see more here - https://react-dnd.github.io/react-dnd/docs/api/use-drag)");const r=En(),o=In(n.options,n.previewOptions);return Cn(n,r,o),[os(n.collect,r,o),gn(o),fn(o)]}const yn=48,On=8,vn={PaperProps:{style:{maxHeight:yn*4.5+On}}},ke="select-types-filter-label",xo=()=>{const{itemTypes:t,setItemTypes:s}=Zt(),{t:n}=h(g.Enums),{t:r}=h(g.Builder),o=["app","page","file","document","folder","h5p","embeddedLink","shortcut","etherpad"].sort((i,d)=>n(i).localeCompare(n(d))),a=i=>{const{target:{value:d}}=i;s(d)},l=r("FILTER_BY_TYPES_LABEL"),c=i=>e.jsx(Z,{direction:"row",spacing:1,flexWrap:"wrap",children:i.map(d=>e.jsx(be,{alt:d,type:d},d))});return e.jsxs(ze,{sx:{width:"max-content",minWidth:"200px"},size:"small",children:[e.jsx(Xe,{id:ke,children:l}),e.jsx(We,{labelId:ke,size:"small",multiple:!0,value:t,onChange:a,input:e.jsx(Ke,{label:l,inputProps:{"data-umami-event":"filter-item-type"}}),renderValue:c,MenuProps:vn,sx:{borderRadius:40},children:o.map(i=>e.jsxs(D,{value:i,disableGutters:!0,sx:{padding:0},children:[e.jsx(Jt,{checked:t.includes(i),size:"small"}),e.jsxs(Z,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(be,{alt:i,type:i}),e.jsx(es,{primary:n(i)})]})]},i))})]})},Dn=({ariaLabel:t="search",inputBaseId:s,onChange:n,placeholder:r="Searchâ€¦",value:o="",width:a,margin:l,size:c,dataUmamiEvent:i})=>e.jsx(Ye,{margin:l,id:s,onChange:n,value:o,sx:{flex:1,width:a??"100%",backgroundColor:"white",maxWidth:200},placeholder:r,size:c,slotProps:{input:{endAdornment:e.jsx(ts,{position:"end",children:e.jsx(as,{"aria-label":"search"})})},htmlInput:{"aria-label":t,"data-umami-event":i}}}),Io=({onSearch:t}={})=>{const{t:s}=h(g.Builder),[n,r]=I.useState(""),o=l=>{const c=l.target.value;r(c),t?.()},a=e.jsx(Dn,{onChange:o,value:n,inputBaseId:xt,placeholder:s(E.ITEM_SEARCH_PLACEHOLDER),size:"small",dataUmamiEvent:"item-search"},"searchInput");return{text:n,input:a}},bn=({row:t,onDrop:s,canDrop:n=()=>!0,isMovable:r=()=>!0,renderComponent:o,allowFiles:a=!0})=>{const l=["row"];a&&l.push(Ze);const[{isOver:c},i]=Qe({accept:l,canDrop:n,drop:p=>{s(p,t)},collect:p=>({isOver:p.getItem()!==t&&n(p.getItem())&&!!p.isOver()})},[s]),[{isDragging:d},u]=_n({collect:p=>({isDragging:p.isDragging()}),item:()=>t,type:"row"}),m=p=>{u(p),i(p)},f=r(t);return e.jsx(O,{ref:f?m:void 0,sx:f?{"&:hover":{cursor:"grab"}}:void 0,children:o(t,{isDragging:d,isOver:c,isMovable:f})})},Ue=({previousRow:t,onDrop:s,enableMoveInBetween:n,renderComponent:r,allowFiles:o=!0})=>{const a=I.useRef(null),l=["row"];o&&l.push(Ze);const[{isOver:c,data:i},d]=Qe(()=>({accept:l,drop:m=>s(m,t),canDrop:()=>n,collect:m=>({isOver:!!m.isOver(),canDrop:!!m.canDrop(),data:m.getItem()})}),[s]);d(a);const u=12;return e.jsxs(O,{ref:a,children:[(!c||!n)&&e.jsx(O,{style:{padding:0,height:u,width:"100%"}}),c&&n&&e.jsx(O,{sx:{opacity:.5,paddingTop:u/8,paddingBottom:u/8},children:r(i,{isOver:!1,isDragging:!1,isMovable:!1})})]})},Bn=({id:t,rows:s=[],getRowId:n,onDropInRow:r,onDropBetweenRow:o,renderComponent:a,isMovable:l,enableMoveInBetween:c=!0,allowFiles:i=!0,canDrop:d,nbColumns:u=1})=>{const m=(p,M)=>{r?.(p,M)},f=(p,M)=>{o?.(p,M)};return e.jsx(is,{backend:cs,context:window,children:e.jsxs(fe,{container:!0,id:t,width:"100%",children:[e.jsx(fe,{size:12,children:e.jsx(Ue,{onDrop:f,enableMoveInBetween:c,renderComponent:a})}),s.map(p=>e.jsxs(fe,{size:Math.floor(12/u),children:[e.jsx(bn,{canDrop:d,allowFiles:i,isMovable:l,row:p,renderComponent:a,onDrop:m},n?.(p)),e.jsx(Ue,{allowFiles:i,renderComponent:a,enableMoveInBetween:c,previousRow:p,onDrop:f})]},p.id))]})})},ae="18px",J=({tooltip:t,children:s,backgroundColor:n})=>e.jsx(R,{title:t,children:e.jsx(Je,{sx:{width:24,height:24,bgcolor:n},children:s})}),Nn=({isHidden:t=!1,isHiddenTooltip:s="Hidden",isPinned:n=!1,isPinnedTooltip:r="Pinned",isPublished:o=!1,isPublishedTooltip:a="Published",isPublic:l=!1,isPublicTooltip:c="Public",isCollapsible:i=!1,isCollapsibleTooltip:d="Collapsible",showChatbox:u=!1,showChatboxTooltip:m="Chat",backgroundColor:f="#757575"})=>e.jsxs(Ws,{max:10,children:[t&&e.jsx(J,{backgroundColor:f,tooltip:s,children:e.jsx(et,{size:ae})}),n&&e.jsx(J,{backgroundColor:f,tooltip:r,children:e.jsx(Ms,{size:ae})}),o&&e.jsx(J,{backgroundColor:f,tooltip:a,children:e.jsx(xs,{primaryOpacity:1,primaryColor:"white",disableHover:!0})}),l&&e.jsx(J,{backgroundColor:f,tooltip:c,children:e.jsx(nn,{size:ae})}),i&&e.jsx(J,{backgroundColor:f,tooltip:d,children:e.jsx(cn,{size:ae})}),u&&e.jsx(J,{backgroundColor:f,tooltip:m,children:e.jsx(Ss,{size:ae})})]}),it={showChatbox:!1,isPinned:!1,isCollapsible:!1,isHidden:!1,isPublic:!1},Pn=({items:t=[]})=>t.reduce((s,n)=>{const{showChatbox:r,isPinned:o,isCollapsible:a}={...it,...n.settings},l=!!n.hidden,c=!!n.public;return{...s,[n.id]:{showChatbox:r,isPinned:o,isCollapsible:a,isHidden:l,isPublic:c}}},{}),wn=({itemsStatuses:t,data:s})=>{const{t:n}=h(g.Builder),r=t?.[s.id]||it,{showChatbox:o,isPinned:a,isHidden:l,isPublic:c,isCollapsible:i}=r;return e.jsx(Nn,{isPinned:a,isPinnedTooltip:n("STATUS_TOOLTIP_IS_PINNED"),isHidden:l,isHiddenTooltip:n("STATUS_TOOLTIP_IS_HIDDEN"),isPublic:c,isPublicTooltip:n("STATUS_TOOLTIP_IS_PUBLIC"),isPublishedTooltip:n("STATUS_TOOLTIP_IS_PUBLISHED"),isCollapsible:i,isCollapsibleTooltip:n("STATUS_TOOLTIP_IS_COLLAPSIBLE"),showChatbox:o,showChatboxTooltip:n("STATUS_TOOLTIP_SHOW_CHATBOX")})},An=({text:t})=>e.jsxs(Z,{direction:"row",gap:1,boxSizing:"border-box",border:"2px dashed grey",borderRadius:2,p:1,children:[e.jsx(hn,{})," ",t]}),Le="#ffc107",kn=({ariaLabel:t="favorite",className:s,color:n,handleBookmark:r,handleUnbookmark:o,isFavorite:a=!1,size:l="medium",sx:c,text:i,tooltip:d,type:u})=>{const{color:m}=Se(n),f=e.jsx(tn,{fill:a?Le:"none",fontSize:l}),p=d??(a?"Remove from Bookmarks":"Add to Bookmarks"),M=a?Le:m,j=a?o:r;switch(u){case T.ICON:return f;case T.MENU_ITEM:return e.jsx(Os,{iconColor:M,text:i??p,onClick:j,icon:f,className:s});case T.ICON_BUTTON:default:return e.jsx(R,{title:p,children:e.jsx("span",{children:e.jsx(N,{"aria-label":t,sx:{color:M,...c},onClick:j,children:f})})})}},Un=(t,s)=>s?.some(n=>n.item.id===t.id)||!1,ct=({item:t,size:s,type:n,onClick:r,className:o})=>{const{data:a}=Fe(It()),{t:l}=h(g.Builder),c=pe(),i=ie({...Et(),onSettled:()=>{c.invalidateQueries({queryKey:ve()})}}),d=ie({...Mt(),onSettled:()=>{c.invalidateQueries({queryKey:ve()})}}),u=Un(t,a),m=()=>{i.mutate({path:{itemId:t.id}}),r?.()},f=()=>{d.mutate({path:{itemId:t.id}}),r?.()},p=l(u?E.BOOKMARKED_ITEM_REMOVE_TEXT:E.BOOKMARKED_ITEM_ADD_TEXT);return e.jsx(kn,{className:o,isFavorite:u,ariaLabel:p,handleUnbookmark:f,handleBookmark:m,tooltip:p,type:n,size:s,text:p})},Ln=({data:t})=>{const{data:s}=He.useCurrentMember();return e.jsx(Z,{direction:"row",justifyContent:"center",alignItems:"center",children:s?.type===Ee.Individual&&e.jsx(ct,{size:"medium",item:t},"bookmark")})},Rn=({item:t,onClick:s})=>{const{mutate:n}=C.useCopyItems(),{t:r}=h(g.Builder),o=()=>{const a=se(t.path);n({ids:[t.id],to:a}),s?.()};return e.jsxs(D,{onClick:o,className:St,children:[e.jsx(P,{children:e.jsx(tt,{})}),r(E.ITEM_MENU_DUPLICATE_MENU_ITEM)]},"duplicate")},Fn=({item:t,dataUmamiContext:s})=>{const{t:n}=h(g.Builder),{t:r}=h(g.Messages),{mutate:o}=ie({...jt(),onSuccess:()=>{te.success(r("EXPORT_RAW_SUCCESS_MESSAGE"))},onError:()=>{te.error(r("EXPORT_RAW_ERROR_MESSAGE"))}});return e.jsxs(D,{id:Ct(t.id),onClick:()=>o({path:{itemId:t.id}}),"data-umami-event":"export-zip","data-umami-event-context":s,children:[e.jsx(P,{children:e.jsx(mn,{})}),n("ITEM_MENU_EXPORT_RAW_MENU_ITEM")]})},lt=({item:t})=>{const{t:s}=h(g.Builder),{openModal:n}=I.useContext(Ns),r=()=>{n?.(t.id)};return e.jsxs(D,{onClick:r,className:_t,children:[e.jsx(P,{children:e.jsx(on,{})}),s("ITEM_MENU_FLAG_MENU_ITEM")]})},Hn=({item:t,type:s=T.ICON_BUTTON,onClick:n})=>{const{t:r}=h(g.Builder),o=pe(),a=C.usePostItemVisibility(),l=C.useDeleteItemVisibility(),c=t.hidden,i=!c||c?.itemPath===t.path,d=async()=>{c?await l.mutateAsync({itemId:t.id,type:"hidden"}):await a.mutateAsync({itemId:t.id,type:"hidden"});const p=se(t.path);p&&o.invalidateQueries({queryKey:je.single(p).allChildren}),n?.()},u=r(c?E.HIDE_ITEM_SHOW_TEXT:E.HIDE_ITEM_HIDE_TEXT);let m=u;c&&!i&&(m=r(E.HIDE_ITEM_HIDDEN_PARENT_INFORMATION));const f=c?e.jsx(Ps,{}):e.jsx(et,{});switch(s){case T.MENU_ITEM:{const p=e.jsxs(D,{onClick:d,className:De,disabled:!i,"data-cy":yt(!!c),children:[e.jsx(P,{children:f}),u]},u);return i?p:e.jsx(R,{title:m,placement:"left",children:e.jsx("span",{children:p})})}case T.ICON_BUTTON:default:return e.jsx(R,{title:m,children:e.jsx("span",{children:e.jsx(N,{"aria-label":u,className:De,onClick:d,disabled:!i,children:f})})})}},Vn=({item:t,type:s,onClick:n})=>{const{t:r}=h(g.Builder),o=C.useEditItem(),[a,l]=I.useState(t?.settings?.isPinned),c=()=>{l(!a),o.mutate({id:t.id,name:t.name,settings:{isPinned:!a}}),n?.()},i=r(E.PIN_ITEM_PIN_TEXT),d=r(E.PIN_ITEM_UNPIN_TEXT);return e.jsx(vs,{color:"inherit",type:s,onClick:c,isPinned:a,pinText:i,unPinText:d,menuItemClassName:Ot})},Gn=({itemIds:t,color:s="default",id:n,type:r=T.ICON_BUTTON,onClick:o})=>{const{t:a}=h(g.Builder),{mutate:l}=C.useRecycleItems(),c=()=>{l(t),o?.()},i=a(E.RECYCLE_ITEM_BUTTON);switch(r){case T.MENU_ITEM:return e.jsxs(D,{onClick:c,className:Dt,children:[e.jsx(P,{children:e.jsx(Pe,{})}),i]},i);case T.ICON_BUTTON:default:return e.jsx(R,{title:i,children:e.jsx("span",{children:e.jsx(N,{id:n,color:s,className:vt,"aria-label":i,onClick:c,children:e.jsx(Pe,{})})})})}},$n=({color:t=Ve.Primary,iconClassName:s,id:n="",menuItemClassName:r,onClick:o,text:a="Copy",type:l=T.ICON_BUTTON})=>{const c=e.jsx(tt,{});switch(l){case T.MENU_ITEM:return e.jsxs(D,{"aria-label":a,onClick:o,className:r,children:[e.jsx(P,{children:c}),a]},a);default:return e.jsx(R,{title:a,children:e.jsx("span",{children:e.jsx(N,{id:n,color:t,className:s,"aria-label":a,onClick:o,children:c})})})}},qn=({color:t,id:s,type:n,onClick:r})=>{const{t:o}=h(g.Builder);return e.jsx($n,{type:n,id:s,text:o(E.COPY_BUTTON),color:t,iconClassName:Bt,menuItemClassName:bt,onClick:r})},zn=({items:t,open:s,onClose:n})=>{const{mutate:r}=C.useCopyItems(),{t:o}=h(g.Builder);if(!t.length)return null;const a=c=>{r({ids:t.map(i=>i.id),to:c}),n()},l=c=>o("COPY_BUTTON",{name:c,count:c?1:0});return s?e.jsx(ye,{title:o(E.COPY_ITEM_MODAL_TITLE,{count:t.length-1,name:t[0].name}),buttonText:l,onClose:n,open:s,onConfirm:a,items:t,isDisabled:(c,i)=>c.some(d=>i.path.includes(d.path))}):null},Xn=({itemId:t,onClick:s,type:n="icon"})=>{const{t:r}=h(g.Builder);return e.jsx(Bs,{type:n,title:r(E.EDIT_ITEM_BUTTON),id:Pt(t),ariaLabel:r(E.EDIT_ITEM_BUTTON),className:Nt,onClick:s,size:"medium"})},Wn=({item:t,onClose:s})=>{const{t:n}=h(g.Common),r=X({defaultValues:{name:t.name,description:t.description??""}}),{mutateAsync:o,isPending:a}=C.useEditItem(),{handleSubmit:l,formState:{isValid:c}}=r;async function i(d){try{await o({id:t.id,name:d.name,description:d.description,settings:{descriptionPlacement:d.descriptionPlacement}}),s()}catch(u){console.error(u)}}return e.jsx(O,{component:"form",onSubmit:l(i),children:e.jsxs(W,{...r,children:[e.jsxs(H,{children:[e.jsx(z,{required:!0}),e.jsx(_e,{})]}),e.jsxs(V,{children:[e.jsx(K,{id:ne,onClick:s}),e.jsx(le,{loading:a,id:q,type:"submit",disabled:!c,variant:"contained",children:n("SAVE.BUTTON_TEXT")})]})]})})};function Kn({item:t,onClose:s}){const{t:n}=h(g.Common),{t:r}=h(g.Builder),{mutateAsync:o}=C.useEditItem(),a=X({defaultValues:{name:t?.name,flavor:t?.extra?.document?.flavor??ws.None,content:t?.extra?.document?.content||"",isRaw:t?.extra?.document?.isRaw??!1}}),{setValue:l,handleSubmit:c,formState:{isValid:i,isSubmitted:d}}=a;async function u(m){try{await o({id:t.id,name:m.name,extra:As({content:m.content,flavor:m.flavor,isRaw:m.isRaw})}),s()}catch(f){console.error(f)}}return e.jsx(O,{component:"form",height:"100%",onSubmit:c(u),children:e.jsxs(W,{...a,children:[e.jsxs(H,{children:[e.jsx(z,{required:!0}),e.jsx(ls,{}),e.jsx(ds,{documentItemId:wt,onChange:m=>l("content",m),placeholder:r(E.TEXT_EDITOR_PLACEHOLDER)})]}),e.jsxs(V,{children:[e.jsx(K,{onClick:s}),e.jsx(ce,{id:q,type:"submit",disabled:d&&!i,children:n("SAVE.BUTTON_TEXT")})]})]})})}function Yn({item:t,onClose:s}){const n=pe(),{mutateAsync:r}=ie({...At(),onSettled:()=>{const u=Ge(se(t.path));n.invalidateQueries({queryKey:u});const m=je.single(t.id).content;n.invalidateQueries({queryKey:m})}}),{t:o}=h(g.Common),a=X({defaultValues:{name:t.name,allowReadersToWrite:t.extra.etherpad.readerPermission===ge.Write}}),{handleSubmit:l,formState:{isSubmitted:c,isValid:i}}=a,d=async u=>{await r({body:{name:u.name,readerPermission:u.allowReadersToWrite?ge.Write:ge.Read},path:{id:t.id}}),s()};return e.jsx(W,{...a,children:e.jsxs(Z,{direction:"column",component:"form",onSubmit:l(d),flex:1,children:[e.jsxs(H,{children:[e.jsx(z,{required:!0}),e.jsx(us,{})]}),e.jsxs(V,{children:[e.jsx(K,{onClick:s}),e.jsx(ce,{id:q,type:"submit",disabled:c&&!i,children:o("SAVE.BUTTON_TEXT")})]})]})})}function Qn({item:t,onClose:s}){const{t:n}=h(g.Builder),{t:r}=h(g.Common),o=X({defaultValues:{name:t.name,description:t?.description??void 0}}),{register:a,watch:l,handleSubmit:c,formState:{isValid:i,isSubmitted:d}}=o,u=l("altText"),m=l("descriptionPlacement"),{mimetype:f,altText:p}=t.extra.file,{mutateAsync:M}=C.useEditItem();function j(){if(u)return{file:{altText:u}}}async function y(S){try{await M({id:t.id,name:S.name,description:S.description,extra:u!==p?j():void 0,settings:m!==t.settings.descriptionPlacement?{descriptionPlacement:m}:void 0}),s()}catch(w){console.error(w)}}return e.jsx(W,{...o,children:e.jsxs(O,{component:"form",onSubmit:c(y),children:[e.jsxs(H,{sx:{display:"flex",flexDirection:"column"},children:[e.jsx(z,{required:!0,showClearButton:!!l("name")}),f&&Us.isImage(f)&&e.jsx(Ye,{variant:"standard",id:kt,label:n(E.EDIT_ITEM_IMAGE_ALT_TEXT_LABEL),slotProps:{inputLabel:{shrink:!0}},sx:{width:"50%",my:1},multiline:!0,...a("altText",{value:p})}),e.jsx(_e,{})]}),e.jsxs(V,{children:[e.jsx(K,{id:ne,onClick:s}),e.jsx(le,{variant:"contained",type:"submit",id:q,disabled:d&&!i,children:r("SAVE.BUTTON_TEXT")})]})]})})}function Zn({item:t,onClose:s}){const{t:n}=h(g.Common),r=X({defaultValues:{name:t.name,description:t.description??""},mode:"onChange"}),{handleSubmit:o,formState:{isValid:a}}=r,{mutateAsync:l}=C.useEditItem();async function c(i){try{await l({id:t.id,name:i.name,description:i.description}),s()}catch(d){console.error(d)}}return e.jsx(W,{...r,children:e.jsxs(O,{component:"form",onSubmit:o(c),children:[e.jsxs(H,{children:[e.jsx(z,{required:!0}),e.jsx(ms,{id:Ut})]}),e.jsxs(V,{children:[e.jsx(K,{id:ne,onClick:s}),e.jsx(ce,{id:q,type:"submit",disabled:!a,children:n("SAVE.BUTTON_TEXT")})]})]})})}function Jn({item:t,onClose:s}){const n=pe(),{t:r}=h(g.Common),o=X({defaultValues:{name:t.name,description:t.description??"",url:t.extra.embeddedLink.url,descriptionPlacement:t.settings.descriptionPlacement,linkType:ps(t.settings)}}),{handleSubmit:a,formState:{isValid:l,dirtyFields:c}}=o,{mutateAsync:i}=ie({...Lt(),onSettled:async u=>{if(await n.invalidateQueries({queryKey:je.single(t.id).content}),u){const m=Ge(se(u.path));n.invalidateQueries({queryKey:m})}}});async function d(u){try{await i({path:{id:t.id},body:{name:u.name,description:u.description,url:fs(u.url),...gs(u.linkType),settings:{descriptionPlacement:u.descriptionPlacement}}}),s()}catch(m){console.error(m)}}return e.jsx(W,{...o,children:e.jsxs(O,{component:"form",onSubmit:a(d),children:[e.jsx(H,{children:e.jsxs(Z,{gap:1,children:[e.jsx(ks,{}),e.jsx(z,{required:!0}),e.jsx(_e,{}),e.jsx(hs,{})]})}),e.jsxs(V,{children:[e.jsx(K,{id:ne,onClick:s}),e.jsx(le,{id:q,variant:"contained",type:"submit",disabled:!l||!Object.keys(c).length,children:r("SAVE.BUTTON_TEXT")})]})]})})}const er=({item:t,onClose:s})=>{const{t:n}=h(g.Common),r=X({defaultValues:{name:t.name,description:t.description??""}}),{mutateAsync:o,isPending:a}=C.useEditItem(),{handleSubmit:l,formState:{isValid:c}}=r;async function i(d){try{await o({id:t.id,name:d.name,description:d.description,settings:{descriptionPlacement:d.descriptionPlacement}}),s()}catch(u){console.error(u)}}return e.jsx(O,{component:"form",onSubmit:l(i),children:e.jsxs(W,{...r,children:[e.jsx(H,{children:e.jsx(z,{required:!0})}),e.jsxs(V,{children:[e.jsx(K,{id:ne,onClick:s}),e.jsx(le,{loading:a,id:q,type:"submit",disabled:!c,variant:"contained",children:n("SAVE.BUTTON_TEXT")})]})]})})};function tr({item:t,onClose:s}){const{t:n}=h(g.Common),r=X({defaultValues:{name:t.name}}),{handleSubmit:o,formState:{isValid:a}}=r,{mutateAsync:l}=C.useEditItem();async function c(i){try{await l({id:t.id,name:i.name}),s()}catch(d){console.error(d)}}return e.jsx(W,{...r,children:e.jsxs(O,{component:"form",onSubmit:o(c),children:[e.jsx(H,{children:e.jsx(z,{required:!0})}),e.jsxs(V,{children:[e.jsx(K,{id:ne,onClick:s}),e.jsx(le,{id:q,type:"submit",disabled:!a,children:n("SAVE.BUTTON_TEXT")})]})]})})}function sr({item:t,onClose:s,open:n}){const{t:r}=h(g.Builder),{t:o}=h(g.Messages),[a,l]=I.useState(t);I.useEffect(()=>{t.id!==a.id&&l(t)},[t,a.id]);const c=()=>t.type==="folder"?e.jsx(Zn,{onClose:s,item:t}):t.type==="file"?e.jsx(Qn,{onClose:s,item:t}):t.type==="shortcut"?e.jsx(tr,{onClose:s,item:t}):t.type==="document"?e.jsx(Kn,{onClose:s,item:t}):t.type==="etherpad"?e.jsx(Yn,{onClose:s,item:t}):t.type==="embeddedLink"?e.jsx(Jn,{onClose:s,item:t}):t.type==="app"||t.type==="h5p"?e.jsx(Wn,{onClose:s,item:t}):t.type==="page"?e.jsx(er,{onClose:s,item:t}):(te.error(o("UNEXPECTED_ERROR")),null);return e.jsxs(nt,{onClose:s,id:Rt,open:n,maxWidth:"md",fullWidth:!0,children:[e.jsx(rt,{id:t?.id,children:r(E.EDIT_ITEM_MODAL_TITLE)}),c()]})}const nr=({color:t=Ve.Primary,iconClassName:s,id:n,menuItemClassName:r,onClick:o,size:a,text:l="Move",type:c=T.ICON_BUTTON})=>{const{color:i}=Se(t),d=e.jsx(dn,{color:i});switch(c){case T.ICON:return d;case T.MENU_ITEM:return e.jsxs(D,{onClick:o,className:r,children:[e.jsx(P,{children:d}),e.jsx($e,{component:"span",color:t,children:l})]},l);case T.ICON_BUTTON:default:return e.jsx(R,{title:l,children:e.jsx("span",{children:e.jsx(N,{size:a,id:n,color:t,className:s,"aria-label":l,onClick:o,children:d})})})}},rr=({color:t,id:s,type:n=T.ICON_BUTTON,onClick:r})=>{const{t:o}=h(g.Builder);return e.jsx(nr,{color:t,type:n,id:s,onClick:r,text:o(E.MOVE_BUTTON),menuItemClassName:Ht,iconClassName:Ft})},or=({onClose:t,items:s,open:n})=>{const{t:r}=h(g.Builder),{mutate:o}=C.useMoveItems(),a=i=>{s&&o({items:s,to:i})},l=(i,d,u)=>{if(i?.length){const m=i.some(j=>d.path.includes(j.path)),p=i.map(j=>se(j.path)).includes(d.id);let M=!1;return M=d.id===u&&!se(i[0].path),m||p||M}return!1},c=i=>r("MOVE_BUTTON",{name:i,count:i?1:0});return n&&s?e.jsx(ye,{title:r(E.MOVE_ITEM_MODAL_TITLE),isDisabled:l,buttonText:c,onClose:t,open:n,onConfirm:a,items:s}):null},ar=({itemId:t,type:s=T.ICON_BUTTON})=>{const{t:n}=h(g.Builder),r=n(E.SETTINGS_TITLE),o=Gt(t);switch(s){case T.MENU_ITEM:return e.jsxs(Ls,{to:"/builder/items/$itemId/settings",params:{itemId:t},id:o,children:[e.jsx(P,{children:e.jsx(we,{})}),r]},r);case T.ICON_BUTTON:default:return e.jsx(R,{title:r,children:e.jsx(Vt,{to:"/builder/items/$itemId/settings",params:{itemId:t},children:e.jsx(N,{id:o,children:e.jsx(we,{})})})})}},ir=({onClick:t})=>{const{t:s}=h(g.Builder);return e.jsxs(D,{onClick:t,className:$t,children:[e.jsx(P,{children:e.jsx(Qt,{})}),s(E.ITEM_MENU_CREATE_SHORTCUT_MENU_ITEM)]})},cr=({item:t,onClose:s,open:n})=>{const{t:r}=h(g.Builder),{mutate:o}=C.usePostItem(),[a]=I.useState(t),l=i=>{const d=a.id,u={name:r(E.CREATE_SHORTCUT_DEFAULT_NAME,{name:a?.name}),extra:Ks(d),type:"shortcut",parentId:i};o(u),s()},c=i=>r("CREATE_SHORTCUT_BUTTON",{name:i,count:i?1:0});return a&&n?e.jsx(ye,{title:r(E.CREATE_SHORTCUT_MODAL_TITLE),buttonText:c,onClose:s,open:n,onConfirm:l,items:[a]}):null},lr=({id:t,link:s,color:n,ariaLabel:r="download",title:o="Download",placement:a="bottom",type:l=T.ICON_BUTTON})=>{const{color:c}=Se(n),i=e.jsx(Rs,{color:c});switch(l){case T.ICON:return i;case T.MENU_ITEM:return e.jsxs(D,{id:t,href:s,style:{font:"unset",textDecoration:"unset",color:"unset"},component:"a",download:!0,children:[e.jsx(P,{children:i}),e.jsx($e,{color:n,children:o})]},o);case T.ICON_BUTTON:default:return e.jsx(R,{title:o,placement:a,children:e.jsx("span",{id:t,children:e.jsx(N,{color:n,href:s,"aria-label":r,download:!0,children:i})})})}},dt=({item:t,type:s=T.ICON_BUTTON})=>{const{t:n}=h(g.Builder);return e.jsx(lr,{type:s,id:qt(t.id),link:`/api/items/${t.id}/download-file`,title:n(E.DOWNLOAD_ITEM_BUTTON),ariaLabel:n(E.DOWNLOAD_ITEM_BUTTON)})};function dr({item:t,account:s}){const{t:n}=h(g.Common,{keyPrefix:"ARIA"}),r=qe(t.id),[o,a]=I.useState(null),l=!!o,c=d=>{a(d.currentTarget)},i=()=>{a(null)};return!s&&t.type==="folder"?null:e.jsxs(e.Fragment,{children:[e.jsx(N,{"aria-controls":l?r:void 0,"aria-haspopup":"true","aria-expanded":l,onClick:c,"aria-label":n("MORE"),children:e.jsx(st,{})}),e.jsxs(at,{id:r,anchorEl:o,open:l,onClose:i,children:[t.type!=="folder"&&e.jsx(dt,{item:t,type:T.MENU_ITEM}),s?.id?e.jsx(lt,{item:t},"flag"):!1]})]})}const ur=({item:t})=>{const{t:s}=h(g.Common,{keyPrefix:"ARIA"}),{data:n}=Fe(zt()),[r,o]=I.useState(null),a=!!r,l=B=>{o(B.currentTarget)},c=()=>{o(null)},i=qe(t.id),{isOpen:d,openModal:u,closeModal:m}=ue(),{isOpen:f,openModal:p,closeModal:M}=ue(),{isOpen:j,openModal:y,closeModal:S}=ue(),{isOpen:w,openModal:Y,closeModal:A}=ue();if(!n||n.type!==Ee.Individual)return e.jsx(dr,{item:t,account:n});const b=t.permission&&Ae.gte(t.permission,"write"),k=t.permission&&Ae.gte(t.permission,"admin"),v=[b?e.jsx(Xn,{onClick:()=>{y(),c()},itemId:t.id,type:T.MENU_ITEM},"edit"):!1,e.jsx(qn,{type:T.MENU_ITEM,onClick:()=>{u(),c()}},"copy"),b?e.jsx(Rn,{item:t,onClick:()=>{c()}},"duplicate"):!1,k?e.jsx(rr,{color:"inherit",type:T.MENU_ITEM,onClick:()=>{p(),c()}},"move"):!1].filter(Boolean),U=[t.type==="folder"?e.jsx(Fn,{item:t,dataUmamiContext:"card"},"export-zip"):e.jsx(dt,{item:t,type:T.MENU_ITEM},"download")],Q=[...b?[e.jsx(Hn,{type:T.MENU_ITEM,item:t},"hide"),e.jsx(Vn,{type:T.MENU_ITEM,item:t},"pin")]:[],b&&t.type!=="folder"?e.jsx(Ds,{type:T.MENU_ITEM,item:t},"collapse"):!1].filter(Boolean),re=[...n.type===Ee.Individual?[e.jsx(ir,{onClick:()=>{Y(),c()}},"shortcut"),e.jsx(ct,{size:"medium",type:T.MENU_ITEM,item:t},"bookmark")]:[],b?e.jsx(ar,{itemId:t.id,type:T.MENU_ITEM},"settings"):!1].filter(Boolean),oe=[e.jsx(lt,{item:t},"flag"),k?e.jsx(Gn,{type:T.MENU_ITEM,itemIds:[t.id],onClick:c},"recycle"):!1].filter(Boolean),L=[v,Q,U,re,oe].filter(B=>B.length>0).flatMap((B,he)=>[e.jsx(Fs,{},`${B.toString()}${he}`),...B]).slice(1);return e.jsxs(e.Fragment,{children:[e.jsx(zn,{onClose:m,open:d,items:[t]}),e.jsx(or,{onClose:M,open:f,items:[t]}),e.jsx(cr,{onClose:A,item:t,open:w}),e.jsx(sr,{onClose:S,open:j,item:t}),e.jsx(N,{"aria-label":s("MORE"),"aria-controls":a?i:void 0,"aria-haspopup":"true","aria-expanded":a,onClick:l,"data-cy":Xt(t.id),children:e.jsx(st,{})}),e.jsx(at,{id:i,anchorEl:r,open:a,onClose:c,children:L.map(B=>B)})]})},mr=({itemId:t,type:s})=>{const{search:n}=js();return({children:r})=>{const o=s==="capsule"?"/player/$rootId/$itemId":"/builder/items/$itemId";return e.jsx(Cs,{to:o,params:{rootId:t,itemId:t},style:{textDecoration:"none",color:"unset"},search:n,children:r})}},pr=({item:t,isDragging:s,isOver:n,isMovable:r,showThumbnail:o,itemsStatuses:a,enableMoveInBetween:l,onClick:c,isSelected:i,onThumbnailClick:d})=>{const{mode:u}=ys(),{t:m}=h(g.Builder),f=u===Wt.List;if("files"in t)return e.jsx(An,{text:m("UPLOAD_BETWEEN_FILES")});const p=o?t.thumbnails?.medium:void 0,M=t.type==="shortcut"?t.extra.shortcut.target:t.id;return e.jsx(O,{px:1,onClick:()=>c?.(t.id),children:e.jsx(bs,{onThumbnailClick:d,dense:f,item:t,isOver:n,disabled:!r&&l,isDragging:s,isSelected:i,thumbnailUrl:p,CardLink:mr({itemId:M,type:_s(t)}),menu:e.jsx(ur,{item:t}),footer:e.jsxs(Z,{direction:"row",alignItems:"center",justifyContent:"space-between",children:[e.jsx(wn,{itemsStatuses:a,data:t}),e.jsx(Ln,{data:t})]})})})},{useItem:hr}=He,Eo=({id:t="",items:s=[],showThumbnail:n=!0,canMove:r=!0,enableMoveInBetween:o=!0,selectedIds:a=[],onCardClick:l,onMove:c})=>{const[i,d]=I.useState(!1),{t:u}=h(g.Common),{t:m}=h(g.Builder),{t:f}=h(g.Messages),{t:p}=h(g.Enums),{itemId:M}=Kt({strict:!1}),{data:j}=hr(M),{update:y,close:S}=Ts(),{mutateAsync:w}=C.useReorderItem(),[Y,A]=I.useState(),{mutate:b}=C.useMoveItems(),{mutateAsync:k}=C.useUploadFiles(),[v,U]=I.useState(),Q=()=>{d(!1)},re=Pn({items:s}),oe=(x,_)=>{if(_.type!=="folder"){te.error(m("MOVE_IN_NON_FOLDER_ERROR_MESSAGE",{type:p(_.type)}));return}if("files"in x){k({files:x.files,id:_.id,onUploadProgress:y}).then(()=>{S()}).catch(de=>{console.error(de),S(de)});return}if(x.id===_.id){console.error("cannot move target into itself");return}if(a.includes(x?.id)&&a.includes(_.id)){te.error(f("INVALID_MOVE_TARGET"));return}let G=[];a.includes(x?.id)?G=s.filter(({id:de})=>a.includes(de)):x&&(G=[x]),U({movedItems:G,to:_}),d(!0)},L=(x,_)=>{if("files"in x)k({files:x.files,id:j?.id,previousItemId:_?.id,onUploadProgress:y}).then(()=>{S()}).catch(G=>{S(G)});else if(!M||!j)console.error("cannot move in root"),te.error(m("ERROR_MESSAGE"));else{const{id:G}=x;A(G),w({id:G,previousItemId:_?.id,parentItemId:j.id}).finally(()=>{A(void 0)})}},B=()=>{v&&(b({items:v.movedItems,to:v.to.id}),U(void 0),Q(),c?.())},he=x=>"id"in x?a.includes(x.id):!1;return e.jsxs(e.Fragment,{children:[e.jsx(Bn,{id:t,isMovable:x=>Y!==x.id&&r,getRowId:x=>x.id,renderComponent:(x,_)=>e.jsx(pr,{item:x,isDragging:_.isDragging,isOver:_.isOver,isMovable:_.isMovable,enableMoveInBetween:o,itemsStatuses:re,showThumbnail:n,isSelected:he(x),onThumbnailClick:()=>{"id"in x&&l?.(x.id)}}),rows:s,onDropBetweenRow:L,enableMoveInBetween:o,onDropInRow:oe}),e.jsxs(nt,{onClose:Q,open:i,children:[v?e.jsxs(e.Fragment,{children:[e.jsx(rt,{children:e.jsx(Hs,{t:m,i18nKey:"MOVE_CONFIRM_TITLE",values:{count:v.movedItems.length,targetName:v.to.name},components:{1:e.jsx("strong",{})}})}),e.jsxs(H,{children:[m("MOVE_WARNING"),e.jsx("ul",{children:v.movedItems.map(({name:x,id:_})=>e.jsx("li",{children:x},_))})]})]}):e.jsx(Vs,{}),e.jsxs(V,{children:[e.jsx(ce,{variant:"text",onClick:Q,children:u("CANCEL.BUTTON_TEXT")}),e.jsx(ce,{onClick:B,children:m("MOVE_BUTTON")})]})]})]})},$={ItemName:"item.name",ItemType:"item.type",ItemCreator:"item.creator.name",ItemUpdatedAt:"item.updated_at"},ut={ItemName:"item.name",ItemType:"item.type",ItemCreator:"item.creator.name",ItemUpdatedAt:"item.updated_at",Order:"item.order"},gr=48,fr=8,Tr={PaperProps:{style:{maxHeight:gr*4.5+fr}}},Re="sort-by-filter-label",Mo=({sortBy:t,setSortBy:s,ordering:n,setOrdering:r,options:o})=>{const{t:a}=h(g.Builder),l=d=>{const{target:{value:u}}=d;[...Object.values($),...Object.values(ut)].includes(u)&&s(u)},c=a("SORT_BY_LABEL"),i=o.map(d=>[d,a(d)]).sort((d,u)=>d[1]>u[1]?1:-1);return e.jsx(ze,{size:"small",children:e.jsxs(Gs,{row:!0,children:[e.jsx(Xe,{id:Re,children:c}),e.jsx(We,{"data-testid":Yt,labelId:Re,label:c,value:t??$.ItemUpdatedAt,onChange:l,input:e.jsx(Ke,{label:c}),MenuProps:Tr,sx:{borderRadius:40},children:i.map(([d,u])=>e.jsx(D,{value:d,dense:!0,children:u},d))}),e.jsx(N,{onClick:()=>{r(n===ee.ASC?ee.DESC:ee.ASC)},children:n===ee.ASC?e.jsx(Qs,{}):e.jsx(Js,{})})]})})},So=({sortBy:t,ordering:s=ee.DESC})=>{const[n,r]=I.useState(t??$.ItemUpdatedAt),[o,a]=I.useState(s);return{sortBy:n,ordering:o,setSortBy:r,setOrdering:a,sortFn:(c,i)=>{const d=o===ee.ASC?1:-1;let u=0;switch(n){case $.ItemName:u=c.name.toLowerCase()>i.name.toLowerCase()?1:-1;break;case $.ItemCreator:c.creator?i.creator?u=c.creator?.name?.toLowerCase()>i.creator?.name?.toLowerCase()?1:-1:u=1:u=-1;break;case $.ItemType:u=c.type>i.type?1:-1;break;case $.ItemUpdatedAt:u=c.updatedAt>i.updatedAt?1:-1;break;case ut.Order:default:u=0}return u*d}}},jo=()=>{const{t}=h(g.Builder);return Object.values($).sort((s,n)=>{const r=t(s),o=t(n);return r.localeCompare(o)})};export{Ws as A,tn as B,zn as C,dt as D,Fn as E,lt as F,Hn as H,Eo as I,or as M,Vn as P,Gn as R,xo as S,jo as a,So as b,Mo as c,$ as d,rr as e,qn as f,To as g,ut as h,cr as i,ir as j,ct as k,sr as l,Xn as m,ar as n,Io as u};
