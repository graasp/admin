import{j as t,b as S,N as E,i as G,r as j,Z as f,S as h,T as N,iN as dt,iO as ut,h as K,f as Y,iP as It,iQ as Tt,iR as rt,iS as ht,iT as mt,cl as _t,iU as Q,iV as St,ie as Et,iW as pt,iX as xt,iY as Ct,iZ as Nt,i_ as jt,h4 as At,bC as Lt,i$ as V,fX as bt,C as gt,j0 as Bt,b0 as ft}from"./index-B_BHgQQY.js";import{a as w,P as m,b as Rt,c as Ot}from"./hooks-CjvQ3Yqk.js";import{L as Pt}from"./Loader-CLxvJV4h.js";import{c as B}from"./createSvgIcon-CR_wPvPv.js";import{S as q,b as P,P as H,L as Ut,u as J,T as Dt,E as W,d as Mt,C as yt,D as vt}from"./ThumbnailUploader-_WZiGa47.js";import{C as M}from"./ThumbnailCrop-iMyJZY_9.js";import{B as l}from"./langs-BKRoRoQy.js";import{F as tt}from"./FormControlLabel-CAZP-rGy.js";import{C as st}from"./Checkbox-CAPv11-J.js";import{E as Z}from"./Edit-CA3IAl03.js";import{T as Gt}from"./TextDisplay-DKy1jHXb.js";import{u as R}from"./useModalStatus-CF1QQN94.js";import{T as Yt}from"./TextEditor-NUJSy7Vm.js";import{a as Vt}from"./item-dXKRHMD1.js";import{T as O}from"./Tooltip-CY4gBTjx.js";import{I as y}from"./IconButton-t5WdCoTE.js";import{L as z}from"./langs-C5VEx8tQ.js";import{S as wt}from"./Skeleton-Bf_dEhrE.js";import{B as v}from"./Box-CXXiFbSb.js";import{B as g}from"./Button-4ORflwU5.js";import{D as Ht}from"./Delete-I6zc3GRu.js";import{A as U}from"./Alert-af15MLjr.js";import{I as kt}from"./Info-wKahjT4T.js";import{C as Ft}from"./CircularProgress-_2M16NEZ.js";import{u as at}from"./OutletContext-BGjGZ_Uz.js";import{T as Wt}from"./TextField-CCzZwtaB.js";import{D as zt,a as $t}from"./DialogContent-BLGJ1kXP.js";import{D as Kt}from"./DialogTitle-BL-ZXwRQ.js";import{D as Zt}from"./DialogActions-B4c7iV3e.js";import{L as Xt}from"./link-nLlUeqkm.js";import{u as Qt}from"./index-CVpgN-ou.js";import"./itemType-D9KQEJss.js";import"./itemLogin-BRGmCLqv.js";import"./index-CAxbq8YW.js";import"./Autocomplete-DLfOXbvp.js";import"./useSlot-D6B6Ly0P.js";import"./ButtonBase-ylRkSt5R.js";import"./isFocusVisible-B8k4qzLc.js";import"./useControlled-BMwunPLn.js";import"./usePreviousProps-WLnL_Kyw.js";import"./Modal-DNRlalor.js";import"./createChainedFunction-BO_9K8Jh.js";import"./utils-NE7yIt1Q.js";import"./Paper-e3G0y0Go.js";import"./Trans-1gex2Erj.js";import"./RadioGroup-B8axso0y.js";import"./SwitchBase-BpBcR0Ys.js";import"./FormControl-DkBPBeJg.js";import"./isMuiElement-BdxtYttK.js";import"./Select-CwIsZUkW.js";import"./MenuItem-i4R53H8t.js";import"./listItemTextClasses-DkicRqsl.js";import"./dividerClasses-Bk0V9OT7.js";import"./permissionLevel-BOsSKewz.js";import"./uploadWithProgress-X8OCjAji.js";import"./CropModal-D3OxYzrA.js";import"./DialogContentText-X3gecpnz.js";import"./trash-2-D4QstvMZ.js";import"./Popover-CgVTRYfe.js";import"./Grow-BvZTf0bq.js";import"./isEqual-D6G76aij.js";import"./normalizeDates-Bl5IZJGD.js";import"./toDate-BXq0HhWu.js";import"./Menu-C45l_y2r.js";import"./List-Cf8ruq7c.js";const qt=B(t.jsx("path",{d:"M13 7h-2v4H7v2h4v4h2v-4h4v-2h-4zm-1-5C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8"})),Jt=B(t.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m-2 15-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8z"})),et=B(t.jsx("path",{d:"M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96M10 17l-3.5-3.5 1.41-1.41L10 14.17 15.18 9l1.41 1.41z"})),nt=B(t.jsx("path",{d:"M19.35 10.04C18.67 6.59 15.64 4 12 4c-1.48 0-2.85.43-4.01 1.17l1.46 1.46C10.21 6.23 11.08 6 12 6c3.04 0 5.5 2.46 5.5 5.5v.5H19c1.66 0 3 1.34 3 3 0 1.13-.64 2.11-1.56 2.62l1.45 1.45C23.16 18.16 24 16.68 24 15c0-2.64-2.05-4.78-4.65-4.96M3 5.27l2.75 2.74C2.56 8.15 0 10.77 0 14c0 3.31 2.69 6 6 6h11.73l2 2L21 20.73 4.27 4zM7.73 10l8 8H6c-2.21 0-4-1.79-4-4s1.79-4 4-4z"})),ts=B(t.jsx("path",{d:"M21.5 14.98c-.02 0-.03 0-.05.01C21.2 13.3 19.76 12 18 12c-1.4 0-2.6.83-3.16 2.02C13.26 14.1 12 15.4 12 17c0 1.66 1.34 3 3 3l6.5-.02c1.38 0 2.5-1.12 2.5-2.5s-1.12-2.5-2.5-2.5M10 4.26v2.09C7.67 7.18 6 9.39 6 12c0 1.77.78 3.34 2 4.44V14h2v6H4v-2h2.73C5.06 16.54 4 14.4 4 12c0-3.73 2.55-6.85 6-7.74M20 6h-2.73c1.43 1.26 2.41 3.01 2.66 5h-2.02c-.23-1.36-.93-2.55-1.91-3.44V10h-2V4h6z"})),$=B(t.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m1 15h-2v-2h2zm0-4h-2V7h2z"})),ss=B(t.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m1 17h-2v-2h2zm2.07-7.75-.9.92C13.45 12.9 13 13.5 13 15h-2v-.5c0-1.1.45-2.1 1.17-2.83l1.24-1.26c.37-.36.59-.86.59-1.41 0-1.1-.9-2-2-2s-2 .9-2 2H8c0-2.21 1.79-4 4-4s4 1.79 4 4c0 .88-.36 1.68-.93 2.25"})),es=B(t.jsx("path",{d:"M17 12c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5m1.65 7.35L16.5 17.2V14h1v2.79l1.85 1.85zM18 3h-3.18C14.4 1.84 13.3 1 12 1s-2.4.84-2.82 2H6c-1.1 0-2 .9-2 2v15c0 1.1.9 2 2 2h6.11c-.59-.57-1.07-1.25-1.42-2H6V5h2v3h8V5h2v5.08c.71.1 1.38.31 2 .6V5c0-1.1-.9-2-2-2m-6 2c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1"})),k=B(t.jsx("path",{d:"M1 21h22L12 2zm12-3h-2v-2h2zm0-4h-2v-4h2z"})),ns="#BBB",is=({syncStatus:s})=>{const{t:n}=S(E.Builder),e=G(),i=()=>{switch(s){case q.SYNCHRONIZING:return{color:"default",icon:t.jsx(ts,{htmlColor:ns}),text:n("ITEM_STATUS_SYNCHRONIZING")};case q.ERROR:return{color:"error",icon:t.jsx($,{color:"error"}),text:n("ITEM_STATUS_ERROR")};default:return{color:"success",icon:t.jsx(Jt,{htmlColor:e.palette.success.light}),text:n("ITEM_STATUS_SYNCHRONIZED")}}},{icon:o,text:a,color:c}=i();return t.jsx(M,{size:"small",variant:"outlined",icon:o,label:a,color:c})},os="PublishCoEditors",rs=({item:s,notifyCoEditors:n,onNotificationChanged:e})=>{const{t:i}=S(E.Builder),{computeStatusFor:o}=P(),{data:a}=w(s.id),{settings:c,id:d,name:r}=s,[u,T]=j.useState(c.displayCoEditors??!1),I=[m.PublishedChildren,m.ItemTypeNotAllowed],{mutate:_,isPending:C,isSuccess:x,isError:A}=f.useEditItem({enableNotifications:!1});j.useEffect(()=>o(os,{isLoading:C,isSuccess:x,isError:A}),[C,x,A,o]),j.useEffect(()=>{c.displayCoEditors&&T(c.displayCoEditors)},[c]);const b=p=>{T(p),_({id:d,name:r,settings:{displayCoEditors:p}})},L=p=>e(p);return!a||I.includes(a)?null:t.jsxs(h,{children:[t.jsx(N,{variant:"h4",children:i(l.ITEM_SETTINGS_CO_EDITORS_TITLE)}),t.jsx(tt,{"data-cy":dt,onChange:(p,D)=>b(D),control:t.jsx(st,{size:"small",checked:u}),label:i(l.ITEM_SETTINGS_CO_EDITORS_INFORMATIONS),sx:{maxWidth:"max-content"}}),t.jsx(tt,{"data-cy":ut,onChange:(p,D)=>L(D),control:t.jsx(st,{size:"small",checked:n}),label:i(l.LIBRARY_SETTINGS_PUBLISH_NOTIFICATIONS_LABEL),sx:{maxWidth:"max-content"}})]})},{useDebounce:as}=K,cs=1e3,ls=({id:s,initialValue:n,onUpdate:e})=>{const{t:i}=S(E.Builder),[o,a]=j.useState(!1),[c,d]=j.useState(n),r=as(c,cs);j.useEffect(()=>{o&&e(r)},[r]);const u=I=>Vt(I).trim().length===0,T=I=>{d(u(I)?"":I),a(!0)};return t.jsx(Yt,{id:s,value:c,onChange:I=>T(I),placeholderText:i("DESCRIPTION.PLACEHOLDER")})},ds="PublishItemDescription",us=({item:s})=>{const{description:n,id:e}=s,{t:i}=S(E.Builder),{computeStatusFor:o}=P(),{isOpen:a,openModal:c,closeModal:d}=R(),{color:r}=Y("warning"),{mutate:u,isSuccess:T,isPending:I,isError:_}=f.useEditItem({enableNotifications:!1});j.useEffect(()=>o(ds,{isError:_,isLoading:I,isSuccess:T}),[o,_,I,T]);const C=p=>{u({id:e,description:p??""})},x=t.jsx(H,{isOpen:a,title:i("DESCRIPTION.LABEL"),modalContent:t.jsx(ls,{initialValue:n??void 0,onUpdate:C,showActions:!1}),handleOnClose:d}),A=n?null:t.jsx(O,{title:i(l.LIBRARY_SETTINGS_ITEM_DESCRIPTION_MISSING_WARNING),children:t.jsx(k,{htmlColor:r})}),b=t.jsxs(h,{direction:"row",spacing:1,alignItems:"center",children:[t.jsx(N,{variant:"h5",children:i("DESCRIPTION.LABEL")}),t.jsx(y,{onClick:c,children:t.jsx(Z,{})})]}),L=t.jsxs(h,{direction:"row",alignItems:"center",spacing:1,pb:1,children:[t.jsx(Gt,{content:n??i(l.LIBRARY_SETTINGS_ITEM_NO_DESCRIPTION)}),A]});return t.jsxs(t.Fragment,{children:[x,t.jsxs(h,{children:[b,L]})]})},it="100%",ct=({children:s,isLoading:n,width:e=it,maxWidth:i=it,height:o})=>n?t.jsx(wt,{variant:"rounded",sx:{width:e,height:o,maxWidth:i},children:s}):s,Is={cursor:"pointer",":hover":{boxShadow:"0 1px 3px rgba(0, 0, 0, 0.2)",transform:"scale(1.01)"},":active":{transform:"scale(1.0)"}},ot={radius:"8px",border:"1px #ddd solid"},lt=({dataTestId:s,title:n,titleIcon:e,titleActionBtn:i,content:o,emptyDataMessage:a,attributeDescription:c,isLoading:d=!1,onEmptyClick:r})=>{const u=G(),{color:T}=Y("warning"),I=o===void 0||Array.isArray(o)&&o.length===0,_=!I,C=()=>t.jsxs(h,{direction:"column",alignItems:"center",justifyContent:"center",flexGrow:1,"data-cy":ht(s),children:[t.jsx(qt,{htmlColor:u.palette.primary.main,sx:{fontSize:40}}),t.jsx(N,{variant:"body1",color:u.palette.text.secondary,textAlign:"center",children:a})]}),x=()=>{I&&r?.()},A=b=>b.stopPropagation();return t.jsx(ct,{isLoading:d,children:t.jsxs(h,{"data-cy":It(s),border:ot.border,borderRadius:ot.radius,padding:2,onClick:x,sx:I?Is:{},flexBasis:"100%",spacing:1,children:[t.jsxs(h,{direction:"row",alignItems:"center",justifyContent:"space-between",children:[t.jsxs(h,{direction:"row",alignItems:"center",children:[t.jsxs(h,{direction:"row",alignItems:"center",children:[t.jsx(N,{variant:"body1",fontWeight:"bold",pb:1,pt:1,children:n}),t.jsx(v,{onClick:A,children:e})]}),_&&t.jsx(v,{"data-cy":Tt(s),children:i})]}),I&&t.jsx(O,{title:c,children:t.jsx(k,{htmlColor:T,"data-cy":rt(s)})})]}),I?C():o]})})};function Ts({item:s}){const{t:n}=S(E.Builder),{isOpen:e,openModal:i,closeModal:o}=R(),a=n(l.ITEM_LANGUAGE_CONTAINER_TITLE),c=u=>`license-${u}`,d=[t.jsx(g,{onClick:o,children:n(l.CLOSE_BUTTON)},c(l.CANCEL_BUTTON))];let r=z[_t];return s.lang in z&&(r=z[s.lang]),t.jsxs(t.Fragment,{children:[t.jsx(H,{modalContent:t.jsxs(h,{gap:1,children:[t.jsx(N,{variant:"h6",children:a}),t.jsx(N,{variant:"body1",children:n(l.ITEM_LANGUAGE_DESCRIPTION)}),t.jsx(N,{variant:"caption",children:n(l.ITEM_LANGUAGE_DESCRIPTION_LIMITATION)}),t.jsx(Ut,{item:s})]}),isOpen:e,handleOnClose:o,dialogActions:d}),t.jsx(lt,{dataTestId:mt,title:a,content:t.jsx(M,{label:r,onClick:i})})]})}const hs="PublishLicense",ms=({item:s})=>{const n=G(),{t:e}=S(E.Builder),{computeStatusFor:i}=P(),{isOpen:o,openModal:a,closeModal:c}=R(),{creativeCommons:d}=J({item:s,iconSize:30}),r=J({item:s,enableNotifications:!1});j.useEffect(()=>i(hs,{isLoading:r.isLoading,isError:r.isError,isSuccess:r.isSuccess}),[i,r.isError,r.isLoading,r.isSuccess]);const{settings:u}=s,T=u?.ccLicenseAdaption?t.jsx(v,{"data-cy":Q,children:d}):void 0,I=e("ITEM_LICENSE_CONTAINER_TITLE"),_=e("ITEM_LICENSE_CONTAINER_MISSING_WARNING"),C=e("ITEM_LICENSE_CONTAINER_EMPTY_BUTTON"),x=()=>{r.handleSubmit(),c()},A=D=>`license-${D}`,b=[t.jsx(g,{onClick:c,children:e("CANCEL_BUTTON")},A("CANCEL_BUTTON")),t.jsx(g,{"data-cy":St,onClick:x,variant:"contained",children:e("CONFIRM_BUTTON")},A("CONFIRM_BUTTON"))],L=()=>t.jsxs(h,{spacing:2,children:[T&&t.jsx(U,{severity:"warning",children:e("ITEM_SETTINGS_CC_LICENSE_MODAL_CONTENT")}),t.jsxs(h,{mx:3,spacing:2,children:[r.licenseForm,t.jsx(v,{display:"flex",justifyContent:"center",children:r.creativeCommons})]})]}),p=t.jsx(O,{title:e("ITEM_SETTINGS_CC_LICENSE_MORE_INFORMATIONS"),arrow:!0,children:t.jsx(y,{"aria-label":"info",href:Et,target:"_blank",children:t.jsx(ss,{})})});return t.jsxs(t.Fragment,{children:[t.jsx(H,{modalContent:L(),isOpen:o,handleOnClose:c,dialogActions:b}),t.jsx(lt,{dataTestId:Q,title:I,titleIcon:p,titleActionBtn:t.jsxs(h,{direction:"row",children:[t.jsx(O,{title:_,children:t.jsx(y,{"data-cy":pt,onClick:a,children:t.jsx(Z,{htmlColor:n.palette.primary.main})})}),t.jsx(y,{"data-cy":xt,onClick:r.removeLicense,children:t.jsx(Ht,{htmlColor:n.palette.error.main})})]}),attributeDescription:_,emptyDataMessage:C,content:T,onEmptyClick:a})]})};function _s(s){return s.charAt(0).toUpperCase()+s.slice(1)}const Ss=({item:s})=>{const{t:n}=S(E.Builder),{t:e}=S(E.Enums),{data:i,isLoading:o}=w(s.id),a=_s(e(s.type));if(o)return t.jsx(M,{icon:t.jsx(Ft,{size:15}),label:n(l.LIBRARY_SETTINGS_PUBLICATION_STATUS_LOADING),variant:"outlined",color:"info"});if(!i)return t.jsx(M,{icon:t.jsx($,{}),label:n(l.LIBRARY_SETTINGS_PUBLICATION_STATUS_UNKOWN),variant:"outlined",color:"error"});const c=T=>{switch(T){case m.Unpublished:return{icon:t.jsx(nt,{}),label:n(l.LIBRARY_SETTINGS_PUBLICATION_STATUS_UNPUBLISHED),color:void 0};case m.Published:case m.Outdated:return{icon:t.jsx(et,{}),label:n(l.LIBRARY_SETTINGS_PUBLICATION_STATUS_PUBLISHED),color:"success"};case m.PublishedChildren:return{icon:t.jsx(et,{}),label:n(l.LIBRARY_SETTINGS_PUBLICATION_STATUS_PUBLISHED_CHILDREN),color:"success"};case m.ReadyToPublish:return{icon:t.jsx(nt,{}),label:n(l.LIBRARY_SETTINGS_PUBLICATION_STATUS_READY_TO_PUBLISH),color:void 0};case m.Pending:return{icon:t.jsx(es,{}),label:n(l.LIBRARY_SETTINGS_PUBLICATION_STATUS_PENDING),color:"info"};case m.Invalid:return{icon:t.jsx($,{}),label:n(l.LIBRARY_SETTINGS_PUBLICATION_STATUS_INVALID),color:"error"};case m.ItemTypeNotAllowed:default:return{icon:t.jsx(kt,{}),label:n(l.LIBRARY_SETTINGS_PUBLICATION_STATUS_TYPE_NOT_ALLOWED,{itemType:a}),color:"info"}}},{icon:d,label:r,color:u}=c(i);return t.jsx(M,{"data-cy":Ct(i),icon:d,label:r,color:u,variant:"outlined"})},Es=150,ps="PublicationThumbnail",xs=({item:s,thumbnailSize:n=Es,fullWidth:e=!1})=>{const{color:i}=Y("warning"),{t:o}=S(E.Builder),[a,c]=j.useState(!1),d="my-categories",r=T=>{switch(T){case W.ON_UPLOADING:case W.ON_HAS_THUMBNAIL:c(!1);break;case W.ON_NO_THUMBNAIL:c(!0);break}},u=a?t.jsx(O,{title:o(l.LIBRARY_SETTINGS_THUMBNAIL_MISSING_WARNING),children:t.jsx(k,{htmlColor:i,"data-cy":rt(d)})}):void 0;return t.jsx(Dt,{item:s,thumbnailSize:n,fullWidth:e,syncStatusKey:ps,topCornerElement:u,onChange:r})},{useDebounce:Cs}=K,Ns=1e3,js=({initialValue:s,placeholder:n,label:e,mt:i,required:o=!1,emptyValueError:a,onUpdate:c})=>{const{t:d}=S(E.Builder),[r,u]=j.useState(!1),[T,I]=j.useState(s),[_,C]=j.useState(),x=Cs(T,Ns),A=p=>o?!!p:!0;j.useEffect(()=>{r&&A(x)&&c(x)},[x]);const b=p=>{A(p)?C(void 0):C(a??d(l.DEBOUNCED_TEXTFIELD_EMPTY_ERROR))},L=p=>{I(p),u(!0),b(p)};return t.jsx(Wt,{id:Nt,fullWidth:!0,multiline:!0,label:e,placeholder:n,value:T,onChange:p=>L(p.target.value),sx:{bgcolor:"transparent",mt:i},error:!!_,helperText:_})},As="PublishItemTitle",Ls=({item:s})=>{const{name:n,id:e}=s,{t:i}=S(E.Builder),{computeStatusFor:o}=P(),{isOpen:a,openModal:c,closeModal:d}=R(),{mutate:r,isSuccess:u,isPending:T,isError:I}=f.useEditItem({enableNotifications:!1});j.useEffect(()=>o(As,{isError:I,isLoading:T,isSuccess:u}),[o,I,T,u]);const _=x=>{x&&r({id:e,name:x})},C=t.jsx(H,{isOpen:a,title:i(l.CREATE_NEW_ITEM_NAME_LABEL),modalContent:t.jsx(js,{initialValue:n??void 0,onUpdate:_,label:i(l.CREATE_NEW_ITEM_NAME_LABEL),mt:1,required:!0,emptyValueError:i(l.LIBRARY_SETTINGS_ITEM_NAME_CANNOT_BE_EMPTY)}),handleOnClose:d});return t.jsxs(t.Fragment,{children:[C,t.jsxs(h,{direction:"row",spacing:1,alignItems:"center",justifyContent:"space-between",children:[t.jsx(N,{variant:"h2",fontWeight:700,children:s.name}),t.jsx(y,{onClick:c,children:t.jsx(Z,{})})]})]})},bs="CustomizedTags",gs=({item:s,onChange:n})=>{const{t:e}=S(E.Builder),{tags:i,isLoading:o,isSuccess:a,isError:c}=Mt({itemId:s.id}),{computeStatusFor:d}=P(),r=!i?.length,{color:u}=Y("warning");return j.useEffect(()=>d(bs,{isLoading:o,isSuccess:a,isError:c}),[o,a,c,n,d]),t.jsxs(t.Fragment,{children:[t.jsx(yt,{item:s}),r&&t.jsx(O,{title:e(l.ITEM_TAGS_MISSING_WARNING),children:t.jsx(k,{htmlColor:u})})]})},X=({item:s,isOpen:n,shouldUpdateVisibility:e=!0,onClose:i,onValidate:o})=>{const{t:a}=S(E.Builder),{updateVisibility:c}=Rt(s),d=async()=>{e&&await c(At.ITEM_PUBLIC.name),o?.()};return t.jsxs(zt,{open:n,children:[t.jsx(Kt,{children:t.jsx(N,{variant:"h3",children:a(l.PUBLIC_VISIBILITY_MODAL_TITLE)})}),t.jsx($t,{children:t.jsx(N,{children:a(l.PUBLIC_VISIBILITY_MODAL_DESCRIPTION)})}),t.jsxs(Zt,{children:[t.jsx(g,{onClick:i,variant:"outlined",children:a(l.CANCEL_BUTTON)}),t.jsx(g,{"data-cy":jt,onClick:d,variant:"contained",children:a(l.PUBLIC_VISIBILITY_MODAL_VALIDATE_BUTTON)})]})]})},Bs=({description:s})=>typeof s=="string"?t.jsx(N,{children:s}):s,F=({isLoading:s,description:n,children:e=[]})=>t.jsx(ct,{isLoading:s,children:t.jsxs(h,{spacing:4,children:[t.jsx(Bs,{description:n}),t.jsx(h,{justifyContent:"center",direction:"row",spacing:2,children:e})]})}),{usePostItemValidation:fs}=f,Rs=({item:s,isLoading:n})=>{const{t:e}=S(E.Builder),{id:i,public:o}=s,{isOpen:a,openModal:c,closeModal:d}=R(),{mutate:r,isPending:u}=fs(),T=()=>{o?r({itemId:i}):c()},I=()=>{r({itemId:i}),d()},_=t.jsx(U,{severity:"error",children:e(l.LIBRARY_SETTINGS_VALIDATION_STATUS_FAILURE,{contact:Lt})});return t.jsxs(t.Fragment,{children:[!o&&t.jsx(X,{item:s,isOpen:a,shouldUpdateVisibility:!1,onClose:d,onValidate:I}),t.jsx(F,{isLoading:n,description:_,children:t.jsx(g,{variant:"contained",onClick:T,loading:u,"data-cy":V(m.Invalid),children:e(l.LIBRARY_SETTINGS_RETRY_BUTTON)})})]})},Os=()=>{const{t:s}=S(E.Builder),{t:n}=S(E.Enums),e=Ot.getAllowedTypes(),i=e.map(o=>n(o)).join(", ");return t.jsx(U,{severity:"info",children:s(l.LIBRARY_SETTINGS_TYPE_NOT_ALLOWED_STATUS,{allowedItemTypes:i,count:e.length})})},Ps=()=>{const{t:s}=S(E.Builder);return t.jsx(U,{severity:"info",children:s(l.LIBRARY_SETTINGS_VALIDATION_STATUS_PENDING_AUTOMATIC)})},{useUnpublishItem:Us}=f,Ds=({item:s,isLoading:n})=>{const{t:e}=S(E.Builder),{id:i}=s,{mutate:o,isPending:a}=Us(),c=()=>o({id:i}),d=()=>bt.getInstance().getItemLink(gt.Library,i),r=t.jsx(U,{children:e("LIBRARY_SETTINGS_PUBLISHED_STATUS")});return t.jsxs(F,{isLoading:n,description:r,children:[t.jsx(g,{variant:"outlined",loading:a,onClick:c,"data-cy":V(m.Published),children:e("LIBRARY_SETTINGS_UNPUBLISH_BUTTON")}),t.jsx(g,{variant:"contained",startIcon:t.jsx(Xt,{}),href:d(),target:"_blank",children:e("LIBRARY_SETTINGS_VIEW_LIBRARY_BUTTON")})]})},Ms=()=>{const{t:s}=S(E.Builder);return t.jsx(U,{severity:"success",children:s("LIBRARY_SETTINGS_CHILD_PUBLISHED_STATUS")})},{usePublishItem:ys}=f,vs=({item:s,isLoading:n,notifyCoEditors:e})=>{const{t:i}=S(E.Builder),{id:o,public:a}=s,{isOpen:c,openModal:d,closeModal:r}=R(),{mutate:u,isPending:T}=ys(),I=()=>u({id:o,notification:e}),_=()=>{a?I():d()},C=()=>{I(),r()},x=t.jsx(N,{children:i(l.LIBRARY_SETTINGS_VALIDATION_STATUS_READY_TO_PUBLISH)});return t.jsxs(t.Fragment,{children:[!a&&t.jsx(X,{item:s,isOpen:c,onClose:r,onValidate:C}),t.jsx(F,{isLoading:n,description:x,children:t.jsx(g,{variant:"contained",loading:T,onClick:_,"data-cy":V(m.ReadyToPublish),children:i(l.LIBRARY_SETTINGS_PUBLISH_BUTTON)})})]})},{usePostItemValidation:Gs}=f,Ys=({item:s,isLoading:n})=>{const{t:e}=S(E.Builder),{id:i,public:o}=s,{isOpen:a,openModal:c,closeModal:d}=R(),{mutate:r,isPending:u}=Gs(),T=()=>{o?r({itemId:i}):c()},I=()=>{r({itemId:i}),d()},_=e(l.LIBRARY_SETTINGS_VALIDATION_INFORMATIONS);return t.jsxs(t.Fragment,{children:[!o&&t.jsx(X,{item:s,isOpen:a,shouldUpdateVisibility:!1,onClose:d,onValidate:I}),t.jsx(F,{isLoading:n,description:_,children:t.jsx(g,{variant:"contained",onClick:T,loading:u,"data-cy":V(m.Unpublished),children:e(l.LIBRARY_SETTINGS_VALIDATION_VALIDATE_BUTTON)})})]})},Vs=({item:s,notifyCoEditors:n})=>{const{data:e,isLoading:i}=w(s.id);switch(e){case m.Unpublished:return t.jsx(Ys,{item:s,isLoading:i});case m.Pending:return t.jsx(Ps,{});case m.ReadyToPublish:return t.jsx(vs,{item:s,isLoading:i,notifyCoEditors:n});case m.Published:case m.Outdated:return t.jsx(Ds,{item:s,isLoading:i});case m.PublishedChildren:return t.jsx(Ms,{});case m.Invalid:return t.jsx(Rs,{item:s,isLoading:i});case m.ItemTypeNotAllowed:return t.jsx(Os,{});default:console.error(`The status "${e}" is unknown.`);return}},ws=()=>{const{t:s}=S(E.Builder),n=G(),{item:e,canAdmin:i}=at(),{isPending:o}=K.useCurrentMember(),a=Qt(n.breakpoints.down("md")),{status:c}=P(),{data:d,isLoading:r}=w(e?.id??""),[u,T]=j.useState(!1);if(!e)return null;if(o||r)return t.jsx(h,{alignItems:"center",justifyContent:"center",width:"100%",height:"70vh",children:t.jsx(Pt,{})});if(!i)return t.jsx(N,{mt:3,variant:"h3",textAlign:"center",children:s(l.LIBRARY_SETTINGS_UNAUTHORIZED)});const I=()=>t.jsxs(h,{spacing:2,children:[t.jsxs(h,{direction:{xs:"column",sm:"row"},spacing:2,children:[t.jsx(xs,{item:e,fullWidth:a}),t.jsx(h,{justifyContent:"space-between",children:t.jsx(Ls,{item:e})})]}),t.jsx(us,{item:e})]}),_=()=>t.jsxs(h,{spacing:1,children:[t.jsx(gs,{item:e}),t.jsxs(h,{spacing:1,direction:{xs:"column",sm:"row"},children:[t.jsx(Ts,{item:e}),t.jsx(ms,{item:e})]})]}),C=({order:L})=>t.jsxs(h,{spacing:1,flexBasis:"100%",order:L,children:[t.jsxs(h,{direction:"row",alignItems:"center",spacing:1,children:[t.jsx(N,{variant:"h3",fontWeight:650,children:s(l.LIBRARY_SETTINGS_PREVIEW_TITLE)}),t.jsx(is,{syncStatus:c})]}),t.jsx(N,{children:s(l.LIBRARY_SETTINGS_PREVIEW_DESCRIPTION)}),I(),_()]}),x=({order:L}={})=>t.jsxs(h,{spacing:1,order:L,children:[t.jsxs(h,{direction:"row",spacing:1,alignItems:"center",children:[t.jsx(N,{variant:"h3",fontWeight:650,children:s(l.LIBRARY_SETTINGS_TITLE)}),t.jsx(Ss,{item:e})]}),t.jsx(N,{children:s(l.LIBRARY_SETTINGS_INFORMATION)})]}),A=({order:L}={})=>t.jsxs(h,{spacing:3,flexBasis:"100%",order:L,children:[t.jsx(rs,{item:e,notifyCoEditors:u,onNotificationChanged:p=>T(p)}),t.jsx(Vs,{item:e,notifyCoEditors:u})]}),b=()=>t.jsxs(h,{flexBasis:"100%",spacing:2,children:[x(),A()]});return!d||d===m.ItemTypeNotAllowed?b():t.jsxs(h,{direction:{xs:"column",md:"row"},gap:6,children:[C({order:{xs:1,md:0}}),a?t.jsxs(t.Fragment,{children:[x({order:{xs:0}}),A({order:{xs:2}})]}):b()]})},Hs=()=>t.jsx(vt,{children:t.jsx(ws,{})});function tn(){const{itemId:s}=Bt.useParams(),{canAdmin:n}=at();return n?t.jsx(Hs,{}):t.jsx(ft,{to:"/builder/items/$itemId",params:{itemId:s},replace:!0})}export{tn as component};
