import{r as n,j as b,S as x,bE as ee,bF as _,dq as te,aY as re,f6 as ne}from"./index-B_BHgQQY.js";import{I as oe}from"./IconButton-t5WdCoTE.js";import{X as le}from"./x-B2OknFaz.js";const J=n.createContext({selectedIds:[],toggleSelection:()=>{},addToSelection:()=>{},clearSelection:()=>{}}),ge=({children:r})=>{const[e,l]=n.useState(new Set),c=n.useRef(null),u=n.useCallback(()=>{l(new Set)},[]),s=n.useCallback(t=>{e.has(t)?e.delete(t):e.add(t),l(new Set(e))},[e]),d=n.useCallback(t=>{e.has(t)||(e.add(t),l(new Set(e)))},[e]),o=n.useMemo(()=>({selectedIds:[...e.values()],toggleSelection:s,clearSelection:u,elementsContainerRef:c,addToSelection:d}),[e,s,u,d,c]);return b.jsx(J.Provider,{value:o,children:b.jsx(x,{height:"100%",ref:c,children:r})})},K=()=>n.useContext(J);var F,Y;function ue(){if(Y)return F;Y=1;var r={boxFlex:!0,boxFlexGroup:!0,columnCount:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,strokeDashoffset:!0,strokeOpacity:!0,strokeWidth:!0};function e(s,d){return s+d.charAt(0).toUpperCase()+d.substring(1)}var l=["Webkit","ms","Moz","O"];Object.keys(r).forEach(function(s){l.forEach(function(d){r[e(d,s)]=r[s]})});var c={background:{backgroundImage:!0,backgroundPosition:!0,backgroundRepeat:!0,backgroundColor:!0},border:{borderWidth:!0,borderStyle:!0,borderColor:!0},borderBottom:{borderBottomWidth:!0,borderBottomStyle:!0,borderBottomColor:!0},borderLeft:{borderLeftWidth:!0,borderLeftStyle:!0,borderLeftColor:!0},borderRight:{borderRightWidth:!0,borderRightStyle:!0,borderRightColor:!0},borderTop:{borderTopWidth:!0,borderTopStyle:!0,borderTopColor:!0},font:{fontStyle:!0,fontVariant:!0,fontWeight:!0,fontSize:!0,lineHeight:!0,fontFamily:!0}},u={isUnitlessNumber:r,shorthandPropertyExpansions:c};return F=u,F}var W,G;function se(){if(G)return W;G=1;var r=/^ms-/,e=/([A-Z])/g;function l(u){return u.replace(e,"-$1").toLowerCase()}function c(u){return l(u).replace(r,"-ms-")}return W=c,W}var H,X;function ce(){if(X)return H;X=1;var r=ue().isUnitlessNumber,e=se(),l=Array.isArray,c=Object.keys,u=/^(normal|none|(\b(url\([^)]*\)|chapter_counter|attr\([^)]*\)|(no-)?(open|close)-quote|inherit)((\b\s*)|$|\s+))+)$/;function s(o,t){return!r[o]&&typeof t=="number"?t=""+t+"px":o==="content"&&!u.test(t)&&(t="'"+t.replace(/'/g,"\\'")+"'"),e(o)+": "+t+";  "}function d(o){var t="";if(!o||c(o).length===0)return t;for(var h=c(o),m=0,f=h.length;m<f;m++){var S=h[m],y=o[S];if(l(y))for(var v=0,O=y.length;v<O;v++)t+=s(S,y[v]);else t+=s(S,y)}return t}return H=d,H}var ie=ce();const Z=ee(ie);function E(){return E=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var l=arguments[e];for(var c in l)Object.prototype.hasOwnProperty.call(l,c)&&(r[c]=l[c])}return r},E.apply(this,arguments)}const ae=["style"],de=n.forwardRef((r,e)=>{let{style:l={}}=r,c=(function(o,t){if(o==null)return{};var h,m,f={},S=Object.keys(o);for(m=0;m<S.length;m++)t.indexOf(h=S[m])>=0||(f[h]=o[h]);return f})(r,ae);const u=n.useRef(null),s=n.useRef(null),[,d]=n.useState(0);return n.useImperativeHandle(e,()=>({getBoundingClientRect:()=>{var o;return(o=u.current)==null?void 0:o.getBoundingClientRect()},getParentBoundingClientRect:()=>{var o,t;return u==null||(o=u.current)==null||(t=o.parentElement)==null?void 0:t.getBoundingClientRect()},drawSelectionBox:o=>{requestAnimationFrame(()=>{if(s.current){const t=E({border:"1px solid #4C85D8",background:"rgba(155, 193, 239, 0.4)",position:"absolute",pointerEvents:"none"},l,{top:o.top,left:o.left,width:o.width,height:o.height});s.current.style.cssText=Z(t)}})},clearSelectionBox:()=>{requestAnimationFrame(()=>{s.current&&(s.current.style.cssText=Z({top:0,left:0,width:0,height:0}))})}})),n.useEffect(()=>{d(o=>o+1)},[]),_.createElement("div",{ref:u},u.current?te.createPortal(_.createElement("div",E({ref:s},c)),u.current):null)}),fe=(r,e)=>r.left<=e.left+e.width&&r.left+r.width>=e.left&&r.top<=e.top+e.height&&r.top+r.height>=e.top;function me(r){return(e=>e.width*e.height)(r)>10}function Se(r){const{onSelectionChange:e,onSelectionEnd:l,onSelectionStart:c,isEnabled:u=!0,selectionProps:s={},eventsElement:d,shouldStartSelecting:o,isValidSelectionStart:t}=r||{},h=n.useRef(null),{cancelCurrentSelection:m}=(function({containerRef:f,onSelectionChange:S,onSelectionStart:y,onSelectionEnd:v,isEnabled:O=!0,eventsElement:g,shouldStartSelecting:U,isValidSelectionStart:Q=me}){const R=n.useRef(null),w=n.useRef(null),T=n.useRef(!1),k=n.useRef(S),L=n.useRef(y),q=n.useRef(v),D=n.useRef(void 0),V=n.useRef(O);k.current=n.useCallback(i=>{D.current=S?requestAnimationFrame(()=>{S(i)}):void 0},[S]),L.current=y,q.current=v,V.current=O;const P=n.useCallback(()=>{var i;R.current=null,w.current=null,T.current=!1,(i=f.current)==null||i.clearSelectionBox(),typeof D.current=="number"&&cancelAnimationFrame(D.current)},[f]),I=n.useCallback(i=>{var a;const p=(a=f.current)==null?void 0:a.getParentBoundingClientRect();return{x:i.clientX-(typeof p?.left=="number"?p.left:0),y:i.clientY-(typeof p?.top=="number"?p.top:0)}},[f]),$=n.useCallback((i,a)=>{if(R.current&&w.current){if(!a)return;const B=(({startPoint:A,endPoint:N})=>({left:Math.min(A.x,N.x),top:Math.min(A.y,N.y),width:Math.abs(A.x-N.x),height:Math.abs(A.y-N.y)}))({startPoint:R.current,endPoint:w.current}),z=E({},B,{top:B.top+(a?.top||0),left:B.left+(a?.left||0)});var p;Q(B)?(T.current||(L!=null&&L.current&&L.current(i),T.current=!0),(p=f.current)==null||p.drawSelectionBox(B),k.current==null||k.current(z)):T.current&&(k.current==null||k.current(z))}else P()},[P,f]),C=n.useCallback(i=>{var a;if(!R.current)return;const p=(a=f.current)==null?void 0:a.getParentBoundingClientRect();w.current=I(i),$(i,p)},[$,I,f]),j=n.useCallback(i=>{var a;i.button===0&&(w.current&&(q.current==null||q.current(i)),P(),document.body.style.removeProperty("user-select"),document.body.style.removeProperty("-webkit-user-select"),(g||document.body).removeEventListener("mousemove",C),(a=window)==null||a.removeEventListener("mouseup",j))},[g,P,C]),M=n.useCallback(i=>{if(i.button===0&&V.current){var a;if(typeof U=="function"&&!U(i.target))return;document.body.style.userSelect="none",document.body.style.webkitUserSelect="none",R.current=I(i),(g||document.body).addEventListener("mousemove",C),(a=window)==null||a.addEventListener("mouseup",j)}},[g,I,C,j]);return n.useEffect(()=>((g||document.body).addEventListener("mousedown",M),()=>{(g||document.body).removeEventListener("mousedown",M),(g||document.body).removeEventListener("mousemove",C),window.removeEventListener("mouseup",j)}),[g,M,C,j]),{cancelCurrentSelection:P}})({containerRef:h,onSelectionEnd:l,onSelectionStart:c,onSelectionChange:e,isEnabled:u,eventsElement:d,shouldStartSelecting:o,isValidSelectionStart:t});return{cancelCurrentSelection:m,DragSelection:n.useCallback(()=>_.createElement(de,E({ref:h},s)),[])}}const ye=({gap:r,id:e,children:l})=>b.jsx(x,{mx:-100,px:100,height:"100%",id:e,gap:r,children:l}),ve=({elementClass:r=ne,containerId:e})=>{const{addToSelection:l,clearSelection:c}=K(),[u,s]=n.useState(null),{DragSelection:d}=Se({eventsElement:document.getElementById("root"),onSelectionChange:t=>{const h={...t,top:t.top+window.scrollY,left:t.left+window.scrollX};s(h),Array.from(document.getElementsByClassName(r)).forEach(m=>{const f=m.getBoundingClientRect();if(fe(h,f)&&m.parentNode instanceof HTMLElement){const S=m.parentNode.dataset.id;S&&l(S)}})},shouldStartSelecting:t=>t instanceof HTMLElement||t instanceof SVGElement?t.closest(`#${e}`)?!t?.closest(`.${r}`):!1:!0,onSelectionStart:()=>{c(),s(null)},onSelectionEnd:()=>{s(null)},selectionProps:{style:{display:"none"}},isEnabled:!0});return b.jsxs(b.Fragment,{children:[b.jsx("div",{style:{position:"fixed",border:`2px dashed ${re}`,borderRadius:4,backgroundColor:"lightblue",opacity:.5,zIndex:999,display:u?.top?"block":"none",...u}}),b.jsx(d,{})]})},Ce=({children:r})=>{const{selectedIds:e,clearSelection:l}=K();return b.jsxs(x,{spacing:1,direction:"row",justifyContent:"space-between",alignItems:"center",sx:{backgroundColor:"#efefef"},borderRadius:2,children:[b.jsxs(x,{direction:"row",alignItems:"center",children:[b.jsx(oe,{onClick:l,children:b.jsx(le,{})}),b.jsxs(x,{children:[e.length," selected"]})]}),b.jsx(x,{direction:"row",children:r})]})};export{ye as D,Ce as S,ge as a,ve as b,K as u};
