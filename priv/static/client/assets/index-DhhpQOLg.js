import{s as y,b as c,N as d,r as u,j as t,S as h,T as G,i as E,c3 as D,gS as Y,gT as H,gU as W,dP as F}from"./index-B_BHgQQY.js";import{D as f}from"./DataProvider-Da4vEUf0.js";import{A as I}from"./Alert-af15MLjr.js";import{I as q}from"./Info-wKahjT4T.js";import{T as U}from"./Tooltip-CY4gBTjx.js";import{e as _}from"./endOfDay-DrDjbh-O.js";import{r as M,X as A,Y as g,s as z,t as S,B as j,z as x,v as k,w as O,T as R,x as N,y as X}from"./ChartContainer-G3xkrtl8.js";import{C as $,G as v,c as w}from"./constants-Wv2H5Vy8.js";import{B as b}from"./Box-CXXiFbSb.js";import{S as B}from"./Skeleton-Bf_dEhrE.js";import{G as T}from"./Grid-DwBZvdO2.js";import{S as V}from"./SectionTitle-Dl2-V3Hl.js";import{E as Q}from"./errorboundary-DQhN36hL.js";import"./useSlot-D6B6Ly0P.js";import"./ButtonBase-ylRkSt5R.js";import"./isFocusVisible-B8k4qzLc.js";import"./createSvgIcon-CR_wPvPv.js";import"./IconButton-t5WdCoTE.js";import"./CircularProgress-_2M16NEZ.js";import"./Paper-e3G0y0Go.js";import"./useControlled-BMwunPLn.js";import"./Modal-DNRlalor.js";import"./createChainedFunction-BO_9K8Jh.js";import"./utils-NE7yIt1Q.js";import"./Grow-BvZTf0bq.js";import"./toDate-BXq0HhWu.js";import"./format-C1rEO6Ru.js";import"./normalizeDates-Bl5IZJGD.js";import"./differenceInCalendarDays-DiZ3ZI30.js";import"./getTimezoneOffsetInMilliseconds-CkMJBntH.js";import"./langs-C5VEx8tQ.js";import"./index-Chjiymov.js";import"./Button-4ORflwU5.js";import"./Popover-CgVTRYfe.js";import"./isEqual-D6G76aij.js";import"./index-Du_uXtnU.js";import"./triggers-BfmRfMmW.js";import"./isMuiElement-BdxtYttK.js";var J=M({chartName:"LineChart",GraphicalChild:S,axisComponents:[{axisType:"xAxis",AxisComp:A},{axisType:"yAxis",AxisComp:g}],formatAxisMap:z}),K=M({chartName:"BarChart",GraphicalChild:j,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:A},{axisType:"yAxis",AxisComp:g}],formatAxisMap:z});const Z=y(I)(({theme:e})=>({display:"flex",alignItems:"center",margin:e.spacing(2),marginTop:e.spacing(1)})),tt=y("div")(({theme:e})=>({root:{flexGrow:1,paddingLeft:e.spacing(2),paddingRight:e.spacing(2),marginBottom:e.spacing(2)}})),et=y(U)(({theme:e})=>({tooltip:{fontSize:"11px",backgroundColor:"rgba(0, 0, 0, 0.7)",marginRight:e.spacing(1)}})),st=()=>{const{t:e}=c(d.Analytics),{requestedSampleSize:s}=u.useContext(f);return t.jsx(tt,{children:t.jsx(Z,{severity:"info",action:t.jsx(et,{title:e("SAMPLE_ACTIONS_MESSAGE",{requestedSampleSize:s}),placement:"left",children:t.jsx(q,{fontSize:"small"})}),children:e("SAMPLE_ACTIONS_CHARTS_MESSAGE",{requestedSampleSize:s})})})},C=({title:e})=>t.jsx(h,{spacing:1,pt:2,direction:"row",alignItems:"center",justifyContent:"center",children:t.jsx(G,{variant:"h6",align:"center",children:e})}),rt=y("div")({display:"flex",justifyContent:"center",alignItems:"center",height:`${$}px`}),at=y("div")(()=>({display:"flex",justifyContent:"center",marginTop:1}));function L({chartTitle:e,selectFilter:s,isError:n=!1}){const{t:o}=c(d.Analytics),r=o("NO_ACTIONS_TO_SHOW_FOR_THIS_USER");return t.jsxs(h,{direction:"column",children:[t.jsx(C,{title:e}),s&&t.jsx(at,{children:s}),t.jsx(rt,{children:n?t.jsx(I,{severity:"error",children:o("CHART_DATA_UNAVAILABLE")}):t.jsx(G,{children:r})})]})}const it=({itemId:e})=>{const{t:s}=c(d.Analytics),{dateRange:n}=u.useContext(f),{direction:o}=E(),{data:r,isPending:p,isError:m}=D(Y({path:{id:e},query:{startDate:x(n.startDate),endDate:x(_(n.endDate))}})),l=s("ACTIONS_BY_DAY_TITLE");return r?t.jsxs(b,{width:"100%",children:[t.jsx(C,{title:l}),t.jsx(k,{children:t.jsxs(J,{data:Object.values(r).toSorted((a,i)=>a.date>i.date?1:-1),children:[t.jsx(O,{strokeDasharray:"2"}),t.jsx(A,{dataKey:"date",tick:{fontSize:14}}),t.jsx(g,{tick:{fontSize:14},orientation:o==="rtl"?"right":"left"}),t.jsx(R,{}),t.jsx(N,{}),t.jsx(S,{dataKey:"count.all",name:s("All"),stroke:v,activeDot:{r:6},strokeWidth:3}),t.jsx(S,{dataKey:"personal.all",name:s("Me"),stroke:w,activeDot:{r:6},strokeWidth:3})]})})]}):p?t.jsx(B,{width:"100%",height:500}):t.jsx(L,{chartTitle:l,isError:m})},nt=({itemId:e})=>{const{t:s}=c(d.Analytics),{dateRange:n}=u.useContext(f),{direction:o}=E(),{data:r,isPending:p,isError:m}=D(H({path:{id:e},query:{startDate:x(n.startDate),endDate:x(_(n.endDate))}})),l=s("ACTIONS_BY_TIME_OF_DAY");if(r){for(let a=0;a<24;a+=1)r[a]||(r[a]={hour:a,count:{all:0},personal:{all:0}});return t.jsxs(t.Fragment,{children:[t.jsx(C,{title:l}),t.jsx(k,{children:t.jsxs(K,{data:Object.values(r).toSorted((a,i)=>Number.parseInt(a.hour)>Number.parseInt(i.hour)?1:-1),children:[t.jsx(O,{strokeDasharray:"2"}),t.jsx(A,{dataKey:"hour",tick:{fontSize:14},tickFormatter:a=>`${a}h`}),t.jsx(g,{tick:{fontSize:14},orientation:o==="rtl"?"right":"left"}),t.jsx(R,{}),t.jsx(N,{}),t.jsx(j,{dataKey:"count.all",name:s("All"),fill:v}),t.jsx(j,{dataKey:"personal.all",name:s("Me"),fill:w})]})})]})}return p?t.jsx(B,{width:"100%",height:500}):t.jsx(L,{chartTitle:l,isError:m})},ot=({itemId:e})=>{const{t:s}=c(d.Analytics),{dateRange:n}=u.useContext(f),{direction:o}=E(),{data:r,isPending:p,isError:m}=D(W({path:{id:e},query:{startDate:x(n.startDate),endDate:x(_(n.endDate))}})),l=s("ACTIONS_BY_WEEKDAY");if(r){for(let i=0;i<=6;i+=1)r[i]??={weekday:i,count:{all:0},personal:{all:0}};const a={0:"Sun.",1:"Mon.",2:"Tue.",3:"Wed.",4:"Thu.",5:"Fri.",6:"Sat."};return t.jsxs(b,{width:"100%",minWidth:400,children:[t.jsx(C,{title:l}),t.jsx(k,{children:t.jsxs(K,{data:Object.values(r).toSorted((i,P)=>i.weekday>P.weekday?1:-1),children:[t.jsx(O,{strokeDasharray:"2"}),t.jsx(A,{interval:0,dataKey:"weekday",tick:{fontSize:14},tickFormatter:i=>a[i]}),t.jsx(g,{tick:{fontSize:14},orientation:o==="rtl"?"right":"left"}),t.jsx(R,{}),t.jsx(N,{}),t.jsx(j,{dataKey:"count.all",name:s("All"),fill:v}),t.jsx(j,{dataKey:"personal.all",name:s("Me"),fill:w})]})})]})}return p?t.jsx(B,{width:"100%",height:500}):t.jsx(L,{chartTitle:l,isError:m})},lt=({itemId:e})=>t.jsxs(t.Fragment,{children:[t.jsx(h,{direction:{sm:"column",md:"row"},alignItems:"center",width:"100%",children:t.jsx(it,{itemId:e})}),t.jsxs(T,{container:!0,children:[t.jsx(T,{size:{xs:12,lg:6},children:t.jsx(nt,{itemId:e})}),t.jsx(T,{size:{xs:12,lg:6},children:t.jsx(ot,{itemId:e})})]})]}),ct=()=>{const{dateRange:e,setDateRange:s}=u.useContext(f);return t.jsx(h,{direction:"row",justifyContent:"space-between",alignItems:"center",spacing:{xs:2,sm:3,lg:4},p:2,width:"100%",children:t.jsx(h,{direction:"row",children:t.jsx(X,{dateRange:e,setDateRange:s})})})};function dt(){const{t:e}=c(d.Messages);return t.jsx(I,{severity:"error",children:e("UNEXPECTED_ERROR")})}function $t(){const{t:e}=c(d.Analytics),{itemId:s}=F({strict:!1});return s?t.jsxs(Q,{fallback:dt,children:[t.jsx(ct,{}),t.jsx(st,{}),t.jsx(V,{title:e("GENERAL_ANALYTICS_TITLE")}),t.jsx(lt,{itemId:s})]}):null}export{$t as component};
