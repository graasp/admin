import{x as X,w as Y,r as x,z as q,T as y,j as t,s as T,E as J,eA as R,i as F,aW as Q,S as M,eB as Z,b as ee,N as te,eC as re}from"./index-B_BHgQQY.js";import{I as U}from"./itemType-D9KQEJss.js";import{A as D}from"./Alert-af15MLjr.js";import{A as se}from"./AlertTitle-CZRu3C6o.js";import{T as ae}from"./Thumbnail-CeEWDJof.js";import{I as oe}from"./ItemIcon-aRVTEBTL.js";import{B}from"./Box-CXXiFbSb.js";import{C as ne}from"./Card-Rs4ggG5A.js";import{C as ie}from"./CardActionArea-BWT8PuAd.js";import{u as C}from"./useSlot-D6B6Ly0P.js";import{E as le}from"./external-link-QQvANG3_.js";import{w as de,i as ce,a as me,b as pe}from"./withResizing-Bmu3xIGc.js";import{a as ue}from"./linkItem-VVVu8jA7.js";import{L as he}from"./Link-DLKBSA2n.js";import{b as xe}from"./index.esm-D6N0kWEX.js";import{L as fe}from"./item-dXKRHMD1.js";import{T as ge}from"./TextField-CCzZwtaB.js";import{I as ye}from"./IconButton-t5WdCoTE.js";import{X as Ce}from"./x-B2OknFaz.js";function Te(e){return Y("MuiCardHeader",e)}const H=X("MuiCardHeader",["root","avatar","action","content","title","subheader"]),je=e=>{const{classes:r}=e;return J({root:["root"],avatar:["avatar"],action:["action"],content:["content"],title:["title"],subheader:["subheader"]},Te,r)},be=T("div",{name:"MuiCardHeader",slot:"Root",overridesResolver:(e,r)=>[{[`& .${H.title}`]:r.title},{[`& .${H.subheader}`]:r.subheader},r.root]})({display:"flex",alignItems:"center",padding:16}),Ie=T("div",{name:"MuiCardHeader",slot:"Avatar"})({display:"flex",flex:"0 0 auto",marginRight:16}),Le=T("div",{name:"MuiCardHeader",slot:"Action"})({flex:"0 0 auto",alignSelf:"flex-start",marginTop:-4,marginRight:-8,marginBottom:-4}),Se=T("div",{name:"MuiCardHeader",slot:"Content"})({flex:"1 1 auto",[`.${R.root}:where(& .${H.title})`]:{display:"block"},[`.${R.root}:where(& .${H.subheader})`]:{display:"block"}}),ve=x.forwardRef(function(r,a){const s=q({props:r,name:"MuiCardHeader"}),{action:o,avatar:i,component:c="div",disableTypography:l=!1,subheader:m,subheaderTypographyProps:j,title:f,titleTypographyProps:b,slots:I={},slotProps:E={},...S}=s,d={...s,component:c,disableTypography:l},p=je(d),u={slots:I,slotProps:{title:b,subheader:j,...E}};let h=f;const[v,w]=C("title",{className:p.title,elementType:y,externalForwardedProps:u,ownerState:d,additionalProps:{variant:i?"body2":"h5",component:"span"}});h!=null&&h.type!==y&&!l&&(h=t.jsx(v,{...w,children:h}));let n=m;const[_,P]=C("subheader",{className:p.subheader,elementType:y,externalForwardedProps:u,ownerState:d,additionalProps:{variant:i?"body2":"body1",color:"textSecondary",component:"span"}});n!=null&&n.type!==y&&!l&&(n=t.jsx(_,{...P,children:n}));const[g,N]=C("root",{ref:a,className:p.root,elementType:be,externalForwardedProps:{...u,...S,component:c},ownerState:d}),[A,G]=C("avatar",{className:p.avatar,elementType:Ie,externalForwardedProps:u,ownerState:d}),[$,K]=C("content",{className:p.content,elementType:Se,externalForwardedProps:u,ownerState:d}),[z,V]=C("action",{className:p.action,elementType:Le,externalForwardedProps:u,ownerState:d});return t.jsxs(g,{...N,children:[i&&t.jsx(A,{...G,children:i}),t.jsxs($,{...K,children:[h,n]}),o&&t.jsx(z,{...V,children:o})]})});var k;(function(e){e.None="none",e.Info="info",e.Success="success",e.Warning="warning",e.Error="error"})(k||(k={}));const et=e=>e[U.DOCUMENT],tt=e=>({[U.DOCUMENT]:e}),W=({title:e,isAlert:r=!1})=>e?r?t.jsx(se,{sx:{fontWeight:700,fontSize:"1.1rem"},children:e}):t.jsx(y,{variant:"h5",children:e}):null,rt=({content:e,title:r,flavor:a=k.None})=>a===k.None?t.jsxs(t.Fragment,{children:[t.jsx(W,{title:r}),e]}):t.jsxs(D,{severity:a,sx:{alignItems:"flex-start","& .MuiAlert-message":{flexGrow:1}},children:[t.jsx(W,{title:r,isAlert:!0}),e]}),L="76px",we=({thumbnail:e,alt:r,itemType:a="folder"})=>{const s=F();return e?t.jsx(ae,{maxWidth:L,maxHeight:L,url:e,alt:r}):t.jsx(B,{display:"flex",alignItems:"center",justifyContent:"center",bgcolor:Q.main,width:L,height:"100%",flexShrink:0,minHeight:L,minWidth:0,children:t.jsx(oe,{type:a,alt:r,color:s.palette.primary.main})})},Ae="fancy-link-card",He=({id:e,title:r,thumbnail:a,description:s,url:o="",urlText:i,onClick:c,isExternal:l=!0})=>{const m=F();return t.jsx(ne,{id:e,sx:{width:"max-content",maxWidth:"100%",height:L},"data-testid":Ae,children:t.jsx(ie,{href:o,sx:{height:"100%"},onClick:c,children:t.jsxs(M,{direction:"row",alignItems:"center",height:"100%",minWidth:0,children:[t.jsx(we,{thumbnail:a,alt:"Link thumbnail",itemType:"embeddedLink"}),t.jsx(ve,{sx:{minWidth:"0px","& .MuiCardHeader-content":{minWidth:"0px"}},title:t.jsxs(M,{children:[t.jsxs(M,{direction:"row",gap:1,alignItems:"center",children:[t.jsx(y,{variant:"h5",noWrap:!0,fontWeight:"bold",color:"primary",children:r}),l&&t.jsx(le,{style:{flexShrink:0},size:"1rem",color:m.palette.primary.main})]}),l&&t.jsxs(y,{color:"text.secondary",noWrap:!0,variant:"caption",children:["(",i??o,")"]})]}),subheader:s,subheaderTypographyProps:{overflow:"hidden",height:s?"1lh":"unset",textOverflow:"ellipsis",minWidth:0,sx:{"& p":{margin:0,marginBlocStart:0}}}})]})})})},O="70vh",ke=T("iframe")(({isResizable:e,height:r})=>({...ce,maxHeight:e?void 0:O,height:e?"100%":r}));function Ee(e){try{return new URL(e).origin!==window.location.origin}catch{return!1}}const _e=T("div")(({theme:e})=>({width:"100%",backgroundColor:"#eee",borderRadius:e.spacing(2),display:"flex",alignItems:"center",justifyContent:"center",flexGrow:1,height:"100%",maxHeight:O,overflow:"auto"})),Ne=({id:e,url:r,title:a,height:s,isResizable:o,isLoading:i,onDoneLoading:c,itemId:l,memberId:m,loadingMessage:j})=>{const f=x.useMemo(()=>t.jsx(ke,{sx:{display:i?"unset":"block"},height:s,width:"100%",id:e,isResizable:o,onLoad:c,src:r,title:a,loading:"lazy"}),[i,s,e,o,r,a]),b=x.useMemo(()=>de({height:s,component:f,memberId:m,itemId:l}),[s,m,l,f]);return t.jsxs(t.Fragment,{children:[t.jsx(_e,{sx:{display:i?"flex":"none"},children:j}),o?t.jsx(b,{}):f]})},Me=({id:e,item:r,thumbnail:a,memberId:s,showCaption:o=!0,showIframe:i=!1,showButton:c=Z,loadingMessage:l="Link is Loading...",height:m=400,errorMessage:j="The link is malformed.",isResizable:f=!1,showCollapse:b=!1,onClick:I,onCollapse:E})=>{const[S,d]=x.useState(!0),[p]=x.useState(m),{id:u,name:h}=r,v=ue(r.extra),w=v?.html,n=v?.url;x.useEffect(()=>{S||d(!0)},[n]);const _=me({item:r});let g=(()=>{if(!n)return t.jsx(D,{severity:"error",children:j});const N=Ee(n),A=t.jsx(He,{id:e,thumbnail:a??r.extra.embeddedLink.icons?.[0],title:r.name,url:n,description:r.extra.embeddedLink.description??"",onClick:I,isExternal:N});return i?w?t.jsx(B,{display:"contents",id:e,onClick:I,dangerouslySetInnerHTML:{__html:w}}):t.jsxs(x.Fragment,{children:[t.jsx(Ne,{id:e,url:n,isResizable:f,height:p,title:h,isLoading:S,onDoneLoading:()=>d(!1),itemId:u,memberId:s,loadingMessage:l}),c&&A]}):c?A:t.jsx(he,{href:n,onClick:I,children:n})})();return o&&(g=_(g)),b&&(g=pe({item:{name:h},onCollapse:E})(g)),g},st=x.memo(Me),at=()=>{const{register:e,setValue:r,getValues:a,formState:{errors:s}}=xe(),{t:o}=ee(te.Builder);return t.jsx(ge,{variant:"standard",id:re,autoFocus:!0,margin:"dense",label:o("CREATE_ITEM_LINK_LABEL"),slotProps:{inputLabel:{shrink:!0},input:{endAdornment:t.jsx(ye,{onClick:()=>r("url",""),sx:{visibility:a().url?"visible":"hidden"},children:t.jsx(Ce,{fontSize:"20"})})}},fullWidth:!0,required:!0,error:!!s.url,helperText:s.url?.message,placeholder:"https://graasp.org",...e("url",{pattern:{value:fe,message:o("LINK_INVALID_MESSAGE")}})})};export{ve as C,k as D,He as F,O as I,at as L,st as a,tt as b,Ne as c,et as g,rt as w};
