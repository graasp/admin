import{v as N,b as p,N as C,k as v,m as P,eT as b,e2 as Q,j as e,S as x,T as u,eU as q,r as j,s as O,e as F,eV as G,A as z,eW as K,eX as W,eY as H,c3 as X,eZ as V,e_ as Y,e$ as $}from"./index-Du6cLc2g.js";import{A as Z}from"./Alert-CbKF_a_e.js";import{B as U}from"./Button-BZonE8EM.js";import{G as J}from"./Button-D6pY2JNh.js";import{I}from"./itemLogin-BRGmCLqv.js";import{T as ee}from"./TextField-HOePLdCm.js";import{L as _}from"./lock-D7BFDH4B.js";import{C as te}from"./check-BjKssNkE.js";var S;(function(t){t.NotSubmittedOrDeleted="notSubmittedOrDeleted",t.Pending="pending",t.Approved="approved"})(S||(S={}));/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ne=[["path",{d:"M4.929 4.929 19.07 19.071",key:"196cmz"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],se=N("ban",ne);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]],ae=N("circle-user",re),pe=({itemId:t})=>{const{t:s}=p(C.Common,{keyPrefix:"ENROLL"}),{t:n}=p(C.Messages),a=v(),{mutate:d,error:i}=P({...b(),onError:o=>{console.error(o)},onSettled:(o,c)=>{a.invalidateQueries({queryKey:Q.single(t).content})}});return e.jsxs(x,{direction:"column",justifyContent:"center",alignItems:"center",height:"100%",flex:1,gap:2,children:[e.jsx(ae,{size:40}),e.jsx(u,{variant:"h3",children:s("TITLE")}),e.jsx(u,{variant:"subtitle2",children:s("DESCRIPTION")}),i&&e.jsx(Z,{severity:"error",children:n("ENROLL_UNEXPECTED_ERROR")}),e.jsx(U,{"data-cy":q,onClick:()=>d({path:{itemId:t}}),children:s("BUTTON")})]})},ie="You cannot access this item",f=({id:t,title:s=ie,helperText:n})=>e.jsxs(x,{id:t,direction:"row",alignItems:"center",justifyContent:"center",spacing:2,children:[e.jsx(se,{fontSize:"4em"}),e.jsxs(x,{direction:"column",children:[e.jsx(u,{variant:"h4",children:s}),e.jsx(u,{color:"text.secondary",maxWidth:"50ch",children:n})]})]}),ge=({id:t,memberId:s,title:n,authenticatedText:a})=>e.jsx(f,{id:t,title:n,helperText:s?a:void 0}),oe=O(F)({margin:"auto",display:"flex",flexDirection:"column",textAlign:"center",justifyContent:"center",height:"100%"}),R=O(ee)(({theme:t})=>({margin:t.spacing(1,0)})),ce=({ForbiddenContent:t=e.jsx(f,{}),itemId:s,itemLoginSchemaType:n,passwordInputId:a,signIn:d,signInButtonId:i,usernameInputId:o})=>{const{t:c}=p(),y=j.useRef(null),[m,E]=j.useState(""),[l,g]=j.useState("");if(!n||!Object.values(I).includes(n))return t;const h=[I.UsernameAndPassword].includes(n),T=()=>{const r={username:l};h&&(r.password=m),d({itemId:s,...r})},w=r=>{E(r.target.value)},B=r=>{g(r.target.value)},D=r=>{r.key==="Enter"&&T()},k=r=>{r.key==="Enter"&&(h?y.current?.focus():T())},L=()=>{const r=!l?.length,A=h&&!m?.length;return r||A},M=!!l&&(l.length<3||l.length>50);return e.jsxs(oe,{maxWidth:"xs",children:[e.jsx(x,{alignItems:"center",children:e.jsx(R,{error:M,autoFocus:!0,onChange:B,label:c("Pseudonym"),color:"primary",variant:"outlined",fullWidth:!0,type:"text",id:o,value:l,onKeyDown:k})}),h&&e.jsx(R,{onChange:w,label:c("Password"),value:m,type:"password",color:"primary",variant:"outlined",id:a,onKeyDown:D,inputRef:y}),e.jsx(J,{onClick:T,id:i,disabled:L(),children:c("Sign In")})]})},Te=({currentAccount:t,item:s,itemErrorStatusCode:n,itemLoginSchemaType:a,itemId:d,signIn:i,isLoading:o,usernameInputId:c,signInButtonId:y,passwordInputId:m,forbiddenContent:E=e.jsx(f,{}),enrollContent:l,requestAccessContent:g,children:h})=>o?e.jsx(G,{}):s&&s.id?h:t?t.type===z.Individual?a?l??E:n===K.FORBIDDEN?g??E:E:E:a?e.jsx(ce,{itemId:d,signIn:i,itemLoginSchemaType:a,usernameInputId:c,signInButtonId:y,passwordInputId:m}):E;function je({member:t,itemId:s}){const{t:n}=p(C.Player),a=v(),{mutateAsync:d,isSuccess:i,isPending:o}=P({...W(),onSettled:()=>{a.invalidateQueries({queryKey:H({path:{itemId:s}})})}}),{data:c}=X(V({path:{itemId:s}}));return c?.status===S.Pending?e.jsxs(x,{direction:"column",justifyContent:"center",alignItems:"center",height:"100%",flex:1,gap:2,"data-cy":Y,children:[e.jsx(_,{size:40}),e.jsx(u,{variant:"h3",children:n("REQUEST_ACCESS_PENDING_TITLE")}),e.jsx(u,{children:n("REQUEST_ACCESS_PENDING_DESCRIPTION")})]}):e.jsxs(x,{direction:"column",justifyContent:"center",alignItems:"center",height:"100%",flex:1,gap:2,children:[e.jsx(_,{size:40}),e.jsx(u,{variant:"h3",children:n("REQUEST_ACCESS_TITLE")}),e.jsx(U,{id:$,variant:"contained",disabled:i,loading:o,endIcon:i?e.jsx(te,{}):null,onClick:async()=>{await d({path:{itemId:s}})},children:n(i?"REQUEST_ACCESS_SENT_BUTTON":"REQUEST_ACCESS_BUTTON")}),e.jsx(u,{variant:"subtitle2",children:n("ITEM_LOGIN_HELPER_SIGN_OUT",{email:t.email})})]})}export{pe as E,ge as F,Te as I,je as R};
