import{j as r,a6 as j,b as d,N as p,m as L,a9 as O,S as E,aA as y,aB as C,r as v,aC as U,aD as F,aE as B,aF as G,aG as M,aH as W,H as b,aI as k}from"./index-Du6cLc2g.js";import{B as H}from"./ButtonLink-rFd5ZjYd.js";import{L as Q}from"./LeftContentContainer-nC9pbiS8.js";import{S as R,E as q,F as K}from"./StyledTextField-z_dx5nUi.js";import{u as A}from"./index.esm-ByZbOMQw.js";import{u as V}from"./useLocation-yoai5t4G.js";import{A as c}from"./styles-ClJhet3s.js";import{e as D,R as N}from"./RecaptchaContext-xrzY-iXs.js";import{E as X,P as z}from"./adornments-CbGr532U.js";import{i as P}from"./isEmail-CP0_oc0v.js";import{B as w}from"./Button-BZonE8EM.js";import{T as J}from"./TypographyLink-Dt5Yliyh.js";import{I as Y}from"./InputAdornment-19J4ELs1.js";import{I as Z}from"./IconButton-DGQNRfUk.js";import{E as $}from"./eye-off-D-8o9_aZ.js";import{E as rr}from"./eye-ByKgq0Tl.js";import{A as f}from"./Alert-CbKF_a_e.js";import{D as or}from"./Divider-CoTlx057.js";import"./AnalyticsIcon-BTh_u3pF.js";import"./LibraryIcon-Ce6_jpZ3.js";import"./PlayIcon-Dio1sQ0L.js";import"./Box-6qYIb0IB.js";import"./TextField-HOePLdCm.js";import"./useSlot-Jtq-mfHw.js";import"./ButtonBase-CdsCMxD3.js";import"./isFocusVisible-B8k4qzLc.js";import"./FormControl-BpWV3VDf.js";import"./isMuiElement-BOwKGjxf.js";import"./Modal-CVujTFOw.js";import"./createChainedFunction-BO_9K8Jh.js";import"./utils-TS7gOHXB.js";import"./Popover-DKSgKXB-.js";import"./Paper-B8YcVVca.js";import"./Grow-DtN_YV5L.js";import"./Menu-BWxVMNIi.js";import"./List-BxElNHcx.js";import"./listItemTextClasses-D6I-qz9g.js";import"./useControlled-B5xzdI43.js";import"./createSvgIcon-DpKUgtm0.js";import"./AlertTitle-Bdf1oZJW.js";import"./LanguageSwitch-DF2Cbktt.js";import"./langs-DUiJXdIq.js";import"./normalizeDates-Bl5IZJGD.js";import"./toDate-BXq0HhWu.js";import"./MenuItem-BDQospWL.js";import"./dividerClasses-bGF6_inT.js";import"./chevron-down-DS52ak5B.js";import"./lock-D7BFDH4B.js";import"./mail-UxXkPhko.js";import"./utils-CHXX7DhN.js";import"./CircularProgress-CnPELIce.js";function T({id:o,disabled:t=!1,autoFocus:s=!1,form:i,error:e,placeholder:m}){return r.jsx(R,{id:o,slotProps:{input:{startAdornment:X}},variant:"outlined",error:!!e,placeholder:m,helperText:e,autoFocus:s,disabled:t,...i})}function tr({search:o}){const t=j(),s=V(),{t:i}=d(p.Common,{keyPrefix:"FIELD_ERROR"}),{t:e}=d(p.Auth),{register:m,handleSubmit:l,formState:{errors:u}}=A(),{mutateAsync:I,isPending:_,error:h}=L({...O(),onError:a=>{console.error(a)}}),S=async({email:a})=>{const g=a.toLowerCase();try{const x=await D(N.SignIn);await I({body:{email:g,captcha:x,url:o.url}}),t({to:"/auth/success",search:{email:a,back:s.pathname}})}catch(x){console.error(x)}},n=u.email?.message;return r.jsxs(E,{component:"form",direction:"column",spacing:1,alignItems:"center",onSubmit:l(S),children:[r.jsx(T,{id:y,autoFocus:!0,form:m("email",{required:i("REQUIRED"),validate:a=>P(a,{})||i("INVALID_EMAIL")}),placeholder:e(c.EMAIL_INPUT_PLACEHOLDER),error:n}),r.jsx(q,{error:h}),r.jsx(w,{type:"submit",id:C,variant:"contained",sx:{textTransform:"none"},fullWidth:!0,loading:_,"data-umami-event":"magic-link-sign-in",children:e(c.SIGN_IN_BUTTON)})]})}function er({id:o,error:t,form:s}){const{t:i}=d(p.Auth),[e,m]=v.useState(!1),l=()=>m(u=>!u);return r.jsx(R,{slotProps:{input:{startAdornment:z,endAdornment:r.jsx(Y,{position:"end",color:"inherit",children:r.jsx(Z,{"aria-label":"toggle password visibility",onClick:l,edge:"end",color:"inherit",children:e?r.jsx($,{color:"currentColor"}):r.jsx(rr,{color:"currentColor"})})})}},variant:"outlined",error:!!t,helperText:t,placeholder:i(c.PASSWORD_INPUT_PLACEHOLDER),id:o,type:e?"text":"password",...s})}function sr(){const{t:o}=d(p.Auth),{t}=d(p.Messages),{register:s,handleSubmit:i,formState:{errors:e}}=A(),{mutate:m,isSuccess:l,isPending:u,error:I}=L({...U(),onSuccess:async()=>{window.location.reload()},onError:n=>{console.error(n)}}),_=async n=>{const a=n.email.toLowerCase(),g=await D(N.SignInWithPassword);m({body:{...n,email:a,captcha:g}})},h=e.email?.message,S=e.password?.message;return r.jsxs(E,{component:"form",onSubmit:i(_),direction:"column",spacing:1,alignItems:"center",children:[r.jsx(T,{id:F,form:s("email",{required:o("REQUIRED_FIELD_ERROR"),validate:n=>P(n,{})||o("INVALID_EMAIL_ERROR")}),placeholder:o(c.EMAIL_INPUT_PLACEHOLDER),error:h}),r.jsxs(E,{direction:"column",alignItems:"flex-end",children:[r.jsx(er,{id:B,error:S,form:s("password",{required:o("REQUIRED_FIELD_ERROR")})}),r.jsx(J,{color:"textSecondary",variant:"caption",sx:{textDecoration:"none","&:hover":{color:"palette.primary.main"}},to:"/auth/forgot-password",children:o(c.REQUEST_PASSWORD_RESET_LINK)})]}),I&&r.jsx(f,{severity:"error",children:"message"in I?t(I.message):t("UNEXPECTED_ERROR")}),r.jsx(w,{type:"submit",disabled:!!S||!!h,id:G,variant:"contained",color:"primary",sx:{textTransform:"none"},fullWidth:!0,loading:u||l,"data-umami-event":"password-sign-in",children:o(c.SIGN_IN_PASSWORD_BUTTON)}),l&&r.jsx(f,{severity:"success",id:M,children:o(c.PASSWORD_SUCCESS_ALERT)})]})}function to(){const o=W.useSearch(),{t}=d(p.Auth);return r.jsxs(r.Fragment,{children:[r.jsx(b,{children:r.jsxs("title",{children:[t("LOGIN_TITLE")," | Graasp"]})}),r.jsx(Q,{children:r.jsxs(E,{direction:"column",alignItems:"center",gap:3,children:[r.jsx(K,{id:k,title:t("LOGIN_TITLE")}),r.jsxs(E,{direction:"column",alignItems:"center",divider:r.jsx(or,{flexItem:!0,children:t("LOGIN_METHODS_DIVIDER")}),gap:3,children:[r.jsx(tr,{search:o}),r.jsx(sr,{}),r.jsx(H,{variant:"contained",fullWidth:!0,to:"/auth/register",search:o,children:t("SIGN_UP_LINK_TEXT")})]})]})})]})}export{to as component};
