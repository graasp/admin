import{m as F}from"./utils-CHXX7DhN.js";function d(t,l){var e;const r=(e=l?.min)!==null&&e!==void 0?e:0,a=encodeURI(t).split(/%..|./).length-1;return typeof l?.max>"u"?a>=r:a>=r&&a<=l.max}const h={requireTld:!0,allowUnderscores:!1,allowTrailingDot:!1,allowNumericTld:!1,allowWildcard:!1,ignoreMaxLength:!1};function p(t,l){const e=F(l,h);e.allowTrailingDot&&t.endsWith(".")&&(t=t.substring(0,t.length-1)),e.allowWildcard===!0&&t.startsWith("*.")&&(t=t.substring(2));const r=t.split("."),a=r[r.length-1];return e.requireTld&&(r.length<2||!e.allowNumericTld&&!/^([a-z\u00A1-\u00A8\u00AA-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]{2,}|xn[a-z0-9-]{2,})$/i.test(a)||/\s/.test(a))||!e.allowNumericTld&&/^\d+$/.test(a)?!1:r.every(n=>!(n.length>63&&!e.ignoreMaxLength||!/^[a-z_\u00a1-\uffff0-9-]+$/i.test(n)||/[\uff01-\uff5e]/.test(n)||/(^-)|(-$)/.test(n)||!e.allowUnderscores&&/_/.test(n)))}const x="(?:[0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])",f=`(${x}[.]){3}${x}`,_=new RegExp(`^${f}$`),s="(?:[0-9a-fA-F]{1,4})",w=new RegExp(`^((?:${s}:){7}(?:${s}|:)|(?:${s}:){6}(?:${f}|:${s}|:)|(?:${s}:){5}(?::${f}|(:${s}){1,2}|:)|(?:${s}:){4}(?:(:${s}){0,1}:${f}|(:${s}){1,3}|:)|(?:${s}:){3}(?:(:${s}){0,2}:${f}|(:${s}){1,4}|:)|(?:${s}:){2}(?:(:${s}){0,3}:${f}|(:${s}){1,5}|:)|(?:${s}:){1}(?:(:${s}){0,4}:${f}|(:${s}){1,6}|:)|(?::((?::${s}){0,5}:${f}|(?::${s}){1,7}|:)))(%[0-9a-zA-Z-.:]{1,})?$`);function c(t,l){const e=l?.version;return e?e==="4"?_.test(t):e==="6"?w.test(t):!1:c(t,{version:"4"})||c(t,{version:"6"})}const D={allowDisplayName:!1,allowUnderscores:!1,requireDisplayName:!1,allowUtf8LocalPart:!0,requireTld:!0,blacklistedChars:"",ignoreMaxLength:!1,hostBlacklist:[],hostWhitelist:[],domainSpecificValidation:!1,allowIpDomain:!1},v=/^([^\x00-\x1F\x7F-\x9F]+)</i,A=/^[a-z\d!#$%&'*+\-/=?^_`{|}~]+$/i,L=/^[a-z\d]+$/,U=/^([\s\x01-\x08\x0e-\x1f\x7f\x21\x23-\x5b\x5d-\x7e]|(\\[\x01-\x09\x0b\x0c\x0d-\x7f]))*$/i,E=/^[a-z\d!#$%&'*+\-/=?^_`{|}~\u00A1-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+$/i,T=/^([\s\x01-\x08\x0e-\x1f\x7f\x21\x23-\x5b\x5d-\x7e\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]|(\\[\x01-\x09\x0b\x0c\x0d-\x7f\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))*$/i,N=254;function P(t){const l=t.replace(/^"(.+)"$/,"$1");return!(!l.trim()||/[.";<>]/.test(l)&&(l===t||!(l.split('"').length===l.split('\\"').length)))}function W(t,l){const e=F(l,D);if(e.requireDisplayName||e.allowDisplayName){const o=v.exec(t);if(o){let u=o[1];if(t=t.replace(u,"").replace(/(^<|>$)/g,""),u.endsWith(" ")&&(u=u.slice(0,-1)),!P(u))return!1}else if(e.requireDisplayName)return!1}if(!e.ignoreMaxLength&&t.length>N)return!1;const r=t.split("@"),a=r.pop();if(!a)return!1;const n=a.toLowerCase();if(e.hostBlacklist.includes(n)||e.hostWhitelist.length>0&&!e.hostWhitelist.includes(n))return!1;let i=r.join("@");if(e.domainSpecificValidation&&(n==="gmail.com"||n==="googlemail.com")){i=i.toLowerCase();const o=i.split("+")[0];if(!d(o.replace(/\./g,""),{min:6,max:30}))return!1;const u=o.split(".");for(const $ of u)if(!L.test($))return!1}if(e.ignoreMaxLength===!1&&(!d(i,{max:64})||!d(a,{max:254})))return!1;if(!p(a,{requireTld:e.requireTld,ignoreMaxLength:e.ignoreMaxLength,allowUnderscores:e.allowUnderscores})){if(!e.allowIpDomain)return!1;if(!c(a)){if(!a.startsWith("[")||!a.endsWith("]"))return!1;const o=a.slice(1,-1);if(o.length===0||!c(o))return!1}}if(e.blacklistedChars&&i.search(new RegExp(`[${e.blacklistedChars}]+`,"g"))!==-1)return!1;if(i.startsWith('"')&&i.endsWith('"'))return i=i.slice(1,i.length-1),e.allowUtf8LocalPart?T.test(i):U.test(i);const m=e.allowUtf8LocalPart?E:A,g=i.split(".");for(const o of g)if(!m.test(o))return!1;return!0}export{W as i};
