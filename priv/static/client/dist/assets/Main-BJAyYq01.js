import{w as X,x as J,r as h,z as oo,j as o,s as w,B as to,bi as M,E as ro,bj as eo,bn as no,v as ao,b as j,N as C,A as R,T as A,f as so,S as f,Z as E,a6 as io,bo as v,h as L,bp as lo,d as co,k as po,m as uo,n as xo,o as ho,y as mo,bq as go,t as jo,br as Co,aY as F,aM as fo,D as Ao}from"./index-Du6cLc2g.js";import{M as _}from"./MenuItemLink-BCqfpz1w.js";import{I as b}from"./IconButton-DGQNRfUk.js";import{M as vo}from"./Menu-BWxVMNIi.js";import{L as y}from"./ListItemIcon-B3CKIE52.js";import{H as bo}from"./house-gX3Odk21.js";import{S as yo}from"./settings-BrKPuy4i.js";import{D as To}from"./Divider-CoTlx057.js";import{C as Mo}from"./circle-question-mark-4vLz0IMx.js";import{M as Io}from"./MenuItem-BDQospWL.js";import{D as Bo}from"./door-open-DV7dVqPj.js";import{c as So,a as ko,m as Eo,A as _o,T,D as N}from"./Avatar-BogaTqsp.js";import{D as G,a as W}from"./DialogContent-BVO65bHL.js";import{D as $}from"./DialogTitle-DnHtd1CR.js";import{D as Oo}from"./DialogActions-hH_AKLy2.js";import{B as I}from"./Button-BZonE8EM.js";import{T as Do,a as O,b as g,c as Ro}from"./TableRow-pCWy9HZN.js";import{T as Lo}from"./TableHead-C53r7Yjx.js";import{c as S}from"./createSvgIcon-DpKUgtm0.js";import{G as D}from"./Grid-C2qF_7LL.js";import{T as P}from"./Tooltip-CkGlpyEO.js";import{B as wo}from"./Badge-BxSVnORh.js";import{B as No}from"./ButtonLink-rFd5ZjYd.js";import{L as Po}from"./LanguageSwitch-DF2Cbktt.js";import{u as Uo}from"./useMobileView-DsvLNutV.js";import{B as V}from"./Box-6qYIb0IB.js";import{P as zo}from"./Paper-B8YcVVca.js";import{M as Ho}from"./menu-HfQQ_gVI.js";function Fo(t){return X("MuiAppBar",t)}J("MuiAppBar",["root","positionFixed","positionAbsolute","positionSticky","positionStatic","positionRelative","colorDefault","colorPrimary","colorSecondary","colorInherit","colorTransparent","colorError","colorInfo","colorSuccess","colorWarning"]);const Go=t=>{const{color:r,position:n,classes:e}=t,a={root:["root",`color${M(r)}`,`position${M(n)}`]};return ro(a,Fo,e)},U=(t,r)=>t?`${t?.replace(")","")}, ${r})`:r,Wo=w(zo,{name:"MuiAppBar",slot:"Root",overridesResolver:(t,r)=>{const{ownerState:n}=t;return[r.root,r[`position${M(n.position)}`],r[`color${M(n.color)}`]]}})(eo(({theme:t})=>({display:"flex",flexDirection:"column",width:"100%",boxSizing:"border-box",flexShrink:0,variants:[{props:{position:"fixed"},style:{position:"fixed",zIndex:(t.vars||t).zIndex.appBar,top:0,left:"auto",right:0,"@media print":{position:"absolute"}}},{props:{position:"absolute"},style:{position:"absolute",zIndex:(t.vars||t).zIndex.appBar,top:0,left:"auto",right:0}},{props:{position:"sticky"},style:{position:"sticky",zIndex:(t.vars||t).zIndex.appBar,top:0,left:"auto",right:0}},{props:{position:"static"},style:{position:"static"}},{props:{position:"relative"},style:{position:"relative"}},{props:{color:"inherit"},style:{"--AppBar-color":"inherit"}},{props:{color:"default"},style:{"--AppBar-background":t.vars?t.vars.palette.AppBar.defaultBg:t.palette.grey[100],"--AppBar-color":t.vars?t.vars.palette.text.primary:t.palette.getContrastText(t.palette.grey[100]),...t.applyStyles("dark",{"--AppBar-background":t.vars?t.vars.palette.AppBar.defaultBg:t.palette.grey[900],"--AppBar-color":t.vars?t.vars.palette.text.primary:t.palette.getContrastText(t.palette.grey[900])})}},...Object.entries(t.palette).filter(no(["contrastText"])).map(([r])=>({props:{color:r},style:{"--AppBar-background":(t.vars??t).palette[r].main,"--AppBar-color":(t.vars??t).palette[r].contrastText}})),{props:r=>r.enableColorOnDark===!0&&!["inherit","transparent"].includes(r.color),style:{backgroundColor:"var(--AppBar-background)",color:"var(--AppBar-color)"}},{props:r=>r.enableColorOnDark===!1&&!["inherit","transparent"].includes(r.color),style:{backgroundColor:"var(--AppBar-background)",color:"var(--AppBar-color)",...t.applyStyles("dark",{backgroundColor:t.vars?U(t.vars.palette.AppBar.darkBg,"var(--AppBar-background)"):null,color:t.vars?U(t.vars.palette.AppBar.darkColor,"var(--AppBar-color)"):null})}},{props:{color:"transparent"},style:{"--AppBar-background":"transparent","--AppBar-color":"inherit",backgroundColor:"var(--AppBar-background)",color:"var(--AppBar-color)",...t.applyStyles("dark",{backgroundImage:"none"})}}]}))),$o=h.forwardRef(function(r,n){const e=oo({props:r,name:"MuiAppBar"}),{className:a,color:l="primary",enableColorOnDark:c=!1,position:i="fixed",...p}=e,s={...e,color:l,position:i,enableColorOnDark:c},u=Go(s);return o.jsx(Wo,{square:!0,component:"header",ownerState:s,elevation:4,className:to(u.root,a,i==="fixed"&&"mui-fixed"),ref:n,...p})});/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vo=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],K=ao("bell",Vo),z="account-menu";function Ko({avatarButtonId:t,user:r,signOutMenuItemId:n,avatar:e,dataUmamiEvent:a,signOut:l,signOutText:c}){const[i,p]=h.useState(null),{t:s}=j(C.Common),u=k=>{p(k.currentTarget)},x=()=>{p(null)},d=()=>({selected:!0}),m=!!i;return o.jsxs(o.Fragment,{children:[o.jsx(b,{onClick:u,size:"small",id:t,"aria-controls":m?z:void 0,"aria-haspopup":"true","aria-expanded":m?"true":void 0,"data-umami-event":a,children:e}),o.jsxs(vo,{id:z,anchorEl:i,open:m,onClose:x,children:[r.type===R.Individual&&o.jsxs(o.Fragment,{children:[o.jsxs(_,{to:"/home",activeProps:d,onClick:x,children:[o.jsx(y,{children:o.jsx(bo,{})}),o.jsx(A,{variant:"subtitle2",children:s("USER_SWITCH.HOME")})]}),o.jsxs(_,{to:"/account/settings",activeProps:d,onClick:x,children:[o.jsx(y,{children:o.jsx(yo,{})}),o.jsx(A,{variant:"subtitle2",children:s("USER_SWITCH.SETTINGS")})]}),o.jsx(To,{}),o.jsxs(_,{to:"/support",activeProps:d,onClick:x,children:[o.jsx(y,{children:o.jsx(Mo,{})}),o.jsx(A,{variant:"subtitle2",children:s("USER_SWITCH.NEED_HELP")})]})]}),o.jsxs(Io,{onClick:l,id:n,children:[o.jsx(y,{children:o.jsx(Bo,{})}),o.jsx(A,{variant:"subtitle2",children:c})]},"signout")]})]})}function qo({children:t,open:r,setOpen:n}){const{t:e}=j(C.Chatbox),{color:a}=so("primary");return o.jsxs(G,{open:r,onClose:()=>n(!1),maxWidth:"lg",children:[o.jsx($,{children:o.jsxs(f,{direction:"row",gap:2,alignItems:"center",children:[o.jsx(K,{color:a}),e("NOTIFICATIONS_DIALOG_TITLE")]})}),o.jsx(W,{children:t})]})}const Qo=S(o.jsx("path",{d:"M9 16.17 4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"})),Yo=S(o.jsx("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})),Zo=S(o.jsx("circle",{cx:"12",cy:"12",r:"8"})),Xo=S(o.jsx("path",{d:"M3 18h13v-2H3zm0-5h10v-2H3zm0-7v2h13V6zm18 9.59L17.42 12 21 8.41 19.59 7l-5 5 5 5z"}));function Jo({open:t,title:r,content:n,confirmText:e,cancelText:a,onConfirm:l,onCancel:c}){const{t:i}=j(C.Chatbox);return o.jsxs(G,{open:t,children:[o.jsx($,{children:r}),o.jsx(W,{children:n}),o.jsxs(Oo,{children:[o.jsx(I,{variant:"contained",onClick:c,"data-cy":So,children:a??i("CANCEL_BUTTON")}),o.jsx(I,{variant:"outlined",onClick:l,"data-cy":ko,children:e??i("CONFIRM_BUTTON")})]})]})}function ot({mentions:t}){const[r,n]=h.useState(!1),{t:e}=j(C.Chatbox),a=E.usePatchMention(),l=E.useDeleteMention(),c=E.useClearMentions(),i=io(),p=s=>{a.mutate({id:s,status:v.Read})};return o.jsxs(f,{direction:"column",children:[o.jsxs(f,{direction:"row",justifyContent:"space-between",gap:2,children:[o.jsx(I,{variant:"outlined",onClick:()=>{t?.filter(s=>s.status===v.Unread).map(s=>a.mutate({id:s.id,status:v.Read}))},children:e("MARK_ALL_AS_READ")}),o.jsx(I,{variant:"outlined",onClick:()=>n(!0),children:e("CLEAR_ALL")}),o.jsx(Jo,{open:r,title:e("CLEAR_ALL_NOTIFICATIONS_TITLE"),content:e("CLEAR_ALL_NOTIFICATIONS_CONTENT"),onConfirm:()=>{c.mutate(),n(!1)},onCancel:()=>n(!1)})]}),t?.length?o.jsxs(Do,{children:[o.jsx(Lo,{children:o.jsxs(O,{children:[o.jsx(g,{children:e("COL_STATUS")}),o.jsx(g,{children:e("COL_MESSAGE")}),o.jsx(g,{children:e("COL_ACTIONS")})]})}),o.jsx(Ro,{children:t.map(s=>o.jsxs(O,{hover:!0,sx:{":hover":{cursor:"pointer"}},onClick:()=>{p(s.id),i({to:"/builder/items/$itemId",params:{itemId:s.message.itemId},search:{chatOpen:!0}})},children:[o.jsx(g,{children:s.status===v.Unread&&o.jsx(Zo,{fontSize:"small",color:"primary"})}),o.jsx(g,{children:e("NOTIFICATION_ITEM_CHAT_MENTION_MESSAGE")}),o.jsx(g,{children:o.jsxs(D,{container:!0,direction:"row",children:[o.jsx(D,{children:o.jsx(P,{title:e("MARK_AS_READ"),children:o.jsx(b,{onClick:u=>{u.stopPropagation(),p(s.id)},children:o.jsx(Qo,{color:"primary"})})})}),o.jsx(D,{children:o.jsx(P,{title:e("DELETE_TOOLTIP"),children:o.jsx(b,{onClick:u=>{u.stopPropagation(),l.mutate(s.id)},children:o.jsx(Yo,{color:"primary"})})})})]})})]},s.id))})]}):o.jsx(O,{children:o.jsx(g,{colSpan:4,children:e("EMPTY_NOTIFICATIONS")})})]})}function tt({color:t="white",badgeColor:r="primary"}){const{data:n}=L.useMentions(),[e,a]=h.useState(!1);return o.jsxs("div",{children:[o.jsx(b,{"data-cy":Eo,onClick:()=>a(!0),children:o.jsx(wo,{component:"div",overlap:"circular",color:r,badgeContent:n?.filter(l=>l.status===v.Unread)?.length??0,children:o.jsx(K,{color:t})})}),o.jsx(qo,{open:e,setOpen:a,children:o.jsx(ot,{mentions:n})})]})}const H=40,rt=({id:t,maxWidth:r=H,maxHeight:n=H,component:e="avatar"})=>{const{t:a}=j(C.Account),{data:l,isPending:c}=L.useCurrentMember(),{data:i,isPending:p}=L.useAvatarUrl({id:t,size:lo.Medium});return o.jsx(_o,{url:i,isLoading:c||p,alt:l?.name??a("PROFILE_AVATAR_CURRENT_ALT"),component:e,maxWidth:r,maxHeight:n})};function Pt(){const{i18n:t,t:r}=j(C.Common,{keyPrefix:"USER_SWITCH"}),{t:n}=j(C.Messages),{isAuthenticated:e,user:a,logout:l}=co(),c=po(),{mutate:i}=uo({...xo(),onError:s=>{console.error(s),mo.error(n("EDIT_MEMBER_ERROR"))},onSettled:async()=>{await c.invalidateQueries({queryKey:ho.current().content})}}),p=s=>{e&&a.type===R.Individual&&i({body:{extra:{lang:s}}}),t.changeLanguage(s)};return e?o.jsxs(f,{direction:"row",gap:1,alignItems:"center",children:[a.type===R.Individual&&o.jsxs(o.Fragment,{children:[o.jsx(tt,{color:"white",badgeColor:"primary"}),o.jsx(Po,{id:"languageSwitch",lang:t.languages[0],onChange:p,color:"white"})]}),o.jsx(Ko,{avatarButtonId:go,signOut:l,user:a,avatar:o.jsx(rt,{id:a.id}),dataUmamiEvent:"user-menu",signOutText:r("LOG_OUT")})]}):o.jsx(No,{to:"/auth/login",sx:{color:"white"},search:{},children:r("LOG_IN")})}const q=h.createContext({open:!0,setOpen:()=>{console.error("No Provider found for this context. Check your tree")}}),et=({open:t=!0,children:r})=>{const{isMobile:n}=Uo(),[e,a]=h.useState(n?!1:t);return o.jsx(q.Provider,{value:{open:e,setOpen:a},children:r})},nt=()=>h.useContext(q),at=()=>o.jsxs(f,{direction:"row",alignItems:"center",textTransform:"none",color:"inherit",children:[o.jsx(jo,{height:40,sx:{fill:"white"}}),o.jsx(A,{sx:{display:{xs:"none",sm:"block"}},color:"currentcolor",variant:"h6",children:"Graasp"})]}),B=240,st=t=>`linear-gradient(to right in oklch, ${F} 35%, ${t} 100%);`,Q=t=>({width:"100%",[t.breakpoints.up("sm")]:{marginLeft:`${B}px`,width:`calc(100% - ${B}px)`},transition:t.transitions.create(["width","margin"],{easing:t.transitions.easing.easeOut,duration:t.transitions.duration.enteringScreen})}),it=w("main",{shouldForwardProp:t=>!["open","backgroundColor"].includes(t)})(({theme:t,open:r,backgroundColor:n})=>({position:"relative",flexGrow:1,backgroundColor:n,transition:t.transitions.create(["width","margin"],{easing:t.transitions.easing.easeIn,duration:t.transitions.duration.leavingScreen}),...r&&Q(t)})),lt=w("footer",{shouldForwardProp:t=>t!=="open"})(({theme:t,open:r})=>({...r&&Q(t)})),ct=({context:t,drawerContent:r,footerContent:n,children:e,headerLeftContent:a,headerRightContent:l,open:c,headerId:i,drawerOpenAriaLabel:p,LinkComponent:s,PlatformComponent:u,backgroundColor:x=Ao})=>{const{open:d,setOpen:m}=nt(),k=()=>{m(!1)},Y=()=>{m(Z=>!Z)};return h.useEffect(()=>{c!==void 0&&m(c)},[c]),o.jsxs(o.Fragment,{children:[o.jsx(Co,{}),o.jsx($o,{id:i,position:"fixed",sx:{background:t?st(fo[t]):F},children:o.jsx(T,{children:o.jsxs(f,{width:"100%",direction:"row",alignItems:"center",justifyContent:"space-between",spacing:2,flex:1,minWidth:0,children:[o.jsxs(f,{direction:"row",alignItems:"center",flex:1,minWidth:0,spacing:1,children:[r&&o.jsx(b,{color:"inherit","aria-label":p,onClick:Y,edge:"start","data-umami-event":"header-drawer-toggle","data-umami-event-context":t,"data-umami-event-open":d,children:d?o.jsx(Xo,{}):o.jsx(Ho,{})}),s?.({children:o.jsx(at,{})}),u,a]}),l]})})}),r&&o.jsxs(V,{component:"nav","aria-label":"navigation",children:[o.jsxs(N,{variant:"temporary",open:d,onClose:k,ModalProps:{keepMounted:!0},sx:{display:{xs:"block",sm:"none"},"& .MuiDrawer-paper":{boxSizing:"border-box",width:B,backgroundColor:x}},children:[o.jsx(T,{}),r]}),o.jsxs(N,{variant:"persistent",sx:{display:{xs:"none",sm:"block"},"& .MuiDrawer-paper":{boxSizing:"border-box",width:B,backgroundColor:x}},open:d,children:[o.jsx(T,{}),r]})]}),o.jsx(T,{}),o.jsx(it,{open:d&&!!r,backgroundColor:x,children:e}),o.jsx(lt,{open:d,children:n})]})},Ut=t=>o.jsx(V,{id:"main",height:"100vh",overflow:"auto",display:"flex",flexDirection:"column",sx:{overflowX:"hidden"},children:o.jsx(et,{open:t.open,children:o.jsx(ct,{...t})})});export{Pt as H,Ut as M,nt as u};
