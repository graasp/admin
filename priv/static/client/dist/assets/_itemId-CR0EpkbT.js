import{j as t,b2 as I,a6 as D,d as G,b as u,N as h,i as B,h as r,Z as H,b3 as w,S as n,b4 as F,a as k,C as U,b5 as W,b6 as $,b7 as V,O as q,b8 as x,A as g,G as z,b9 as X}from"./index-Du6cLc2g.js";import{I as Y,F as Z,R as J,E as K}from"./RequestAccessContent-DYIbAgne.js";import{L as Q,I as tt,G as ot}from"./ItemNavigation-BvcQqOsS.js";import{B as it}from"./ButtonLink-rFd5ZjYd.js";import{M as rt,H as et}from"./Main-BJAyYq01.js";import{M as st,H as mt}from"./HomeHeaderLink-kjC-gHuA.js";import{P as nt,a as e}from"./PlatformSwitch-w_aSaTc6.js";import{u as at}from"./useMobileView-DsvLNutV.js";import{F as pt}from"./FilterItemsContext-BUWSAJ79.js";import{F as dt}from"./FlagItemModalContext-B0K0Erjf.js";import{L as ct}from"./LayoutContext-DaU0037A.js";import{O as lt}from"./OutletContext-BlmY1stK.js";import{H as It}from"./house-gX3Odk21.js";import{D as ut}from"./Divider-CoTlx057.js";import{P as _}from"./permissionLevel-BOsSKewz.js";import"./Alert-CbKF_a_e.js";import"./useSlot-Jtq-mfHw.js";import"./ButtonBase-CdsCMxD3.js";import"./isFocusVisible-B8k4qzLc.js";import"./createSvgIcon-DpKUgtm0.js";import"./IconButton-DGQNRfUk.js";import"./CircularProgress-CnPELIce.js";import"./Paper-B8YcVVca.js";import"./Button-BZonE8EM.js";import"./Button-D6pY2JNh.js";import"./itemLogin-BRGmCLqv.js";import"./TextField-HOePLdCm.js";import"./FormControl-BpWV3VDf.js";import"./isMuiElement-BOwKGjxf.js";import"./Modal-CVujTFOw.js";import"./createChainedFunction-BO_9K8Jh.js";import"./utils-TS7gOHXB.js";import"./Popover-DKSgKXB-.js";import"./Grow-DtN_YV5L.js";import"./Menu-BWxVMNIi.js";import"./List-BxElNHcx.js";import"./listItemTextClasses-D6I-qz9g.js";import"./useControlled-B5xzdI43.js";import"./lock-D7BFDH4B.js";import"./check-BjKssNkE.js";import"./Skeleton-DL17Y8WH.js";import"./ItemIcon-CVFe5RC4.js";import"./StyledBaseComponents-CGx14SPL.js";import"./mimeTypes-Bpmm_hmI.js";import"./fileItem-Bbp5pYua.js";import"./itemType-D9KQEJss.js";import"./link-t0gZlfUa.js";import"./text-align-start-B7PT5KlE.js";import"./errorboundary-Cw_peViT.js";import"./ListItemButton-TZ0nPx2E.js";import"./listItemButtonClasses-DxNRX85C.js";import"./Collapse-CnjxOpna.js";import"./shuffle-_LX9pwJ9.js";import"./validate-DVgNBRRM.js";import"./stringify-D92ucQ0I.js";import"./MenuItemLink-BCqfpz1w.js";import"./MenuItem-BDQospWL.js";import"./dividerClasses-bGF6_inT.js";import"./ListItemIcon-B3CKIE52.js";import"./settings-BrKPuy4i.js";import"./circle-question-mark-4vLz0IMx.js";import"./door-open-DV7dVqPj.js";import"./Avatar-BogaTqsp.js";import"./Thumbnail--Tilnabo.js";import"./Avatar-BsacKTQe.js";import"./DialogContent-BVO65bHL.js";import"./DialogTitle-DnHtd1CR.js";import"./DialogActions-hH_AKLy2.js";import"./TableRow-pCWy9HZN.js";import"./TableHead-C53r7Yjx.js";import"./Grid-C2qF_7LL.js";import"./Tooltip-CkGlpyEO.js";import"./Badge-BxSVnORh.js";import"./usePreviousProps-zyP3vJcr.js";import"./LanguageSwitch-DF2Cbktt.js";import"./langs-DUiJXdIq.js";import"./normalizeDates-Bl5IZJGD.js";import"./toDate-BXq0HhWu.js";import"./chevron-down-DS52ak5B.js";import"./Box-6qYIb0IB.js";import"./menu-HfQQ_gVI.js";import"./ListItem-D9P1QCDu.js";import"./ListItemText-DtIE91_b.js";import"./AnalyticsIcon-BTh_u3pF.js";import"./LibraryIcon-Ce6_jpZ3.js";import"./PlayIcon-Dio1sQ0L.js";import"./index-8QNzrxwJ.js";import"./Fab-Bho1ORf6.js";import"./constants-CyQbYbhY.js";const ht=({children:o})=>t.jsx(ct,{children:t.jsx(dt,{children:o})}),xt=({children:o})=>t.jsx(mt,{to:"/home",children:o});function Qo(){const{itemId:o}=I.useParams(),L=D(),f=I.useSearch(),{user:a}=G(),{t:p}=u(h.Builder),{t:A}=u(h.Common),d=B(),{isMobile:c}=at(),{data:i,isLoading:N,error:l}=r.useItem(o),{data:m,isLoading:C}=r.useCurrentMember(),{data:E,isLoading:P,isError:j}=r.useItemLoginSchemaType({itemId:o}),{data:s,isLoading:T}=r.useParents({id:i?.id,enabled:!!i?.id});r.useItemFeedbackUpdates?.(a?.id);const{mutate:S}=H.usePostItemLogin(),b=i?.permission?_.gte(i.permission,"write"):!1,M=i?.permission?_.gte(i.permission,"admin"):!1,R=w.isAxiosError(l)&&l.status||null,O={[e.Builder]:{href:`/builder/items/${o}`},[e.Player]:{href:`/player/${o}/${o}`},[e.Library]:{href:z},[e.Analytics]:{href:`/analytics/items/${o}`}},y=T?t.jsx(Q,{}):t.jsxs(n,{height:"100%",children:[t.jsx(st,{id:F,text:p("MENU.RETURN_HOME"),icon:t.jsx(It,{}),to:"/home"}),t.jsx(ut,{}),t.jsx(tt,{rootId:s?.[0]?.id??o,itemId:i?.type!=="folder"&&s?.length?s[s.length-1].id:o,showHidden:!0,types:ot,handleNavigationOnClick:v=>{L({to:"/builder/items/$itemId",params:{itemId:v},search:f})}})]});return t.jsx(ht,{children:t.jsx(rt,{open:a?.type===g.Individual?void 0:!1,context:U.Builder,headerId:k,drawerOpenAriaLabel:p("ARIA_OPEN_DRAWER"),headerRightContent:t.jsx(et,{}),drawerContent:y,LinkComponent:xt,PlatformComponent:t.jsx(nt,{id:X,selected:e.Builder,platformsProps:O,color:c?d.palette.primary.main:"white",accentColor:c?"white":d.palette.primary.main}),children:t.jsx(pt,{children:t.jsx(n,{maxWidth:"xl",mx:"auto",width:"100%",height:"100%",children:t.jsx(Y,{item:i,itemErrorStatusCode:R,currentAccount:m,enrollContent:t.jsx(K,{itemId:o}),signInButtonId:V,usernameInputId:$,passwordInputId:W,signIn:S,itemLoginSchemaType:E,itemId:o,isLoading:C||P||N,requestAccessContent:m?.type===g.Individual&&!j?t.jsx(J,{itemId:o,member:m}):void 0,forbiddenContent:t.jsxs(n,{id:x,direction:"column",justifyContent:"center",alignItems:"center",height:"100%",flex:1,gap:2,children:[t.jsx(Z,{id:x}),t.jsx(it,{to:"/auth/login",children:A("LOG_IN.BUTTON_TEXT")})]}),children:t.jsx(lt.Provider,{value:{item:i,permission:i?.permission,canWrite:b,canAdmin:M},children:t.jsx(q,{})})})})})})})}export{Qo as component};
